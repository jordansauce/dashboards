no change     /data/jordan_tensor/miniconda3/condabin/conda
no change     /data/jordan_tensor/miniconda3/bin/conda
no change     /data/jordan_tensor/miniconda3/bin/conda-env
no change     /data/jordan_tensor/miniconda3/bin/activate
no change     /data/jordan_tensor/miniconda3/bin/deactivate
no change     /data/jordan_tensor/miniconda3/etc/profile.d/conda.sh
no change     /data/jordan_tensor/miniconda3/etc/fish/conf.d/conda.fish
no change     /data/jordan_tensor/miniconda3/shell/condabin/Conda.psm1
no change     /data/jordan_tensor/miniconda3/shell/condabin/conda-hook.ps1
no change     /data/jordan_tensor/miniconda3/lib/python3.12/site-packages/xontrib/conda.xsh
no change     /data/jordan_tensor/miniconda3/etc/profile.d/conda.csh
no change     /data/jordan_tensor/.bashrc
No action taken.

CondaError: Run 'conda init' before 'conda activate'

/data/jordan_tensor/dashboards/regions
2024-04-16 01:51:00 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-2_region-1_e2e-ovhfts9n_Blue_cluster_near_top') save_json_data=False sae_positions=None feature_indices=[180, 185, 332, 333, 554, 590, 655, 666, 856, 876, 893, 969, 1115, 1289, 1378, 1459, 1732, 1808, 1970, 2020, 2083, 2257, 2341, 2384, 2412, 2443, 2546, 2651, 2676, 2736, 3013, 3096, 3114, 3196, 3251, 3391, 3460, 3479, 3481, 3536, 4030, 4048, 4055, 4123, 4162, 4164, 4261, 4300, 4373, 4469, 4501, 4510, 4660, 4711, 4726, 4754, 4959, 4977, 4982, 5090, 5104, 5153, 5184, 5558, 5569, 5587, 5603, 5664, 5691, 5763, 5900, 5912, 5921, 6038, 6118, 6146, 6180, 6219, 6254, 6525, 6755, 6777, 6805, 6853, 6943, 6982, 7061, 7090, 7170, 7192, 7320, 7325, 7383, 7434, 7530, 7535, 7540, 7574, 7591, 7622, 7642, 7657, 7663, 7733, 7780, 7809, 7995, 8011, 8088, 8116, 8120, 8197, 8212, 8311, 8401, 8406, 8424, 8428, 8481, 8504, 8956, 9015, 9030, 9091, 9186, 9279, 9551, 9563, 9695, 9881, 9911, 9915, 9935, 10037, 10080, 10165, 10212, 10260, 10288, 10500, 10519, 10640, 10811, 10838, 10871, 10912, 11007, 11072, 11078, 11191, 11217, 11324, 11421, 11429, 11467, 11662, 11834, 12014, 12182, 12276, 12614, 12618, 12747, 12898, 12963, 13113, 13146, 13164, 13187, 13318, 13458, 13495, 13902, 14107, 14135, 14183, 14288, 14334, 14408, 14441, 14446, 14529, 14557, 14594, 14632, 14661, 14850, 14867, 14873, 14945, 14956, 15054, 15127, 15251, 15259, 15268, 15300, 15505, 15515, 15531, 15585, 15627, 15634, 15664, 15717, 16010, 16172, 16178, 16237, 16238, 16354, 16402, 16486, 16553, 16635, 16710, 16787, 16791, 17058, 17087, 17105, 17200, 17352, 17432, 17593, 17792, 17861, 17871, 17941, 18013, 18192, 18330, 18359, 18400, 18418, 18464, 18520, 18528, 18791, 18816, 18857, 18886, 18986, 19166, 19263, 19388, 19393, 19428, 19447, 19490, 19590, 19657, 19753, 19794, 19804, 19882, 19920, 19926, 19956, 20257, 20292, 20516, 20552, 20562, 20580, 20649, 20872, 20890, 20915, 20925, 21081, 21273, 21409, 21432, 21447, 21666, 21954, 21960, 22001, 22045, 22304] prompt_centric=None seed=0
2024-04-16 01:51:00 - INFO - Loading the model and SAEs
2024-04-16 01:51:00 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=0.5, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.2.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-16 01:51:03 - INFO - done
2024-04-16 01:51:03 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-2_region-1_e2e-ovhfts9n_Blue_cluster_near_top
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/313 [00:00<?, ?it/s]Computing feature acts:   0%|          | 1/313 [00:01<06:33,  1.26s/it]Computing feature acts:   1%|          | 2/313 [00:02<05:34,  1.07s/it]Computing feature acts:   1%|          | 3/313 [00:03<05:15,  1.02s/it]Computing feature acts:   1%|▏         | 4/313 [00:04<05:04,  1.01it/s]Computing feature acts:   2%|▏         | 5/313 [00:05<04:59,  1.03it/s]Computing feature acts:   2%|▏         | 6/313 [00:06<05:03,  1.01it/s]Computing feature acts:   2%|▏         | 7/313 [00:07<04:57,  1.03it/s]Computing feature acts:   3%|▎         | 8/313 [00:07<04:53,  1.04it/s]Computing feature acts:   3%|▎         | 9/313 [00:08<04:49,  1.05it/s]Computing feature acts:   3%|▎         | 10/313 [00:09<04:47,  1.05it/s]Computing feature acts:   4%|▎         | 11/313 [00:10<04:47,  1.05it/s]Computing feature acts:   4%|▍         | 12/313 [00:11<04:46,  1.05it/s]Computing feature acts:   4%|▍         | 13/313 [00:12<04:45,  1.05it/s]Computing feature acts:   4%|▍         | 14/313 [00:13<04:44,  1.05it/s]Computing feature acts:   5%|▍         | 15/313 [00:14<04:43,  1.05it/s]Computing feature acts:   5%|▌         | 16/313 [00:15<04:42,  1.05it/s]Computing feature acts:   5%|▌         | 17/313 [00:16<04:41,  1.05it/s]Computing feature acts:   6%|▌         | 18/313 [00:17<04:40,  1.05it/s]Computing feature acts:   6%|▌         | 19/313 [00:18<04:39,  1.05it/s]Computing feature acts:   6%|▋         | 20/313 [00:19<04:39,  1.05it/s]Computing feature acts:   7%|▋         | 21/313 [00:20<04:38,  1.05it/s]Computing feature acts:   7%|▋         | 22/313 [00:21<04:37,  1.05it/s]Computing feature acts:   7%|▋         | 23/313 [00:22<04:37,  1.04it/s]Computing feature acts:   8%|▊         | 24/313 [00:23<04:35,  1.05it/s]Computing feature acts:   8%|▊         | 25/313 [00:24<04:34,  1.05it/s]Computing feature acts:   8%|▊         | 26/313 [00:25<04:33,  1.05it/s]Computing feature acts:   9%|▊         | 27/313 [00:26<04:32,  1.05it/s]Computing feature acts:   9%|▉         | 28/313 [00:26<04:31,  1.05it/s]Computing feature acts:   9%|▉         | 29/313 [00:27<04:30,  1.05it/s]Computing feature acts:  10%|▉         | 30/313 [00:28<04:29,  1.05it/s]Computing feature acts:  10%|▉         | 31/313 [00:29<04:28,  1.05it/s]Computing feature acts:  10%|█         | 32/313 [00:30<04:27,  1.05it/s]Computing feature acts:  11%|█         | 33/313 [00:31<04:26,  1.05it/s]Computing feature acts:  11%|█         | 34/313 [00:32<04:36,  1.01it/s]Computing feature acts:  11%|█         | 35/313 [00:33<04:32,  1.02it/s]Computing feature acts:  12%|█▏        | 36/313 [00:34<04:29,  1.03it/s]Computing feature acts:  12%|█▏        | 37/313 [00:35<04:26,  1.04it/s]Computing feature acts:  12%|█▏        | 38/313 [00:36<04:24,  1.04it/s]Computing feature acts:  12%|█▏        | 39/313 [00:37<04:22,  1.04it/s]Computing feature acts:  13%|█▎        | 40/313 [00:38<04:21,  1.04it/s]Computing feature acts:  13%|█▎        | 41/313 [00:39<04:20,  1.05it/s]Computing feature acts:  13%|█▎        | 42/313 [00:40<04:18,  1.05it/s]Computing feature acts:  14%|█▎        | 43/313 [00:41<04:17,  1.05it/s]Computing feature acts:  14%|█▍        | 44/313 [00:42<04:16,  1.05it/s]Computing feature acts:  14%|█▍        | 45/313 [00:43<04:15,  1.05it/s]Computing feature acts:  15%|█▍        | 46/313 [00:44<04:14,  1.05it/s]Computing feature acts:  15%|█▌        | 47/313 [00:45<04:13,  1.05it/s]Computing feature acts:  15%|█▌        | 48/313 [00:46<04:12,  1.05it/s]Computing feature acts:  16%|█▌        | 49/313 [00:47<04:11,  1.05it/s]Computing feature acts:  16%|█▌        | 50/313 [00:48<04:10,  1.05it/s]Computing feature acts:  16%|█▋        | 51/313 [00:49<04:09,  1.05it/s]Computing feature acts:  17%|█▋        | 52/313 [00:49<04:08,  1.05it/s]Computing feature acts:  17%|█▋        | 53/313 [00:50<04:07,  1.05it/s]Computing feature acts:  17%|█▋        | 54/313 [00:51<04:06,  1.05it/s]Computing feature acts:  18%|█▊        | 55/313 [00:53<04:27,  1.04s/it]Computing feature acts:  18%|█▊        | 56/313 [00:54<04:41,  1.09s/it]Computing feature acts:  18%|█▊        | 57/313 [00:55<04:50,  1.13s/it]Computing feature acts:  19%|█▊        | 58/313 [00:56<04:56,  1.16s/it]Computing feature acts:  19%|█▉        | 59/313 [00:58<05:00,  1.18s/it]Computing feature acts:  19%|█▉        | 60/313 [00:59<05:02,  1.20s/it]Computing feature acts:  19%|█▉        | 61/313 [01:00<05:04,  1.21s/it]Computing feature acts:  20%|█▉        | 62/313 [01:01<05:05,  1.22s/it]Computing feature acts:  20%|██        | 63/313 [01:02<05:05,  1.22s/it]Computing feature acts:  20%|██        | 64/313 [01:04<05:04,  1.22s/it]Computing feature acts:  21%|██        | 65/313 [01:05<05:04,  1.23s/it]Computing feature acts:  21%|██        | 66/313 [01:06<05:03,  1.23s/it]Computing feature acts:  21%|██▏       | 67/313 [01:07<05:02,  1.23s/it]Computing feature acts:  22%|██▏       | 68/313 [01:09<05:01,  1.23s/it]Computing feature acts:  22%|██▏       | 69/313 [01:10<05:00,  1.23s/it]Computing feature acts:  22%|██▏       | 70/313 [01:11<04:59,  1.23s/it]Computing feature acts:  23%|██▎       | 71/313 [01:12<04:57,  1.23s/it]Computing feature acts:  23%|██▎       | 72/313 [01:14<04:56,  1.23s/it]Computing feature acts:  23%|██▎       | 73/313 [01:15<04:55,  1.23s/it]Computing feature acts:  24%|██▎       | 74/313 [01:16<04:53,  1.23s/it]Computing feature acts:  24%|██▍       | 75/313 [01:17<04:52,  1.23s/it]Computing feature acts:  24%|██▍       | 76/313 [01:18<04:51,  1.23s/it]Computing feature acts:  25%|██▍       | 77/313 [01:20<04:49,  1.23s/it]Computing feature acts:  25%|██▍       | 78/313 [01:21<04:48,  1.23s/it]Computing feature acts:  25%|██▌       | 79/313 [01:22<04:48,  1.23s/it]Computing feature acts:  26%|██▌       | 80/313 [01:23<04:46,  1.23s/it]Computing feature acts:  26%|██▌       | 81/313 [01:25<04:45,  1.23s/it]Computing feature acts:  26%|██▌       | 82/313 [01:26<04:44,  1.23s/it]Computing feature acts:  27%|██▋       | 83/313 [01:27<04:42,  1.23s/it]Computing feature acts:  27%|██▋       | 84/313 [01:28<04:41,  1.23s/it]Computing feature acts:  27%|██▋       | 85/313 [01:29<04:39,  1.23s/it]Computing feature acts:  27%|██▋       | 86/313 [01:31<04:38,  1.23s/it]Computing feature acts:  28%|██▊       | 87/313 [01:32<04:37,  1.23s/it]Computing feature acts:  28%|██▊       | 88/313 [01:33<04:36,  1.23s/it]Computing feature acts:  28%|██▊       | 89/313 [01:34<04:34,  1.23s/it]Computing feature acts:  29%|██▉       | 90/313 [01:36<04:33,  1.23s/it]Computing feature acts:  29%|██▉       | 91/313 [01:37<04:32,  1.23s/it]Computing feature acts:  29%|██▉       | 92/313 [01:38<04:30,  1.23s/it]Computing feature acts:  30%|██▉       | 93/313 [01:39<04:29,  1.23s/it]Computing feature acts:  30%|███       | 94/313 [01:41<04:28,  1.23s/it]Computing feature acts:  30%|███       | 95/313 [01:42<04:27,  1.23s/it]Computing feature acts:  31%|███       | 96/313 [01:43<04:26,  1.23s/it]Computing feature acts:  31%|███       | 97/313 [01:44<04:25,  1.23s/it]Computing feature acts:  31%|███▏      | 98/313 [01:45<04:24,  1.23s/it]Computing feature acts:  32%|███▏      | 99/313 [01:47<04:12,  1.18s/it]Computing feature acts:  32%|███▏      | 100/313 [01:47<03:56,  1.11s/it]Computing feature acts:  32%|███▏      | 101/313 [01:48<03:45,  1.06s/it]Computing feature acts:  33%|███▎      | 102/313 [01:49<03:37,  1.03s/it]Computing feature acts:  33%|███▎      | 103/313 [01:50<03:31,  1.01s/it]Computing feature acts:  33%|███▎      | 104/313 [01:51<03:26,  1.01it/s]Computing feature acts:  34%|███▎      | 105/313 [01:52<03:23,  1.02it/s]Computing feature acts:  34%|███▍      | 106/313 [01:53<03:21,  1.03it/s]Computing feature acts:  34%|███▍      | 107/313 [01:54<03:18,  1.04it/s]Computing feature acts:  35%|███▍      | 108/313 [01:55<03:17,  1.04it/s]Computing feature acts:  35%|███▍      | 109/313 [01:56<03:15,  1.04it/s]Computing feature acts:  35%|███▌      | 110/313 [01:57<03:14,  1.04it/s]Computing feature acts:  35%|███▌      | 111/313 [01:58<03:13,  1.05it/s]Computing feature acts:  36%|███▌      | 112/313 [01:59<03:11,  1.05it/s]Computing feature acts:  36%|███▌      | 113/313 [02:00<03:10,  1.05it/s]Computing feature acts:  36%|███▋      | 114/313 [02:01<03:09,  1.05it/s]Computing feature acts:  37%|███▋      | 115/313 [02:02<03:08,  1.05it/s]Computing feature acts:  37%|███▋      | 116/313 [02:03<03:07,  1.05it/s]Computing feature acts:  37%|███▋      | 117/313 [02:04<03:06,  1.05it/s]Computing feature acts:  38%|███▊      | 118/313 [02:05<03:05,  1.05it/s]Computing feature acts:  38%|███▊      | 119/313 [02:06<03:04,  1.05it/s]Computing feature acts:  38%|███▊      | 120/313 [02:07<03:03,  1.05it/s]Computing feature acts:  39%|███▊      | 121/313 [02:07<03:02,  1.05it/s]Computing feature acts:  39%|███▉      | 122/313 [02:08<03:01,  1.05it/s]Computing feature acts:  39%|███▉      | 123/313 [02:09<03:00,  1.05it/s]Computing feature acts:  40%|███▉      | 124/313 [02:10<02:59,  1.05it/s]Computing feature acts:  40%|███▉      | 125/313 [02:11<02:59,  1.05it/s]Computing feature acts:  40%|████      | 126/313 [02:12<02:58,  1.05it/s]Computing feature acts:  41%|████      | 127/313 [02:13<02:57,  1.05it/s]Computing feature acts:  41%|████      | 128/313 [02:14<02:56,  1.05it/s]Computing feature acts:  41%|████      | 129/313 [02:15<02:55,  1.05it/s]Computing feature acts:  42%|████▏     | 130/313 [02:16<02:54,  1.05it/s]Computing feature acts:  42%|████▏     | 131/313 [02:17<02:53,  1.05it/s]Computing feature acts:  42%|████▏     | 132/313 [02:18<02:52,  1.05it/s]Computing feature acts:  42%|████▏     | 133/313 [02:19<02:51,  1.05it/s]Computing feature acts:  43%|████▎     | 134/313 [02:20<02:50,  1.05it/s]Computing feature acts:  43%|████▎     | 135/313 [02:21<02:49,  1.05it/s]Computing feature acts:  43%|████▎     | 136/313 [02:22<02:49,  1.04it/s]Computing feature acts:  44%|████▍     | 137/313 [02:23<02:48,  1.05it/s]Computing feature acts:  44%|████▍     | 138/313 [02:24<02:47,  1.05it/s]Computing feature acts:  44%|████▍     | 139/313 [02:25<02:45,  1.05it/s]Computing feature acts:  45%|████▍     | 140/313 [02:26<02:44,  1.05it/s]Computing feature acts:  45%|████▌     | 141/313 [02:27<02:43,  1.05it/s]Computing feature acts:  45%|████▌     | 142/313 [02:27<02:42,  1.05it/s]Computing feature acts:  46%|████▌     | 143/313 [02:28<02:41,  1.05it/s]Computing feature acts:  46%|████▌     | 144/313 [02:29<02:40,  1.06it/s]Computing feature acts:  46%|████▋     | 145/313 [02:30<02:39,  1.06it/s]Computing feature acts:  47%|████▋     | 146/313 [02:31<02:38,  1.05it/s]Computing feature acts:  47%|████▋     | 147/313 [02:32<02:37,  1.05it/s]Computing feature acts:  47%|████▋     | 148/313 [02:33<02:36,  1.05it/s]Computing feature acts:  48%|████▊     | 149/313 [02:34<02:35,  1.05it/s]Computing feature acts:  48%|████▊     | 150/313 [02:35<02:34,  1.05it/s]Computing feature acts:  48%|████▊     | 151/313 [02:36<02:33,  1.05it/s]Computing feature acts:  49%|████▊     | 152/313 [02:37<02:32,  1.06it/s]Computing feature acts:  49%|████▉     | 153/313 [02:38<02:31,  1.05it/s]Computing feature acts:  49%|████▉     | 154/313 [02:39<02:30,  1.06it/s]Computing feature acts:  50%|████▉     | 155/313 [02:40<02:29,  1.06it/s]Computing feature acts:  50%|████▉     | 156/313 [02:41<02:28,  1.06it/s]Computing feature acts:  50%|█████     | 157/313 [02:42<02:27,  1.06it/s]Computing feature acts:  50%|█████     | 158/313 [02:43<02:26,  1.06it/s]Computing feature acts:  51%|█████     | 159/313 [02:44<02:25,  1.06it/s]Computing feature acts:  51%|█████     | 160/313 [02:45<02:24,  1.06it/s]Computing feature acts:  51%|█████▏    | 161/313 [02:45<02:23,  1.06it/s]Computing feature acts:  52%|█████▏    | 162/313 [02:46<02:22,  1.06it/s]Computing feature acts:  52%|█████▏    | 163/313 [02:47<02:21,  1.06it/s]Computing feature acts:  52%|█████▏    | 164/313 [02:48<02:25,  1.02it/s]Computing feature acts:  53%|█████▎    | 165/313 [02:49<02:23,  1.03it/s]Computing feature acts:  53%|█████▎    | 166/313 [02:50<02:21,  1.04it/s]Computing feature acts:  53%|█████▎    | 167/313 [02:51<02:19,  1.05it/s]Computing feature acts:  54%|█████▎    | 168/313 [02:52<02:18,  1.05it/s]Computing feature acts:  54%|█████▍    | 169/313 [02:53<02:17,  1.05it/s]Computing feature acts:  54%|█████▍    | 170/313 [02:54<02:15,  1.05it/s]Computing feature acts:  55%|█████▍    | 171/313 [02:55<02:14,  1.05it/s]Computing feature acts:  55%|█████▍    | 172/313 [02:56<02:13,  1.06it/s]Computing feature acts:  55%|█████▌    | 173/313 [02:57<02:12,  1.05it/s]Computing feature acts:  56%|█████▌    | 174/313 [02:58<02:11,  1.06it/s]Computing feature acts:  56%|█████▌    | 175/313 [02:59<02:10,  1.06it/s]Computing feature acts:  56%|█████▌    | 176/313 [03:00<02:09,  1.06it/s]Computing feature acts:  57%|█████▋    | 177/313 [03:01<02:08,  1.06it/s]Computing feature acts:  57%|█████▋    | 178/313 [03:02<02:07,  1.06it/s]Computing feature acts:  57%|█████▋    | 179/313 [03:03<02:06,  1.06it/s]Computing feature acts:  58%|█████▊    | 180/313 [03:04<02:05,  1.06it/s]Computing feature acts:  58%|█████▊    | 181/313 [03:05<02:05,  1.06it/s]Computing feature acts:  58%|█████▊    | 182/313 [03:05<02:03,  1.06it/s]Computing feature acts:  58%|█████▊    | 183/313 [03:06<02:03,  1.06it/s]Computing feature acts:  59%|█████▉    | 184/313 [03:07<02:01,  1.06it/s]Computing feature acts:  59%|█████▉    | 185/313 [03:08<02:01,  1.06it/s]Computing feature acts:  59%|█████▉    | 186/313 [03:09<02:00,  1.06it/s]Computing feature acts:  60%|█████▉    | 187/313 [03:11<02:16,  1.09s/it]Computing feature acts:  60%|██████    | 188/313 [03:12<02:10,  1.05s/it]Computing feature acts:  60%|██████    | 189/313 [03:13<02:06,  1.02s/it]Computing feature acts:  61%|██████    | 190/313 [03:14<02:02,  1.00it/s]Computing feature acts:  61%|██████    | 191/313 [03:14<02:00,  1.02it/s]Computing feature acts:  61%|██████▏   | 192/313 [03:15<01:57,  1.03it/s]Computing feature acts:  62%|██████▏   | 193/313 [03:16<01:56,  1.03it/s]Computing feature acts:  62%|██████▏   | 194/313 [03:17<01:54,  1.04it/s]Computing feature acts:  62%|██████▏   | 195/313 [03:18<01:53,  1.04it/s]Computing feature acts:  63%|██████▎   | 196/313 [03:19<01:52,  1.04it/s]Computing feature acts:  63%|██████▎   | 197/313 [03:20<01:50,  1.05it/s]Computing feature acts:  63%|██████▎   | 198/313 [03:21<01:49,  1.05it/s]Computing feature acts:  64%|██████▎   | 199/313 [03:22<01:48,  1.05it/s]Computing feature acts:  64%|██████▍   | 200/313 [03:23<01:47,  1.05it/s]Computing feature acts:  64%|██████▍   | 201/313 [03:24<01:46,  1.05it/s]Computing feature acts:  65%|██████▍   | 202/313 [03:25<01:45,  1.05it/s]Computing feature acts:  65%|██████▍   | 203/313 [03:26<01:44,  1.05it/s]Computing feature acts:  65%|██████▌   | 204/313 [03:27<01:43,  1.05it/s]Computing feature acts:  65%|██████▌   | 205/313 [03:28<01:42,  1.05it/s]Computing feature acts:  66%|██████▌   | 206/313 [03:29<01:41,  1.05it/s]Computing feature acts:  66%|██████▌   | 207/313 [03:30<01:40,  1.05it/s]Computing feature acts:  66%|██████▋   | 208/313 [03:31<01:39,  1.05it/s]Computing feature acts:  67%|██████▋   | 209/313 [03:32<01:38,  1.05it/s]Computing feature acts:  67%|██████▋   | 210/313 [03:33<01:37,  1.05it/s]Computing feature acts:  67%|██████▋   | 211/313 [03:33<01:37,  1.05it/s]Computing feature acts:  68%|██████▊   | 212/313 [03:34<01:35,  1.05it/s]Computing feature acts:  68%|██████▊   | 213/313 [03:35<01:35,  1.05it/s]Computing feature acts:  68%|██████▊   | 214/313 [03:36<01:34,  1.05it/s]Computing feature acts:  69%|██████▊   | 215/313 [03:37<01:33,  1.05it/s]Computing feature acts:  69%|██████▉   | 216/313 [03:38<01:32,  1.05it/s]Computing feature acts:  69%|██████▉   | 217/313 [03:39<01:31,  1.05it/s]Computing feature acts:  70%|██████▉   | 218/313 [03:40<01:30,  1.05it/s]Computing feature acts:  70%|██████▉   | 219/313 [03:41<01:29,  1.05it/s]Computing feature acts:  70%|███████   | 220/313 [03:42<01:28,  1.05it/s]Computing feature acts:  71%|███████   | 221/313 [03:43<01:27,  1.05it/s]Computing feature acts:  71%|███████   | 222/313 [03:44<01:26,  1.05it/s]Computing feature acts:  71%|███████   | 223/313 [03:45<01:25,  1.05it/s]Computing feature acts:  72%|███████▏  | 224/313 [03:46<01:24,  1.05it/s]Computing feature acts:  72%|███████▏  | 225/313 [03:47<01:23,  1.05it/s]Computing feature acts:  72%|███████▏  | 226/313 [03:48<01:22,  1.05it/s]Computing feature acts:  73%|███████▎  | 227/313 [03:49<01:21,  1.05it/s]Computing feature acts:  73%|███████▎  | 228/313 [03:50<01:20,  1.05it/s]Computing feature acts:  73%|███████▎  | 229/313 [03:51<01:22,  1.02it/s]Computing feature acts:  73%|███████▎  | 230/313 [03:52<01:20,  1.03it/s]Computing feature acts:  74%|███████▍  | 231/313 [03:53<01:20,  1.01it/s]Computing feature acts:  74%|███████▍  | 232/313 [03:54<01:19,  1.01it/s]Computing feature acts:  74%|███████▍  | 233/313 [03:55<01:19,  1.01it/s]Computing feature acts:  75%|███████▍  | 234/313 [03:56<01:18,  1.01it/s]Computing feature acts:  75%|███████▌  | 235/313 [03:57<01:17,  1.01it/s]Computing feature acts:  75%|███████▌  | 236/313 [03:58<01:16,  1.00it/s]Computing feature acts:  76%|███████▌  | 237/313 [03:59<01:15,  1.01it/s]Computing feature acts:  76%|███████▌  | 238/313 [04:00<01:14,  1.01it/s]Computing feature acts:  76%|███████▋  | 239/313 [04:01<01:13,  1.01it/s]Computing feature acts:  77%|███████▋  | 240/313 [04:02<01:12,  1.01it/s]Computing feature acts:  77%|███████▋  | 241/313 [04:03<01:11,  1.00it/s]Computing feature acts:  77%|███████▋  | 242/313 [04:04<01:10,  1.01it/s]Computing feature acts:  78%|███████▊  | 243/313 [04:05<01:09,  1.00it/s]Computing feature acts:  78%|███████▊  | 244/313 [04:06<01:08,  1.00it/s]Computing feature acts:  78%|███████▊  | 245/313 [04:07<01:07,  1.00it/s]Computing feature acts:  79%|███████▊  | 246/313 [04:08<01:06,  1.00it/s]Computing feature acts:  79%|███████▉  | 247/313 [04:09<01:05,  1.00it/s]Computing feature acts:  79%|███████▉  | 248/313 [04:10<01:04,  1.00it/s]Computing feature acts:  80%|███████▉  | 249/313 [04:11<01:03,  1.00it/s]Computing feature acts:  80%|███████▉  | 250/313 [04:12<01:02,  1.00it/s]Computing feature acts:  80%|████████  | 251/313 [04:13<01:01,  1.00it/s]Computing feature acts:  81%|████████  | 252/313 [04:14<01:00,  1.00it/s]Computing feature acts:  81%|████████  | 253/313 [04:15<00:59,  1.00it/s]Computing feature acts:  81%|████████  | 254/313 [04:16<00:58,  1.00it/s]Computing feature acts:  81%|████████▏ | 255/313 [04:17<00:57,  1.00it/s]Computing feature acts:  82%|████████▏ | 256/313 [04:18<00:56,  1.00it/s]Computing feature acts:  82%|████████▏ | 257/313 [04:19<00:56,  1.00s/it]Computing feature acts:  82%|████████▏ | 258/313 [04:20<00:55,  1.01s/it]Computing feature acts:  83%|████████▎ | 259/313 [04:21<00:55,  1.04s/it]Computing feature acts:  83%|████████▎ | 260/313 [04:22<00:56,  1.06s/it]Computing feature acts:  83%|████████▎ | 261/313 [04:23<00:56,  1.09s/it]Computing feature acts:  84%|████████▎ | 262/313 [04:24<00:56,  1.10s/it]Computing feature acts:  84%|████████▍ | 263/313 [04:25<00:55,  1.11s/it]Computing feature acts:  84%|████████▍ | 264/313 [04:26<00:54,  1.12s/it]Computing feature acts:  85%|████████▍ | 265/313 [04:28<00:53,  1.12s/it]Computing feature acts:  85%|████████▍ | 266/313 [04:29<00:52,  1.12s/it]Computing feature acts:  85%|████████▌ | 267/313 [04:30<00:51,  1.12s/it]Computing feature acts:  86%|████████▌ | 268/313 [04:31<00:50,  1.12s/it]Computing feature acts:  86%|████████▌ | 269/313 [04:32<00:48,  1.11s/it]Computing feature acts:  86%|████████▋ | 270/313 [04:33<00:47,  1.11s/it]Computing feature acts:  87%|████████▋ | 271/313 [04:34<00:46,  1.10s/it]Computing feature acts:  87%|████████▋ | 272/313 [04:35<00:45,  1.10s/it]Computing feature acts:  87%|████████▋ | 273/313 [04:36<00:44,  1.11s/it]Computing feature acts:  88%|████████▊ | 274/313 [04:37<00:41,  1.07s/it]Computing feature acts:  88%|████████▊ | 275/313 [04:38<00:38,  1.02s/it]Computing feature acts:  88%|████████▊ | 276/313 [04:39<00:36,  1.02it/s]Computing feature acts:  88%|████████▊ | 277/313 [04:40<00:34,  1.05it/s]Computing feature acts:  89%|████████▉ | 278/313 [04:41<00:32,  1.07it/s]Computing feature acts:  89%|████████▉ | 279/313 [04:42<00:31,  1.09it/s]Computing feature acts:  89%|████████▉ | 280/313 [04:43<00:29,  1.10it/s]Computing feature acts:  90%|████████▉ | 281/313 [04:44<00:28,  1.11it/s]Computing feature acts:  90%|█████████ | 282/313 [04:44<00:27,  1.12it/s]Computing feature acts:  90%|█████████ | 283/313 [04:45<00:26,  1.12it/s]Computing feature acts:  91%|█████████ | 284/313 [04:46<00:25,  1.12it/s]Computing feature acts:  91%|█████████ | 285/313 [04:47<00:24,  1.13it/s]Computing feature acts:  91%|█████████▏| 286/313 [04:48<00:23,  1.13it/s]Computing feature acts:  92%|█████████▏| 287/313 [04:49<00:23,  1.13it/s]Computing feature acts:  92%|█████████▏| 288/313 [04:50<00:22,  1.13it/s]Computing feature acts:  92%|█████████▏| 289/313 [04:51<00:21,  1.13it/s]Computing feature acts:  93%|█████████▎| 290/313 [04:52<00:20,  1.13it/s]Computing feature acts:  93%|█████████▎| 291/313 [04:52<00:19,  1.13it/s]Computing feature acts:  93%|█████████▎| 292/313 [04:53<00:18,  1.13it/s]Computing feature acts:  94%|█████████▎| 293/313 [04:54<00:17,  1.13it/s]Computing feature acts:  94%|█████████▍| 294/313 [04:55<00:16,  1.13it/s]Computing feature acts:  94%|█████████▍| 295/313 [04:56<00:16,  1.09it/s]Computing feature acts:  95%|█████████▍| 296/313 [04:57<00:15,  1.10it/s]Computing feature acts:  95%|█████████▍| 297/313 [04:58<00:14,  1.11it/s]Computing feature acts:  95%|█████████▌| 298/313 [04:59<00:13,  1.11it/s]Computing feature acts:  96%|█████████▌| 299/313 [05:00<00:12,  1.12it/s]Computing feature acts:  96%|█████████▌| 300/313 [05:01<00:11,  1.12it/s]Computing feature acts:  96%|█████████▌| 301/313 [05:01<00:10,  1.12it/s]Computing feature acts:  96%|█████████▋| 302/313 [05:02<00:09,  1.13it/s]Computing feature acts:  97%|█████████▋| 303/313 [05:03<00:08,  1.13it/s]Computing feature acts:  97%|█████████▋| 304/313 [05:04<00:07,  1.13it/s]Computing feature acts:  97%|█████████▋| 305/313 [05:05<00:07,  1.13it/s]Computing feature acts:  98%|█████████▊| 306/313 [05:06<00:06,  1.13it/s]Computing feature acts:  98%|█████████▊| 307/313 [05:07<00:05,  1.13it/s]Computing feature acts:  98%|█████████▊| 308/313 [05:08<00:04,  1.13it/s]Computing feature acts:  99%|█████████▊| 309/313 [05:08<00:03,  1.14it/s]Computing feature acts:  99%|█████████▉| 310/313 [05:09<00:02,  1.14it/s]Computing feature acts:  99%|█████████▉| 311/313 [05:10<00:01,  1.14it/s]Computing feature acts: 100%|█████████▉| 312/313 [05:11<00:00,  1.14it/s]Computing feature acts: 100%|██████████| 313/313 [05:12<00:00,  1.14it/s]Computing feature acts: 100%|██████████| 313/313 [05:13<00:00,  1.00s/it]
Parsing activation data:   0%|          | 0/4 [00:00<?, ?it/s]Parsing activation data:  25%|██▌       | 1/4 [00:05<00:15,  5.19s/it]Parsing activation data:  50%|█████     | 2/4 [00:10<00:10,  5.22s/it]Parsing activation data:  75%|███████▌  | 3/4 [00:15<00:05,  5.08s/it]Parsing activation data: 100%|██████████| 4/4 [00:17<00:00,  4.09s/it]Parsing activation data: 100%|██████████| 4/4 [00:17<00:00,  4.48s/it]
2024-04-16 01:56:40 - INFO - Saving HTML feature dashboards for the SAE at blocks.2.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/4 [00:00<?, ?it/s]Dashboard HTML files:  25%|██▌       | 1/4 [00:02<00:07,  2.64s/it]Dashboard HTML files:  50%|█████     | 2/4 [00:05<00:05,  2.57s/it]Dashboard HTML files:  75%|███████▌  | 3/4 [00:07<00:02,  2.47s/it]Dashboard HTML files: 100%|██████████| 4/4 [00:09<00:00,  2.15s/it]Dashboard HTML files: 100%|██████████| 4/4 [00:09<00:00,  2.30s/it]
2024-04-16 01:56:50 - INFO - Finished.
2024-04-16 01:56:50 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-2_region-1_local-ue3lz0n7_Blue_cluster_near_top') save_json_data=False sae_positions=None feature_indices=[32091, 32206, 52129, 61781] prompt_centric=None seed=0
2024-04-16 01:56:50 - INFO - Loading the model and SAEs
2024-04-16 01:56:50 - INFO - wandb_project='gpt2-layerwise_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/mnt/ssd-interp/dan/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=40000 eval_n_samples=500 batch_size=8 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=0.8, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=1.0), logits_kl=None) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.2.hook_resid_pre'])
2024-04-16 01:56:53 - INFO - done
2024-04-16 01:56:53 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-2_region-1_local-ue3lz0n7_Blue_cluster_near_top
run_sae_path = /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Traceback (most recent call last):
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 51, in <module>
    fire.Fire(main)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 48, in main
    generate_dashboards(dashbaords_config, run_sae_path)
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 1005, in main
    generate_dashboards(model, dashboards_config, save_dir=save_dir)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 852, in generate_dashboards
    dashboards_data: dict[str, SaeVisData] = get_dashboards_data(
                                             ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 385, in get_dashboards_data
    assert (
AssertionError: Error: Some feature indices are greater than the number of SAE features
2024-04-16 01:56:59 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-2_region-2_e2e-ovhfts9n_Orange_cluster_on_middle_left') save_json_data=False sae_positions=None feature_indices=[199, 232, 481, 801, 1681, 1959, 2605, 3169, 3784, 4494, 5111, 7829, 8467, 8483, 9521, 10000, 10058, 10360, 10370, 12169, 13346, 15308, 18384, 18442, 18783, 19021, 19567, 21368] prompt_centric=None seed=0
2024-04-16 01:56:59 - INFO - Loading the model and SAEs
2024-04-16 01:56:59 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=0.5, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.2.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-16 01:57:12 - INFO - done
2024-04-16 01:57:12 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-2_region-2_e2e-ovhfts9n_Orange_cluster_on_middle_left
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/313 [00:00<?, ?it/s]Computing feature acts:   0%|          | 1/313 [00:01<07:32,  1.45s/it]Computing feature acts:   1%|          | 2/313 [00:02<05:43,  1.10s/it]Computing feature acts:   1%|          | 3/313 [00:03<05:13,  1.01s/it]Computing feature acts:   1%|▏         | 4/313 [00:04<05:03,  1.02it/s]Computing feature acts:   2%|▏         | 5/313 [00:05<04:55,  1.04it/s]Computing feature acts:   2%|▏         | 6/313 [00:05<04:47,  1.07it/s]Computing feature acts:   2%|▏         | 7/313 [00:06<04:38,  1.10it/s]Computing feature acts:   3%|▎         | 8/313 [00:07<04:32,  1.12it/s]Computing feature acts:   3%|▎         | 9/313 [00:08<04:31,  1.12it/s]Computing feature acts:   3%|▎         | 10/313 [00:09<04:42,  1.07it/s]Computing feature acts:   4%|▎         | 11/313 [00:10<04:47,  1.05it/s]Computing feature acts:   4%|▍         | 12/313 [00:11<04:57,  1.01it/s]Computing feature acts:   4%|▍         | 13/313 [00:12<05:08,  1.03s/it]Computing feature acts:   4%|▍         | 14/313 [00:13<05:14,  1.05s/it]Computing feature acts:   5%|▍         | 15/313 [00:14<05:09,  1.04s/it]Computing feature acts:   5%|▌         | 16/313 [00:15<05:06,  1.03s/it]Computing feature acts:   5%|▌         | 17/313 [00:16<05:06,  1.04s/it]Computing feature acts:   6%|▌         | 18/313 [00:18<05:08,  1.04s/it]Computing feature acts:   6%|▌         | 19/313 [00:19<05:06,  1.04s/it]Computing feature acts:   6%|▋         | 20/313 [00:20<05:07,  1.05s/it]Computing feature acts:   7%|▋         | 21/313 [00:21<05:05,  1.05s/it]Computing feature acts:   7%|▋         | 22/313 [00:22<05:14,  1.08s/it]Computing feature acts:   7%|▋         | 23/313 [00:23<05:09,  1.07s/it]Computing feature acts:   8%|▊         | 24/313 [00:24<05:05,  1.06s/it]Computing feature acts:   8%|▊         | 25/313 [00:25<05:03,  1.05s/it]Computing feature acts:   8%|▊         | 26/313 [00:26<05:07,  1.07s/it]Computing feature acts:   9%|▊         | 27/313 [00:27<05:03,  1.06s/it]Computing feature acts:   9%|▉         | 28/313 [00:28<05:00,  1.05s/it]Computing feature acts:   9%|▉         | 29/313 [00:29<04:58,  1.05s/it]Computing feature acts:  10%|▉         | 30/313 [00:30<05:03,  1.07s/it]Computing feature acts:  10%|▉         | 31/313 [00:32<05:14,  1.12s/it]Computing feature acts:  10%|█         | 32/313 [00:33<05:09,  1.10s/it]Computing feature acts:  11%|█         | 33/313 [00:34<05:02,  1.08s/it]Computing feature acts:  11%|█         | 34/313 [00:35<05:05,  1.10s/it]Computing feature acts:  11%|█         | 35/313 [00:36<05:00,  1.08s/it]Computing feature acts:  12%|█▏        | 36/313 [00:37<04:56,  1.07s/it]Computing feature acts:  12%|█▏        | 37/313 [00:38<04:52,  1.06s/it]Computing feature acts:  12%|█▏        | 38/313 [00:39<04:51,  1.06s/it]Computing feature acts:  12%|█▏        | 39/313 [00:40<04:48,  1.05s/it]Computing feature acts:  13%|█▎        | 40/313 [00:41<04:45,  1.04s/it]Computing feature acts:  13%|█▎        | 41/313 [00:42<04:43,  1.04s/it]Computing feature acts:  13%|█▎        | 42/313 [00:43<04:42,  1.04s/it]Computing feature acts:  14%|█▎        | 43/313 [00:44<04:41,  1.04s/it]Computing feature acts:  14%|█▍        | 44/313 [00:45<04:50,  1.08s/it]Computing feature acts:  14%|█▍        | 45/313 [00:46<04:47,  1.07s/it]Computing feature acts:  15%|█▍        | 46/313 [00:47<04:46,  1.07s/it]Computing feature acts:  15%|█▌        | 47/313 [00:48<04:43,  1.07s/it]Computing feature acts:  15%|█▌        | 48/313 [00:50<04:42,  1.06s/it]Computing feature acts:  16%|█▌        | 49/313 [00:51<04:49,  1.10s/it]Computing feature acts:  16%|█▌        | 50/313 [00:52<04:54,  1.12s/it]Computing feature acts:  16%|█▋        | 51/313 [00:53<04:47,  1.10s/it]Computing feature acts:  17%|█▋        | 52/313 [00:54<04:41,  1.08s/it]Computing feature acts:  17%|█▋        | 53/313 [00:55<04:41,  1.08s/it]Computing feature acts:  17%|█▋        | 54/313 [00:56<04:44,  1.10s/it]Computing feature acts:  18%|█▊        | 55/313 [00:57<04:39,  1.08s/it]Computing feature acts:  18%|█▊        | 56/313 [00:58<04:36,  1.08s/it]Computing feature acts:  18%|█▊        | 57/313 [00:59<04:38,  1.09s/it]Computing feature acts:  19%|█▊        | 58/313 [01:01<04:40,  1.10s/it]Computing feature acts:  19%|█▉        | 59/313 [01:02<04:35,  1.09s/it]Computing feature acts:  19%|█▉        | 60/313 [01:03<04:29,  1.06s/it]Computing feature acts:  19%|█▉        | 61/313 [01:04<04:26,  1.06s/it]Computing feature acts:  20%|█▉        | 62/313 [01:05<04:30,  1.08s/it]Computing feature acts:  20%|██        | 63/313 [01:06<04:26,  1.07s/it]Computing feature acts:  20%|██        | 64/313 [01:07<04:24,  1.06s/it]Computing feature acts:  21%|██        | 65/313 [01:08<04:21,  1.05s/it]Computing feature acts:  21%|██        | 66/313 [01:09<04:21,  1.06s/it]Computing feature acts:  21%|██▏       | 67/313 [01:10<04:16,  1.04s/it]Computing feature acts:  22%|██▏       | 68/313 [01:11<04:13,  1.03s/it]Computing feature acts:  22%|██▏       | 69/313 [01:12<04:10,  1.03s/it]Computing feature acts:  22%|██▏       | 70/313 [01:13<04:24,  1.09s/it]Computing feature acts:  23%|██▎       | 71/313 [01:14<04:18,  1.07s/it]Computing feature acts:  23%|██▎       | 72/313 [01:15<04:15,  1.06s/it]Computing feature acts:  23%|██▎       | 73/313 [01:16<04:14,  1.06s/it]Computing feature acts:  24%|██▎       | 74/313 [01:17<04:12,  1.06s/it]Computing feature acts:  24%|██▍       | 75/313 [01:18<04:11,  1.05s/it]Computing feature acts:  24%|██▍       | 76/313 [01:19<04:07,  1.04s/it]Computing feature acts:  25%|██▍       | 77/313 [01:21<04:07,  1.05s/it]Computing feature acts:  25%|██▍       | 78/313 [01:21<03:56,  1.01s/it]Computing feature acts:  25%|██▌       | 79/313 [01:22<03:47,  1.03it/s]Computing feature acts:  26%|██▌       | 80/313 [01:23<03:50,  1.01it/s]Computing feature acts:  26%|██▌       | 81/313 [01:24<03:52,  1.00s/it]Computing feature acts:  26%|██▌       | 82/313 [01:25<03:55,  1.02s/it]Computing feature acts:  27%|██▋       | 83/313 [01:26<03:57,  1.03s/it]Computing feature acts:  27%|██▋       | 84/313 [01:27<03:49,  1.00s/it]Computing feature acts:  27%|██▋       | 85/313 [01:28<03:47,  1.00it/s]Computing feature acts:  27%|██▋       | 86/313 [01:29<03:51,  1.02s/it]Computing feature acts:  28%|██▊       | 87/313 [01:30<03:44,  1.00it/s]Computing feature acts:  28%|██▊       | 88/313 [01:31<03:36,  1.04it/s]Computing feature acts:  28%|██▊       | 89/313 [01:32<03:31,  1.06it/s]Computing feature acts:  29%|██▉       | 90/313 [01:33<03:31,  1.06it/s]Computing feature acts:  29%|██▉       | 91/313 [01:34<03:27,  1.07it/s]Computing feature acts:  29%|██▉       | 92/313 [01:35<03:23,  1.08it/s]Computing feature acts:  30%|██▉       | 93/313 [01:36<03:21,  1.09it/s]Computing feature acts:  30%|███       | 94/313 [01:37<03:23,  1.08it/s]Computing feature acts:  30%|███       | 95/313 [01:38<03:27,  1.05it/s]Computing feature acts:  31%|███       | 96/313 [01:39<03:43,  1.03s/it]Computing feature acts:  31%|███       | 97/313 [01:40<03:43,  1.03s/it]Computing feature acts:  31%|███▏      | 98/313 [01:41<03:44,  1.05s/it]Computing feature acts:  32%|███▏      | 99/313 [01:42<03:43,  1.04s/it]Computing feature acts:  32%|███▏      | 100/313 [01:43<03:43,  1.05s/it]Computing feature acts:  32%|███▏      | 101/313 [01:44<03:42,  1.05s/it]Computing feature acts:  33%|███▎      | 102/313 [01:45<03:43,  1.06s/it]Computing feature acts:  33%|███▎      | 103/313 [01:46<03:42,  1.06s/it]Computing feature acts:  33%|███▎      | 104/313 [01:47<03:41,  1.06s/it]Computing feature acts:  34%|███▎      | 105/313 [01:49<03:40,  1.06s/it]Computing feature acts:  34%|███▍      | 106/313 [01:50<03:45,  1.09s/it]Computing feature acts:  34%|███▍      | 107/313 [01:51<03:42,  1.08s/it]Computing feature acts:  35%|███▍      | 108/313 [01:52<03:40,  1.07s/it]Computing feature acts:  35%|███▍      | 109/313 [01:53<03:37,  1.07s/it]Computing feature acts:  35%|███▌      | 110/313 [01:54<03:37,  1.07s/it]Computing feature acts:  35%|███▌      | 111/313 [01:55<03:35,  1.07s/it]Computing feature acts:  36%|███▌      | 112/313 [01:56<03:32,  1.06s/it]Computing feature acts:  36%|███▌      | 113/313 [01:57<03:23,  1.02s/it]Computing feature acts:  36%|███▋      | 114/313 [01:58<03:22,  1.02s/it]Computing feature acts:  37%|███▋      | 115/313 [01:59<03:17,  1.00it/s]Computing feature acts:  37%|███▋      | 116/313 [02:00<03:13,  1.02it/s]Computing feature acts:  37%|███▋      | 117/313 [02:01<03:09,  1.04it/s]Computing feature acts:  38%|███▊      | 118/313 [02:02<03:09,  1.03it/s]Computing feature acts:  38%|███▊      | 119/313 [02:03<03:05,  1.04it/s]Computing feature acts:  38%|███▊      | 120/313 [02:04<03:04,  1.05it/s]Computing feature acts:  39%|███▊      | 121/313 [02:05<03:02,  1.05it/s]Computing feature acts:  39%|███▉      | 122/313 [02:06<03:05,  1.03it/s]Computing feature acts:  39%|███▉      | 123/313 [02:07<03:01,  1.05it/s]Computing feature acts:  40%|███▉      | 124/313 [02:07<02:57,  1.06it/s]Computing feature acts:  40%|███▉      | 125/313 [02:08<02:55,  1.07it/s]Computing feature acts:  40%|████      | 126/313 [02:09<02:59,  1.04it/s]Computing feature acts:  41%|████      | 127/313 [02:10<02:56,  1.06it/s]Computing feature acts:  41%|████      | 128/313 [02:11<02:53,  1.07it/s]Computing feature acts:  41%|████      | 129/313 [02:12<02:51,  1.08it/s]Computing feature acts:  42%|████▏     | 130/313 [02:13<02:54,  1.05it/s]Computing feature acts:  42%|████▏     | 131/313 [02:14<02:51,  1.06it/s]Computing feature acts:  42%|████▏     | 132/313 [02:15<02:49,  1.07it/s]Computing feature acts:  42%|████▏     | 133/313 [02:16<02:49,  1.06it/s]Computing feature acts:  43%|████▎     | 134/313 [02:17<02:52,  1.04it/s]Computing feature acts:  43%|████▎     | 135/313 [02:18<02:53,  1.02it/s]Computing feature acts:  43%|████▎     | 136/313 [02:19<02:55,  1.01it/s]Computing feature acts:  44%|████▍     | 137/313 [02:20<02:52,  1.02it/s]Computing feature acts:  44%|████▍     | 138/313 [02:21<02:53,  1.01it/s]Computing feature acts:  44%|████▍     | 139/313 [02:22<02:51,  1.01it/s]Computing feature acts:  45%|████▍     | 140/313 [02:23<02:50,  1.02it/s]Computing feature acts:  45%|████▌     | 141/313 [02:24<02:48,  1.02it/s]Computing feature acts:  45%|████▌     | 142/313 [02:25<02:54,  1.02s/it]Computing feature acts:  46%|████▌     | 143/313 [02:26<02:50,  1.01s/it]Computing feature acts:  46%|████▌     | 144/313 [02:27<02:48,  1.00it/s]Computing feature acts:  46%|████▋     | 145/313 [02:28<02:46,  1.01it/s]Computing feature acts:  47%|████▋     | 146/313 [02:29<02:46,  1.01it/s]Computing feature acts:  47%|████▋     | 147/313 [02:30<02:43,  1.01it/s]Computing feature acts:  47%|████▋     | 148/313 [02:31<02:42,  1.02it/s]Computing feature acts:  48%|████▊     | 149/313 [02:32<02:40,  1.02it/s]Computing feature acts:  48%|████▊     | 150/313 [02:33<02:43,  1.00s/it]Computing feature acts:  48%|████▊     | 151/313 [02:34<02:41,  1.01it/s]Computing feature acts:  49%|████▊     | 152/313 [02:35<02:39,  1.01it/s]Computing feature acts:  49%|████▉     | 153/313 [02:36<02:37,  1.02it/s]Computing feature acts:  49%|████▉     | 154/313 [02:37<02:39,  1.00s/it]Computing feature acts:  50%|████▉     | 155/313 [02:38<02:37,  1.00it/s]Computing feature acts:  50%|████▉     | 156/313 [02:39<02:35,  1.01it/s]Computing feature acts:  50%|█████     | 157/313 [02:40<02:36,  1.00s/it]Computing feature acts:  50%|█████     | 158/313 [02:41<02:39,  1.03s/it]Computing feature acts:  51%|█████     | 159/313 [02:42<02:40,  1.04s/it]Computing feature acts:  51%|█████     | 160/313 [02:43<02:40,  1.05s/it]Computing feature acts:  51%|█████▏    | 161/313 [02:44<02:48,  1.11s/it]Computing feature acts:  52%|█████▏    | 162/313 [02:45<02:40,  1.06s/it]Computing feature acts:  52%|█████▏    | 163/313 [02:46<02:36,  1.04s/it]Computing feature acts:  52%|█████▏    | 164/313 [02:47<02:31,  1.02s/it]Computing feature acts:  53%|█████▎    | 165/313 [02:48<02:30,  1.02s/it]Computing feature acts:  53%|█████▎    | 166/313 [02:49<02:31,  1.03s/it]Computing feature acts:  53%|█████▎    | 167/313 [02:50<02:31,  1.04s/it]Computing feature acts:  54%|█████▎    | 168/313 [02:51<02:30,  1.04s/it]Computing feature acts:  54%|█████▍    | 169/313 [02:52<02:26,  1.02s/it]Computing feature acts:  54%|█████▍    | 170/313 [02:53<02:25,  1.02s/it]Computing feature acts:  55%|█████▍    | 171/313 [02:54<02:24,  1.02s/it]Computing feature acts:  55%|█████▍    | 172/313 [02:56<02:25,  1.03s/it]Computing feature acts:  55%|█████▌    | 173/313 [02:57<02:25,  1.04s/it]Computing feature acts:  56%|█████▌    | 174/313 [02:58<02:28,  1.07s/it]Computing feature acts:  56%|█████▌    | 175/313 [02:59<02:20,  1.02s/it]Computing feature acts:  56%|█████▌    | 176/313 [03:00<02:17,  1.01s/it]Computing feature acts:  57%|█████▋    | 177/313 [03:01<02:17,  1.01s/it]Computing feature acts:  57%|█████▋    | 178/313 [03:02<02:21,  1.04s/it]Computing feature acts:  57%|█████▋    | 179/313 [03:03<02:21,  1.06s/it]Computing feature acts:  58%|█████▊    | 180/313 [03:04<02:21,  1.06s/it]Computing feature acts:  58%|█████▊    | 181/313 [03:05<02:21,  1.07s/it]Computing feature acts:  58%|█████▊    | 182/313 [03:06<02:19,  1.07s/it]Computing feature acts:  58%|█████▊    | 183/313 [03:07<02:13,  1.03s/it]Computing feature acts:  59%|█████▉    | 184/313 [03:08<02:12,  1.02s/it]Computing feature acts:  59%|█████▉    | 185/313 [03:09<02:11,  1.03s/it]Computing feature acts:  59%|█████▉    | 186/313 [03:10<02:09,  1.02s/it]Computing feature acts:  60%|█████▉    | 187/313 [03:11<02:14,  1.07s/it]Computing feature acts:  60%|██████    | 188/313 [03:12<02:08,  1.02s/it]Computing feature acts:  60%|██████    | 189/313 [03:13<02:03,  1.01it/s]Computing feature acts:  61%|██████    | 190/313 [03:14<02:04,  1.01s/it]Computing feature acts:  61%|██████    | 191/313 [03:15<02:05,  1.03s/it]Computing feature acts:  61%|██████▏   | 192/313 [03:16<02:06,  1.05s/it]Computing feature acts:  62%|██████▏   | 193/313 [03:17<02:07,  1.06s/it]Computing feature acts:  62%|██████▏   | 194/313 [03:18<02:03,  1.04s/it]Computing feature acts:  62%|██████▏   | 195/313 [03:19<01:57,  1.00it/s]Computing feature acts:  63%|██████▎   | 196/313 [03:20<01:54,  1.02it/s]Computing feature acts:  63%|██████▎   | 197/313 [03:21<01:51,  1.04it/s]Computing feature acts:  63%|██████▎   | 198/313 [03:22<01:53,  1.01it/s]Computing feature acts:  64%|██████▎   | 199/313 [03:23<01:50,  1.04it/s]Computing feature acts:  64%|██████▍   | 200/313 [03:24<01:47,  1.05it/s]Computing feature acts:  64%|██████▍   | 201/313 [03:25<01:45,  1.06it/s]Computing feature acts:  65%|██████▍   | 202/313 [03:26<01:47,  1.03it/s]Computing feature acts:  65%|██████▍   | 203/313 [03:27<01:45,  1.04it/s]Computing feature acts:  65%|██████▌   | 204/313 [03:28<01:43,  1.06it/s]Computing feature acts:  65%|██████▌   | 205/313 [03:29<01:44,  1.04it/s]Computing feature acts:  66%|██████▌   | 206/313 [03:30<01:47,  1.01s/it]Computing feature acts:  66%|██████▌   | 207/313 [03:31<01:49,  1.03s/it]Computing feature acts:  66%|██████▋   | 208/313 [03:32<01:48,  1.04s/it]Computing feature acts:  67%|██████▋   | 209/313 [03:33<01:49,  1.05s/it]Computing feature acts:  67%|██████▋   | 210/313 [03:34<01:50,  1.07s/it]Computing feature acts:  67%|██████▋   | 211/313 [03:35<01:49,  1.08s/it]Computing feature acts:  68%|██████▊   | 212/313 [03:36<01:49,  1.08s/it]Computing feature acts:  68%|██████▊   | 213/313 [03:37<01:48,  1.08s/it]Computing feature acts:  68%|██████▊   | 214/313 [03:39<01:48,  1.09s/it]Computing feature acts:  69%|██████▊   | 215/313 [03:40<01:46,  1.08s/it]Computing feature acts:  69%|██████▉   | 216/313 [03:41<01:45,  1.09s/it]Computing feature acts:  69%|██████▉   | 217/313 [03:42<01:44,  1.09s/it]Computing feature acts:  70%|██████▉   | 218/313 [03:43<01:44,  1.10s/it]Computing feature acts:  70%|██████▉   | 219/313 [03:44<01:42,  1.09s/it]Computing feature acts:  70%|███████   | 220/313 [03:45<01:41,  1.09s/it]Computing feature acts:  71%|███████   | 221/313 [03:46<01:41,  1.10s/it]Computing feature acts:  71%|███████   | 222/313 [03:47<01:40,  1.10s/it]Computing feature acts:  71%|███████   | 223/313 [03:48<01:39,  1.11s/it]Computing feature acts:  72%|███████▏  | 224/313 [03:50<01:38,  1.11s/it]Computing feature acts:  72%|███████▏  | 225/313 [03:51<01:37,  1.10s/it]Computing feature acts:  72%|███████▏  | 226/313 [03:52<01:36,  1.11s/it]Computing feature acts:  73%|███████▎  | 227/313 [03:53<01:39,  1.15s/it]Computing feature acts:  73%|███████▎  | 228/313 [03:54<01:36,  1.14s/it]Computing feature acts:  73%|███████▎  | 229/313 [03:55<01:34,  1.13s/it]Computing feature acts:  73%|███████▎  | 230/313 [03:56<01:33,  1.12s/it]Computing feature acts:  74%|███████▍  | 231/313 [03:57<01:31,  1.12s/it]Computing feature acts:  74%|███████▍  | 232/313 [03:59<01:30,  1.12s/it]Computing feature acts:  74%|███████▍  | 233/313 [04:00<01:29,  1.12s/it]Computing feature acts:  75%|███████▍  | 234/313 [04:01<01:29,  1.13s/it]Computing feature acts:  75%|███████▌  | 235/313 [04:02<01:27,  1.12s/it]Computing feature acts:  75%|███████▌  | 236/313 [04:03<01:26,  1.12s/it]Computing feature acts:  76%|███████▌  | 237/313 [04:04<01:23,  1.10s/it]Computing feature acts:  76%|███████▌  | 238/313 [04:05<01:22,  1.10s/it]Computing feature acts:  76%|███████▋  | 239/313 [04:06<01:21,  1.09s/it]Computing feature acts:  77%|███████▋  | 240/313 [04:07<01:19,  1.09s/it]Computing feature acts:  77%|███████▋  | 241/313 [04:09<01:18,  1.09s/it]Computing feature acts:  77%|███████▋  | 242/313 [04:10<01:18,  1.10s/it]Computing feature acts:  78%|███████▊  | 243/313 [04:11<01:16,  1.10s/it]Computing feature acts:  78%|███████▊  | 244/313 [04:12<01:15,  1.09s/it]Computing feature acts:  78%|███████▊  | 245/313 [04:13<01:13,  1.08s/it]Computing feature acts:  79%|███████▊  | 246/313 [04:14<01:13,  1.10s/it]Computing feature acts:  79%|███████▉  | 247/313 [04:15<01:12,  1.09s/it]Computing feature acts:  79%|███████▉  | 248/313 [04:16<01:10,  1.09s/it]Computing feature acts:  80%|███████▉  | 249/313 [04:17<01:09,  1.09s/it]Computing feature acts:  80%|███████▉  | 250/313 [04:18<01:09,  1.10s/it]Computing feature acts:  80%|████████  | 251/313 [04:19<01:08,  1.10s/it]Computing feature acts:  81%|████████  | 252/313 [04:21<01:06,  1.08s/it]Computing feature acts:  81%|████████  | 253/313 [04:22<01:05,  1.09s/it]Computing feature acts:  81%|████████  | 254/313 [04:23<01:05,  1.11s/it]Computing feature acts:  81%|████████▏ | 255/313 [04:24<01:04,  1.10s/it]Computing feature acts:  82%|████████▏ | 256/313 [04:25<01:02,  1.10s/it]Computing feature acts:  82%|████████▏ | 257/313 [04:26<01:01,  1.10s/it]Computing feature acts:  82%|████████▏ | 258/313 [04:27<01:00,  1.11s/it]Computing feature acts:  83%|████████▎ | 259/313 [04:28<00:59,  1.11s/it]Computing feature acts:  83%|████████▎ | 260/313 [04:29<00:58,  1.11s/it]Computing feature acts:  83%|████████▎ | 261/313 [04:31<00:57,  1.11s/it]Computing feature acts:  84%|████████▎ | 262/313 [04:32<00:56,  1.11s/it]Computing feature acts:  84%|████████▍ | 263/313 [04:33<00:53,  1.08s/it]Computing feature acts:  84%|████████▍ | 264/313 [04:34<00:52,  1.07s/it]Computing feature acts:  85%|████████▍ | 265/313 [04:35<00:50,  1.06s/it]Computing feature acts:  85%|████████▍ | 266/313 [04:36<00:50,  1.07s/it]Computing feature acts:  85%|████████▌ | 267/313 [04:37<00:48,  1.05s/it]Computing feature acts:  86%|████████▌ | 268/313 [04:38<00:47,  1.04s/it]Computing feature acts:  86%|████████▌ | 269/313 [04:39<00:45,  1.04s/it]Computing feature acts:  86%|████████▋ | 270/313 [04:40<00:45,  1.05s/it]Computing feature acts:  87%|████████▋ | 271/313 [04:41<00:44,  1.05s/it]Computing feature acts:  87%|████████▋ | 272/313 [04:42<00:42,  1.04s/it]Computing feature acts:  87%|████████▋ | 273/313 [04:43<00:41,  1.04s/it]Computing feature acts:  88%|████████▊ | 274/313 [04:44<00:41,  1.07s/it]Computing feature acts:  88%|████████▊ | 275/313 [04:45<00:40,  1.07s/it]Computing feature acts:  88%|████████▊ | 276/313 [04:46<00:38,  1.05s/it]Computing feature acts:  88%|████████▊ | 277/313 [04:47<00:37,  1.05s/it]Computing feature acts:  89%|████████▉ | 278/313 [04:48<00:37,  1.06s/it]Computing feature acts:  89%|████████▉ | 279/313 [04:49<00:35,  1.05s/it]Computing feature acts:  89%|████████▉ | 280/313 [04:50<00:34,  1.05s/it]Computing feature acts:  90%|████████▉ | 281/313 [04:52<00:33,  1.05s/it]Computing feature acts:  90%|█████████ | 282/313 [04:53<00:32,  1.05s/it]Computing feature acts:  90%|█████████ | 283/313 [04:54<00:30,  1.02s/it]Computing feature acts:  91%|█████████ | 284/313 [04:55<00:29,  1.01s/it]Computing feature acts:  91%|█████████ | 285/313 [04:56<00:28,  1.01s/it]Computing feature acts:  91%|█████████▏| 286/313 [04:57<00:27,  1.03s/it]Computing feature acts:  92%|█████████▏| 287/313 [04:58<00:26,  1.03s/it]Computing feature acts:  92%|█████████▏| 288/313 [04:59<00:26,  1.04s/it]Computing feature acts:  92%|█████████▏| 289/313 [05:00<00:24,  1.04s/it]Computing feature acts:  93%|█████████▎| 290/313 [05:01<00:24,  1.05s/it]Computing feature acts:  93%|█████████▎| 291/313 [05:02<00:22,  1.04s/it]Computing feature acts:  93%|█████████▎| 292/313 [05:03<00:21,  1.04s/it]Computing feature acts:  94%|█████████▎| 293/313 [05:04<00:21,  1.09s/it]Computing feature acts:  94%|█████████▍| 294/313 [05:05<00:21,  1.12s/it]Computing feature acts:  94%|█████████▍| 295/313 [05:06<00:19,  1.09s/it]Computing feature acts:  95%|█████████▍| 296/313 [05:07<00:18,  1.07s/it]Computing feature acts:  95%|█████████▍| 297/313 [05:08<00:16,  1.06s/it]Computing feature acts:  95%|█████████▌| 298/313 [05:09<00:15,  1.06s/it]Computing feature acts:  96%|█████████▌| 299/313 [05:10<00:14,  1.05s/it]Computing feature acts:  96%|█████████▌| 300/313 [05:11<00:13,  1.05s/it]Computing feature acts:  96%|█████████▌| 301/313 [05:13<00:12,  1.04s/it]Computing feature acts:  96%|█████████▋| 302/313 [05:14<00:11,  1.08s/it]Computing feature acts:  97%|█████████▋| 303/313 [05:15<00:10,  1.06s/it]Computing feature acts:  97%|█████████▋| 304/313 [05:16<00:09,  1.06s/it]Computing feature acts:  97%|█████████▋| 305/313 [05:17<00:08,  1.06s/it]Computing feature acts:  98%|█████████▊| 306/313 [05:18<00:07,  1.06s/it]Computing feature acts:  98%|█████████▊| 307/313 [05:19<00:06,  1.06s/it]Computing feature acts:  98%|█████████▊| 308/313 [05:20<00:05,  1.06s/it]Computing feature acts:  99%|█████████▊| 309/313 [05:21<00:04,  1.06s/it]Computing feature acts:  99%|█████████▉| 310/313 [05:22<00:03,  1.06s/it]Computing feature acts:  99%|█████████▉| 311/313 [05:23<00:02,  1.05s/it]Computing feature acts: 100%|█████████▉| 312/313 [05:24<00:01,  1.05s/it]Computing feature acts: 100%|██████████| 313/313 [05:25<00:00,  1.05s/it]Computing feature acts: 100%|██████████| 313/313 [05:26<00:00,  1.04s/it]
Parsing activation data:   0%|          | 0/1 [00:00<?, ?it/s]Parsing activation data: 100%|██████████| 1/1 [00:03<00:00,  3.08s/it]Parsing activation data: 100%|██████████| 1/1 [00:03<00:00,  3.09s/it]
2024-04-16 02:02:56 - INFO - Saving HTML feature dashboards for the SAE at blocks.2.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/1 [00:00<?, ?it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  3.45it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  3.44it/s]
2024-04-16 02:02:57 - INFO - Finished.
2024-04-16 02:02:57 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-2_region-2_local-ue3lz0n7_Orange_cluster_on_middle_left') save_json_data=False sae_positions=None feature_indices=[22363, 22433, 22442, 22460, 22500, 22695, 22788, 22888, 22966, 23178, 23196, 23271, 23330, 23481, 23556, 23560, 23720, 23979, 24003, 24096, 24276, 24282, 24569, 24582, 24694, 24754, 24785, 24849, 24912, 25106, 25150, 25204, 25209, 25225, 25276, 25369, 25398, 25724, 25764, 25813, 25827, 25842, 26122, 26155, 26214, 26228, 26307, 26334, 26406, 26415, 26505, 26507, 26525, 26549, 26607, 26834, 26848, 26853, 26932, 26957, 27047, 27070, 27125, 27441, 27476, 27502, 27572, 27600, 27765, 27819, 27913, 28009, 28308, 28332, 28420, 28541, 28749, 28934, 28995, 29038, 29110, 29149, 29156, 29168, 29229, 29257, 29377, 29408, 29724, 29762, 29845, 29904, 29930, 29997, 30083, 30120, 30149, 30239, 30334, 30547, 30574, 30793, 30878, 30892, 30901, 30953, 31140, 31155, 31359, 31411, 31448, 31511, 31632, 31657, 31779, 31966, 32262, 32446, 32487, 32505, 32699, 32717, 32725, 32787, 32793, 32865, 32902, 32913, 33055, 33068, 33125, 33243, 33290, 33387, 33497, 33549, 33814, 33865, 34102, 34161, 34401, 34509, 34560, 35028, 35212, 35327, 35410, 35438, 35502, 35532, 35575, 35706, 35816, 36104, 36111, 36359, 36470, 36490, 36528, 36543, 36554, 36615, 36635, 36649, 36841, 36916, 36966, 37019, 37203, 37293, 37521, 37626, 37637, 37700, 37889, 37982, 38053, 38080, 38081, 38261, 38378, 38511, 38526, 38652, 38771, 38952, 38980, 39146, 39269, 39455, 39542, 39618, 39805, 39869, 39965, 40113, 40255, 40566, 40585, 40595, 40603, 40635, 40705, 40764, 40808, 40812, 40861, 40874, 40930, 41063, 41219, 41435, 41448, 41529, 41543, 41564, 42347, 42396, 42768, 42825, 42874, 42928, 42941, 43043, 43120, 43285, 43312, 43367, 43381, 43433, 43435, 43693, 43703, 43751, 43856, 44247, 44315, 44550, 44571, 44944, 44958, 45249, 45265, 45309, 45311, 45723, 45734, 45765, 45985, 46009, 46131, 46156, 46204, 46261, 46458, 46463, 46580, 46640, 46705, 46823, 46861, 46953, 47139, 47160, 47211, 47377, 47445, 47474, 47677, 47703, 47706, 47854, 47890, 47936, 47963, 48223, 48408, 48592, 48603, 48662, 48869, 48945, 48989, 49052, 49489, 49544, 49615, 49621, 49673, 49948, 50000, 50040, 50182, 50245, 50396, 50771, 50789, 50850, 51173, 51313, 51396, 51505, 51794, 51883, 51908, 51983, 52036, 52225, 52416, 52458, 52571, 52690, 52712, 52779, 52780, 52898, 52985, 53135, 53139, 53342, 53392, 53619, 53633, 53709, 53766, 53970, 54026, 54158, 54165, 54177, 54219, 54237, 54359, 54589, 54590, 54673, 54949, 55074, 55093, 55248, 55266, 55297, 55358, 55411, 55476, 55480, 55716, 55764, 55822, 55996, 56114, 56147, 56156, 56202, 56255, 56286, 56437, 56444, 56458, 56567, 56697, 56814, 56828, 56850, 56969, 56970, 57085, 57162, 57237, 57512, 57543, 57706, 57910, 57969, 58176, 58224, 58247, 58520, 58546, 58573, 58822, 58885, 58912, 58984, 59040, 59141, 59153, 59307, 59344, 59418, 59421, 59526, 59582, 59591, 59630, 59659, 59786, 59884, 60075, 60120, 60330, 60418, 60445, 60464, 60544, 60664, 60698, 60999, 61130, 61225, 61606, 61662, 61701, 61712, 61790, 61908, 61954, 61961, 62020, 62026, 62062, 62108, 62126, 62419, 62515, 62524, 62726, 62854, 62862, 63263, 63286, 63304, 63345, 63369, 63543, 63616, 63688, 63718] prompt_centric=None seed=0
2024-04-16 02:02:57 - INFO - Loading the model and SAEs
2024-04-16 02:02:57 - INFO - wandb_project='gpt2-layerwise_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/mnt/ssd-interp/dan/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=40000 eval_n_samples=500 batch_size=8 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=0.8, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=1.0), logits_kl=None) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.2.hook_resid_pre'])
2024-04-16 02:03:08 - INFO - done
2024-04-16 02:03:08 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-2_region-2_local-ue3lz0n7_Orange_cluster_on_middle_left
run_sae_path = /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Traceback (most recent call last):
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 51, in <module>
    fire.Fire(main)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 48, in main
    generate_dashboards(dashbaords_config, run_sae_path)
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 1005, in main
    generate_dashboards(model, dashboards_config, save_dir=save_dir)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 852, in generate_dashboards
    dashboards_data: dict[str, SaeVisData] = get_dashboards_data(
                                             ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 385, in get_dashboards_data
    assert (
AssertionError: Error: Some feature indices are greater than the number of SAE features
2024-04-16 02:03:15 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-2_region-3_e2e-ovhfts9n_Random_cluster') save_json_data=False sae_positions=None feature_indices=[1917, 2121, 3230, 7253, 8458, 8659, 8723, 8933, 9453, 10051, 10915, 11280, 11484, 11645, 11889, 12653, 14097, 15061, 15278, 15422, 15540, 16372, 16760, 18345, 18751, 19115, 20813] prompt_centric=None seed=0
2024-04-16 02:03:15 - INFO - Loading the model and SAEs
2024-04-16 02:03:15 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=0.5, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.2.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-16 02:03:27 - INFO - done
2024-04-16 02:03:27 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-2_region-3_e2e-ovhfts9n_Random_cluster
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/313 [00:00<?, ?it/s]Computing feature acts:   0%|          | 1/313 [00:01<07:57,  1.53s/it]Computing feature acts:   1%|          | 2/313 [00:02<06:32,  1.26s/it]Computing feature acts:   1%|          | 3/313 [00:03<06:11,  1.20s/it]Computing feature acts:   1%|▏         | 4/313 [00:04<06:00,  1.17s/it]Computing feature acts:   2%|▏         | 5/313 [00:05<05:54,  1.15s/it]Computing feature acts:   2%|▏         | 6/313 [00:07<05:49,  1.14s/it]Computing feature acts:   2%|▏         | 7/313 [00:08<05:46,  1.13s/it]Computing feature acts:   3%|▎         | 8/313 [00:09<05:45,  1.13s/it]Computing feature acts:   3%|▎         | 9/313 [00:10<05:43,  1.13s/it]Computing feature acts:   3%|▎         | 10/313 [00:11<05:42,  1.13s/it]Computing feature acts:   4%|▎         | 11/313 [00:12<05:41,  1.13s/it]Computing feature acts:   4%|▍         | 12/313 [00:13<05:39,  1.13s/it]Computing feature acts:   4%|▍         | 13/313 [00:14<05:38,  1.13s/it]Computing feature acts:   4%|▍         | 14/313 [00:16<05:37,  1.13s/it]Computing feature acts:   5%|▍         | 15/313 [00:17<05:34,  1.12s/it]Computing feature acts:   5%|▌         | 16/313 [00:18<05:32,  1.12s/it]Computing feature acts:   5%|▌         | 17/313 [00:19<05:30,  1.12s/it]Computing feature acts:   6%|▌         | 18/313 [00:20<05:29,  1.12s/it]Computing feature acts:   6%|▌         | 19/313 [00:21<05:28,  1.12s/it]Computing feature acts:   6%|▋         | 20/313 [00:22<05:27,  1.12s/it]Computing feature acts:   7%|▋         | 21/313 [00:23<05:26,  1.12s/it]Computing feature acts:   7%|▋         | 22/313 [00:25<05:25,  1.12s/it]Computing feature acts:   7%|▋         | 23/313 [00:26<05:21,  1.11s/it]Computing feature acts:   8%|▊         | 24/313 [00:27<05:16,  1.10s/it]Computing feature acts:   8%|▊         | 25/313 [00:28<04:59,  1.04s/it]Computing feature acts:   8%|▊         | 26/313 [00:29<04:53,  1.02s/it]Computing feature acts:   9%|▊         | 27/313 [00:30<04:50,  1.02s/it]Computing feature acts:   9%|▉         | 28/313 [00:31<04:53,  1.03s/it]Computing feature acts:   9%|▉         | 29/313 [00:32<04:52,  1.03s/it]Computing feature acts:  10%|▉         | 30/313 [00:33<04:36,  1.02it/s]Computing feature acts:  10%|▉         | 31/313 [00:34<04:47,  1.02s/it]Computing feature acts:  10%|█         | 32/313 [00:35<04:50,  1.03s/it]Computing feature acts:  11%|█         | 33/313 [00:36<04:49,  1.03s/it]Computing feature acts:  11%|█         | 34/313 [00:37<04:45,  1.02s/it]Computing feature acts:  11%|█         | 35/313 [00:38<04:39,  1.01s/it]Computing feature acts:  12%|█▏        | 36/313 [00:39<04:55,  1.07s/it]Computing feature acts:  12%|█▏        | 37/313 [00:40<04:41,  1.02s/it]Computing feature acts:  12%|█▏        | 38/313 [00:41<04:42,  1.03s/it]Computing feature acts:  12%|█▏        | 39/313 [00:42<04:32,  1.01it/s]Computing feature acts:  13%|█▎        | 40/313 [00:43<04:42,  1.03s/it]Computing feature acts:  13%|█▎        | 41/313 [00:44<04:30,  1.01it/s]Computing feature acts:  13%|█▎        | 42/313 [00:45<04:27,  1.01it/s]Computing feature acts:  14%|█▎        | 43/313 [00:46<04:28,  1.00it/s]Computing feature acts:  14%|█▍        | 44/313 [00:47<04:42,  1.05s/it]Computing feature acts:  14%|█▍        | 45/313 [00:48<04:32,  1.02s/it]Computing feature acts:  15%|█▍        | 46/313 [00:49<04:30,  1.01s/it]Computing feature acts:  15%|█▌        | 47/313 [00:50<04:22,  1.01it/s]Computing feature acts:  15%|█▌        | 48/313 [00:51<04:23,  1.01it/s]Computing feature acts:  16%|█▌        | 49/313 [00:52<04:24,  1.00s/it]Computing feature acts:  16%|█▌        | 50/313 [00:53<04:23,  1.00s/it]Computing feature acts:  16%|█▋        | 51/313 [00:54<04:24,  1.01s/it]Computing feature acts:  17%|█▋        | 52/313 [00:55<04:29,  1.03s/it]Computing feature acts:  17%|█▋        | 53/313 [00:56<04:15,  1.02it/s]Computing feature acts:  17%|█▋        | 54/313 [00:57<04:04,  1.06it/s]Computing feature acts:  18%|█▊        | 55/313 [00:58<03:58,  1.08it/s]Computing feature acts:  18%|█▊        | 56/313 [00:59<04:00,  1.07it/s]Computing feature acts:  18%|█▊        | 57/313 [00:59<03:54,  1.09it/s]Computing feature acts:  19%|█▊        | 58/313 [01:00<03:52,  1.10it/s]Computing feature acts:  19%|█▉        | 59/313 [01:01<03:51,  1.10it/s]Computing feature acts:  19%|█▉        | 60/313 [01:02<03:52,  1.09it/s]Computing feature acts:  19%|█▉        | 61/313 [01:03<03:50,  1.09it/s]Computing feature acts:  20%|█▉        | 62/313 [01:04<03:51,  1.08it/s]Computing feature acts:  20%|██        | 63/313 [01:05<03:52,  1.08it/s]Computing feature acts:  20%|██        | 64/313 [01:06<03:55,  1.06it/s]Computing feature acts:  21%|██        | 65/313 [01:07<03:55,  1.05it/s]Computing feature acts:  21%|██        | 66/313 [01:08<03:54,  1.05it/s]Computing feature acts:  21%|██▏       | 67/313 [01:09<03:53,  1.05it/s]Computing feature acts:  22%|██▏       | 68/313 [01:10<03:59,  1.02it/s]Computing feature acts:  22%|██▏       | 69/313 [01:11<03:49,  1.06it/s]Computing feature acts:  22%|██▏       | 70/313 [01:12<03:43,  1.09it/s]Computing feature acts:  23%|██▎       | 71/313 [01:12<03:41,  1.09it/s]Computing feature acts:  23%|██▎       | 72/313 [01:13<03:47,  1.06it/s]Computing feature acts:  23%|██▎       | 73/313 [01:14<03:43,  1.08it/s]Computing feature acts:  24%|██▎       | 74/313 [01:15<03:36,  1.10it/s]Computing feature acts:  24%|██▍       | 75/313 [01:16<03:32,  1.12it/s]Computing feature acts:  24%|██▍       | 76/313 [01:17<03:32,  1.12it/s]Computing feature acts:  25%|██▍       | 77/313 [01:18<03:36,  1.09it/s]Computing feature acts:  25%|██▍       | 78/313 [01:19<03:41,  1.06it/s]Computing feature acts:  25%|██▌       | 79/313 [01:20<03:46,  1.03it/s]Computing feature acts:  26%|██▌       | 80/313 [01:21<04:01,  1.03s/it]Computing feature acts:  26%|██▌       | 81/313 [01:22<03:51,  1.00it/s]Computing feature acts:  26%|██▌       | 82/313 [01:23<03:47,  1.02it/s]Computing feature acts:  27%|██▋       | 83/313 [01:24<03:43,  1.03it/s]Computing feature acts:  27%|██▋       | 84/313 [01:25<03:50,  1.01s/it]Computing feature acts:  27%|██▋       | 85/313 [01:26<03:46,  1.01it/s]Computing feature acts:  27%|██▋       | 86/313 [01:27<03:41,  1.02it/s]Computing feature acts:  28%|██▊       | 87/313 [01:28<03:38,  1.03it/s]Computing feature acts:  28%|██▊       | 88/313 [01:29<03:43,  1.01it/s]Computing feature acts:  28%|██▊       | 89/313 [01:30<03:41,  1.01it/s]Computing feature acts:  29%|██▉       | 90/313 [01:31<03:38,  1.02it/s]Computing feature acts:  29%|██▉       | 91/313 [01:32<03:28,  1.06it/s]Computing feature acts:  29%|██▉       | 92/313 [01:33<03:32,  1.04it/s]Computing feature acts:  30%|██▉       | 93/313 [01:34<03:35,  1.02it/s]Computing feature acts:  30%|███       | 94/313 [01:35<03:37,  1.01it/s]Computing feature acts:  30%|███       | 95/313 [01:36<03:39,  1.01s/it]Computing feature acts:  31%|███       | 96/313 [01:37<03:49,  1.06s/it]Computing feature acts:  31%|███       | 97/313 [01:38<03:46,  1.05s/it]Computing feature acts:  31%|███▏      | 98/313 [01:39<03:44,  1.04s/it]Computing feature acts:  32%|███▏      | 99/313 [01:40<03:43,  1.04s/it]Computing feature acts:  32%|███▏      | 100/313 [01:41<03:49,  1.08s/it]Computing feature acts:  32%|███▏      | 101/313 [01:42<03:42,  1.05s/it]Computing feature acts:  33%|███▎      | 102/313 [01:43<03:40,  1.05s/it]Computing feature acts:  33%|███▎      | 103/313 [01:44<03:39,  1.04s/it]Computing feature acts:  33%|███▎      | 104/313 [01:45<03:43,  1.07s/it]Computing feature acts:  34%|███▎      | 105/313 [01:47<03:40,  1.06s/it]Computing feature acts:  34%|███▍      | 106/313 [01:48<03:37,  1.05s/it]Computing feature acts:  34%|███▍      | 107/313 [01:49<03:34,  1.04s/it]Computing feature acts:  35%|███▍      | 108/313 [01:50<03:40,  1.07s/it]Computing feature acts:  35%|███▍      | 109/313 [01:51<03:35,  1.06s/it]Computing feature acts:  35%|███▌      | 110/313 [01:52<03:32,  1.05s/it]Computing feature acts:  35%|███▌      | 111/313 [01:53<03:29,  1.04s/it]Computing feature acts:  36%|███▌      | 112/313 [01:54<03:32,  1.06s/it]Computing feature acts:  36%|███▌      | 113/313 [01:55<03:30,  1.05s/it]Computing feature acts:  36%|███▋      | 114/313 [01:56<03:28,  1.05s/it]Computing feature acts:  37%|███▋      | 115/313 [01:57<03:26,  1.04s/it]Computing feature acts:  37%|███▋      | 116/313 [01:58<03:27,  1.05s/it]Computing feature acts:  37%|███▋      | 117/313 [01:59<03:25,  1.05s/it]Computing feature acts:  38%|███▊      | 118/313 [02:00<03:23,  1.04s/it]Computing feature acts:  38%|███▊      | 119/313 [02:01<03:21,  1.04s/it]Computing feature acts:  38%|███▊      | 120/313 [02:02<03:22,  1.05s/it]Computing feature acts:  39%|███▊      | 121/313 [02:03<03:19,  1.04s/it]Computing feature acts:  39%|███▉      | 122/313 [02:04<03:18,  1.04s/it]Computing feature acts:  39%|███▉      | 123/313 [02:05<03:16,  1.04s/it]Computing feature acts:  40%|███▉      | 124/313 [02:07<03:24,  1.08s/it]Computing feature acts:  40%|███▉      | 125/313 [02:08<03:21,  1.07s/it]Computing feature acts:  40%|████      | 126/313 [02:09<03:18,  1.06s/it]Computing feature acts:  41%|████      | 127/313 [02:10<03:16,  1.06s/it]Computing feature acts:  41%|████      | 128/313 [02:11<03:18,  1.07s/it]Computing feature acts:  41%|████      | 129/313 [02:12<03:16,  1.07s/it]Computing feature acts:  42%|████▏     | 130/313 [02:13<03:14,  1.06s/it]Computing feature acts:  42%|████▏     | 131/313 [02:14<03:11,  1.05s/it]Computing feature acts:  42%|████▏     | 132/313 [02:15<03:15,  1.08s/it]Computing feature acts:  42%|████▏     | 133/313 [02:16<03:12,  1.07s/it]Computing feature acts:  43%|████▎     | 134/313 [02:17<03:09,  1.06s/it]Computing feature acts:  43%|████▎     | 135/313 [02:18<03:08,  1.06s/it]Computing feature acts:  43%|████▎     | 136/313 [02:19<03:08,  1.06s/it]Computing feature acts:  44%|████▍     | 137/313 [02:20<03:05,  1.05s/it]Computing feature acts:  44%|████▍     | 138/313 [02:21<03:04,  1.05s/it]Computing feature acts:  44%|████▍     | 139/313 [02:22<03:02,  1.05s/it]Computing feature acts:  45%|████▍     | 140/313 [02:23<03:05,  1.07s/it]Computing feature acts:  45%|████▌     | 141/313 [02:25<03:02,  1.06s/it]Computing feature acts:  45%|████▌     | 142/313 [02:26<03:00,  1.06s/it]Computing feature acts:  46%|████▌     | 143/313 [02:27<02:58,  1.05s/it]Computing feature acts:  46%|████▌     | 144/313 [02:28<03:00,  1.07s/it]Computing feature acts:  46%|████▋     | 145/313 [02:29<02:58,  1.06s/it]Computing feature acts:  47%|████▋     | 146/313 [02:30<02:54,  1.05s/it]Computing feature acts:  47%|████▋     | 147/313 [02:31<02:53,  1.04s/it]Computing feature acts:  47%|████▋     | 148/313 [02:32<02:57,  1.08s/it]Computing feature acts:  48%|████▊     | 149/313 [02:33<02:55,  1.07s/it]Computing feature acts:  48%|████▊     | 150/313 [02:34<02:54,  1.07s/it]Computing feature acts:  48%|████▊     | 151/313 [02:35<02:50,  1.05s/it]Computing feature acts:  49%|████▊     | 152/313 [02:36<02:59,  1.11s/it]Computing feature acts:  49%|████▉     | 153/313 [02:37<02:57,  1.11s/it]Computing feature acts:  49%|████▉     | 154/313 [02:39<02:56,  1.11s/it]Computing feature acts:  50%|████▉     | 155/313 [02:40<02:53,  1.10s/it]Computing feature acts:  50%|████▉     | 156/313 [02:41<02:54,  1.11s/it]Computing feature acts:  50%|█████     | 157/313 [02:42<02:50,  1.09s/it]Computing feature acts:  50%|█████     | 158/313 [02:43<02:48,  1.09s/it]Computing feature acts:  51%|█████     | 159/313 [02:44<02:46,  1.08s/it]Computing feature acts:  51%|█████     | 160/313 [02:45<02:46,  1.09s/it]Computing feature acts:  51%|█████▏    | 161/313 [02:46<02:52,  1.14s/it]Computing feature acts:  52%|█████▏    | 162/313 [02:47<02:50,  1.13s/it]Computing feature acts:  52%|█████▏    | 163/313 [02:49<02:49,  1.13s/it]Computing feature acts:  52%|█████▏    | 164/313 [02:50<02:53,  1.16s/it]Computing feature acts:  53%|█████▎    | 165/313 [02:51<02:44,  1.11s/it]Computing feature acts:  53%|█████▎    | 166/313 [02:52<02:32,  1.04s/it]Computing feature acts:  53%|█████▎    | 167/313 [02:53<02:26,  1.00s/it]Computing feature acts:  54%|█████▎    | 168/313 [02:54<02:27,  1.02s/it]Computing feature acts:  54%|█████▍    | 169/313 [02:55<02:24,  1.00s/it]Computing feature acts:  54%|█████▍    | 170/313 [02:56<02:21,  1.01it/s]Computing feature acts:  55%|█████▍    | 171/313 [02:57<02:19,  1.02it/s]Computing feature acts:  55%|█████▍    | 172/313 [02:58<02:20,  1.01it/s]Computing feature acts:  55%|█████▌    | 173/313 [02:59<02:18,  1.01it/s]Computing feature acts:  56%|█████▌    | 174/313 [02:59<02:16,  1.02it/s]Computing feature acts:  56%|█████▌    | 175/313 [03:00<02:14,  1.02it/s]Computing feature acts:  56%|█████▌    | 176/313 [03:01<02:14,  1.02it/s]Computing feature acts:  57%|█████▋    | 177/313 [03:02<02:12,  1.03it/s]Computing feature acts:  57%|█████▋    | 178/313 [03:03<02:11,  1.03it/s]Computing feature acts:  57%|█████▋    | 179/313 [03:04<02:10,  1.03it/s]Computing feature acts:  58%|█████▊    | 180/313 [03:05<02:11,  1.01it/s]Computing feature acts:  58%|█████▊    | 181/313 [03:06<02:05,  1.05it/s]Computing feature acts:  58%|█████▊    | 182/313 [03:07<02:04,  1.05it/s]Computing feature acts:  58%|█████▊    | 183/313 [03:08<02:03,  1.05it/s]Computing feature acts:  59%|█████▉    | 184/313 [03:09<02:03,  1.04it/s]Computing feature acts:  59%|█████▉    | 185/313 [03:10<02:00,  1.06it/s]Computing feature acts:  59%|█████▉    | 186/313 [03:11<01:58,  1.08it/s]Computing feature acts:  60%|█████▉    | 187/313 [03:12<02:01,  1.03it/s]Computing feature acts:  60%|██████    | 188/313 [03:13<02:00,  1.04it/s]Computing feature acts:  60%|██████    | 189/313 [03:14<01:56,  1.06it/s]Computing feature acts:  61%|██████    | 190/313 [03:15<01:54,  1.07it/s]Computing feature acts:  61%|██████    | 191/313 [03:16<01:52,  1.08it/s]Computing feature acts:  61%|██████▏   | 192/313 [03:17<01:52,  1.07it/s]Computing feature acts:  62%|██████▏   | 193/313 [03:17<01:49,  1.10it/s]Computing feature acts:  62%|██████▏   | 194/313 [03:18<01:48,  1.10it/s]Computing feature acts:  62%|██████▏   | 195/313 [03:19<01:46,  1.10it/s]Computing feature acts:  63%|██████▎   | 196/313 [03:20<01:48,  1.08it/s]Computing feature acts:  63%|██████▎   | 197/313 [03:21<01:48,  1.07it/s]Computing feature acts:  63%|██████▎   | 198/313 [03:22<01:48,  1.06it/s]Computing feature acts:  64%|██████▎   | 199/313 [03:23<01:48,  1.06it/s]Computing feature acts:  64%|██████▍   | 200/313 [03:24<01:49,  1.03it/s]Computing feature acts:  64%|██████▍   | 201/313 [03:25<01:47,  1.04it/s]Computing feature acts:  65%|██████▍   | 202/313 [03:26<01:43,  1.07it/s]Computing feature acts:  65%|██████▍   | 203/313 [03:27<01:41,  1.09it/s]Computing feature acts:  65%|██████▌   | 204/313 [03:28<01:41,  1.08it/s]Computing feature acts:  65%|██████▌   | 205/313 [03:29<01:38,  1.09it/s]Computing feature acts:  66%|██████▌   | 206/313 [03:30<01:37,  1.10it/s]Computing feature acts:  66%|██████▌   | 207/313 [03:30<01:34,  1.12it/s]Computing feature acts:  66%|██████▋   | 208/313 [03:31<01:35,  1.10it/s]Computing feature acts:  67%|██████▋   | 209/313 [03:32<01:33,  1.11it/s]Computing feature acts:  67%|██████▋   | 210/313 [03:33<01:32,  1.11it/s]Computing feature acts:  67%|██████▋   | 211/313 [03:34<01:31,  1.11it/s]Computing feature acts:  68%|██████▊   | 212/313 [03:35<01:32,  1.10it/s]Computing feature acts:  68%|██████▊   | 213/313 [03:36<01:30,  1.10it/s]Computing feature acts:  68%|██████▊   | 214/313 [03:37<01:29,  1.11it/s]Computing feature acts:  69%|██████▊   | 215/313 [03:38<01:28,  1.10it/s]Computing feature acts:  69%|██████▉   | 216/313 [03:39<01:29,  1.09it/s]Computing feature acts:  69%|██████▉   | 217/313 [03:40<01:27,  1.09it/s]Computing feature acts:  70%|██████▉   | 218/313 [03:40<01:26,  1.10it/s]Computing feature acts:  70%|██████▉   | 219/313 [03:41<01:25,  1.10it/s]Computing feature acts:  70%|███████   | 220/313 [03:42<01:26,  1.07it/s]Computing feature acts:  71%|███████   | 221/313 [03:43<01:25,  1.08it/s]Computing feature acts:  71%|███████   | 222/313 [03:44<01:23,  1.09it/s]Computing feature acts:  71%|███████   | 223/313 [03:45<01:22,  1.09it/s]Computing feature acts:  72%|███████▏  | 224/313 [03:46<01:26,  1.03it/s]Computing feature acts:  72%|███████▏  | 225/313 [03:47<01:25,  1.03it/s]Computing feature acts:  72%|███████▏  | 226/313 [03:48<01:23,  1.04it/s]Computing feature acts:  73%|███████▎  | 227/313 [03:49<01:26,  1.01s/it]Computing feature acts:  73%|███████▎  | 228/313 [03:50<01:26,  1.02s/it]Computing feature acts:  73%|███████▎  | 229/313 [03:51<01:22,  1.02it/s]Computing feature acts:  73%|███████▎  | 230/313 [03:52<01:19,  1.05it/s]Computing feature acts:  74%|███████▍  | 231/313 [03:53<01:16,  1.07it/s]Computing feature acts:  74%|███████▍  | 232/313 [03:54<01:19,  1.02it/s]Computing feature acts:  74%|███████▍  | 233/313 [03:55<01:17,  1.03it/s]Computing feature acts:  75%|███████▍  | 234/313 [03:56<01:16,  1.03it/s]Computing feature acts:  75%|███████▌  | 235/313 [03:57<01:15,  1.04it/s]Computing feature acts:  75%|███████▌  | 236/313 [03:58<01:15,  1.03it/s]Computing feature acts:  76%|███████▌  | 237/313 [03:59<01:12,  1.05it/s]Computing feature acts:  76%|███████▌  | 238/313 [04:00<01:10,  1.06it/s]Computing feature acts:  76%|███████▋  | 239/313 [04:00<01:07,  1.09it/s]Computing feature acts:  77%|███████▋  | 240/313 [04:02<01:09,  1.06it/s]Computing feature acts:  77%|███████▋  | 241/313 [04:02<01:08,  1.05it/s]Computing feature acts:  77%|███████▋  | 242/313 [04:03<01:06,  1.07it/s]Computing feature acts:  78%|███████▊  | 243/313 [04:04<01:04,  1.08it/s]Computing feature acts:  78%|███████▊  | 244/313 [04:05<01:04,  1.07it/s]Computing feature acts:  78%|███████▊  | 245/313 [04:06<01:02,  1.08it/s]Computing feature acts:  79%|███████▊  | 246/313 [04:07<01:01,  1.09it/s]Computing feature acts:  79%|███████▉  | 247/313 [04:08<01:00,  1.10it/s]Computing feature acts:  79%|███████▉  | 248/313 [04:09<01:00,  1.08it/s]Computing feature acts:  80%|███████▉  | 249/313 [04:10<00:58,  1.09it/s]Computing feature acts:  80%|███████▉  | 250/313 [04:11<00:57,  1.09it/s]Computing feature acts:  80%|████████  | 251/313 [04:12<00:57,  1.08it/s]Computing feature acts:  81%|████████  | 252/313 [04:13<00:58,  1.04it/s]Computing feature acts:  81%|████████  | 253/313 [04:14<00:57,  1.04it/s]Computing feature acts:  81%|████████  | 254/313 [04:15<00:55,  1.07it/s]Computing feature acts:  81%|████████▏ | 255/313 [04:15<00:53,  1.08it/s]Computing feature acts:  82%|████████▏ | 256/313 [04:17<00:55,  1.02it/s]Computing feature acts:  82%|████████▏ | 257/313 [04:17<00:53,  1.05it/s]Computing feature acts:  82%|████████▏ | 258/313 [04:18<00:51,  1.06it/s]Computing feature acts:  83%|████████▎ | 259/313 [04:19<00:49,  1.09it/s]Computing feature acts:  83%|████████▎ | 260/313 [04:20<00:49,  1.06it/s]Computing feature acts:  83%|████████▎ | 261/313 [04:21<00:48,  1.07it/s]Computing feature acts:  84%|████████▎ | 262/313 [04:22<00:47,  1.08it/s]Computing feature acts:  84%|████████▍ | 263/313 [04:23<00:45,  1.10it/s]Computing feature acts:  84%|████████▍ | 264/313 [04:24<00:47,  1.04it/s]Computing feature acts:  85%|████████▍ | 265/313 [04:25<00:45,  1.06it/s]Computing feature acts:  85%|████████▍ | 266/313 [04:26<00:43,  1.07it/s]Computing feature acts:  85%|████████▌ | 267/313 [04:27<00:42,  1.08it/s]Computing feature acts:  86%|████████▌ | 268/313 [04:28<00:43,  1.04it/s]Computing feature acts:  86%|████████▌ | 269/313 [04:29<00:42,  1.04it/s]Computing feature acts:  86%|████████▋ | 270/313 [04:30<00:41,  1.04it/s]Computing feature acts:  87%|████████▋ | 271/313 [04:31<00:40,  1.04it/s]Computing feature acts:  87%|████████▋ | 272/313 [04:32<00:39,  1.03it/s]Computing feature acts:  87%|████████▋ | 273/313 [04:33<00:37,  1.06it/s]Computing feature acts:  88%|████████▊ | 274/313 [04:33<00:36,  1.07it/s]Computing feature acts:  88%|████████▊ | 275/313 [04:34<00:35,  1.08it/s]Computing feature acts:  88%|████████▊ | 276/313 [04:35<00:34,  1.07it/s]Computing feature acts:  88%|████████▊ | 277/313 [04:36<00:33,  1.07it/s]Computing feature acts:  89%|████████▉ | 278/313 [04:37<00:32,  1.08it/s]Computing feature acts:  89%|████████▉ | 279/313 [04:38<00:31,  1.09it/s]Computing feature acts:  89%|████████▉ | 280/313 [04:39<00:32,  1.02it/s]Computing feature acts:  90%|████████▉ | 281/313 [04:40<00:30,  1.05it/s]Computing feature acts:  90%|█████████ | 282/313 [04:41<00:29,  1.06it/s]Computing feature acts:  90%|█████████ | 283/313 [04:42<00:28,  1.06it/s]Computing feature acts:  91%|█████████ | 284/313 [04:43<00:28,  1.02it/s]Computing feature acts:  91%|█████████ | 285/313 [04:44<00:27,  1.03it/s]Computing feature acts:  91%|█████████▏| 286/313 [04:45<00:26,  1.04it/s]Computing feature acts:  92%|█████████▏| 287/313 [04:46<00:24,  1.08it/s]Computing feature acts:  92%|█████████▏| 288/313 [04:47<00:23,  1.05it/s]Computing feature acts:  92%|█████████▏| 289/313 [04:48<00:22,  1.05it/s]Computing feature acts:  93%|█████████▎| 290/313 [04:49<00:22,  1.02it/s]Computing feature acts:  93%|█████████▎| 291/313 [04:50<00:21,  1.01it/s]Computing feature acts:  93%|█████████▎| 292/313 [04:51<00:22,  1.07s/it]Computing feature acts:  94%|█████████▎| 293/313 [04:52<00:21,  1.08s/it]Computing feature acts:  94%|█████████▍| 294/313 [04:53<00:19,  1.02s/it]Computing feature acts:  94%|█████████▍| 295/313 [04:54<00:17,  1.02it/s]Computing feature acts:  95%|█████████▍| 296/313 [04:55<00:16,  1.01it/s]Computing feature acts:  95%|█████████▍| 297/313 [04:56<00:15,  1.04it/s]Computing feature acts:  95%|█████████▌| 298/313 [04:57<00:14,  1.07it/s]Computing feature acts:  96%|█████████▌| 299/313 [04:58<00:12,  1.09it/s]Computing feature acts:  96%|█████████▌| 300/313 [04:58<00:12,  1.08it/s]Computing feature acts:  96%|█████████▌| 301/313 [04:59<00:11,  1.09it/s]Computing feature acts:  96%|█████████▋| 302/313 [05:00<00:10,  1.09it/s]Computing feature acts:  97%|█████████▋| 303/313 [05:01<00:09,  1.10it/s]Computing feature acts:  97%|█████████▋| 304/313 [05:02<00:08,  1.05it/s]Computing feature acts:  97%|█████████▋| 305/313 [05:03<00:07,  1.06it/s]Computing feature acts:  98%|█████████▊| 306/313 [05:04<00:06,  1.08it/s]Computing feature acts:  98%|█████████▊| 307/313 [05:05<00:05,  1.10it/s]Computing feature acts:  98%|█████████▊| 308/313 [05:06<00:04,  1.07it/s]Computing feature acts:  99%|█████████▊| 309/313 [05:07<00:03,  1.09it/s]Computing feature acts:  99%|█████████▉| 310/313 [05:08<00:02,  1.10it/s]Computing feature acts:  99%|█████████▉| 311/313 [05:09<00:01,  1.11it/s]Computing feature acts: 100%|█████████▉| 312/313 [05:10<00:00,  1.05it/s]Computing feature acts: 100%|██████████| 313/313 [05:11<00:00,  1.07it/s]Computing feature acts: 100%|██████████| 313/313 [05:11<00:00,  1.00it/s]
Parsing activation data:   0%|          | 0/1 [00:00<?, ?it/s]Parsing activation data: 100%|██████████| 1/1 [00:03<00:00,  3.85s/it]Parsing activation data: 100%|██████████| 1/1 [00:03<00:00,  3.85s/it]
2024-04-16 02:08:56 - INFO - Saving HTML feature dashboards for the SAE at blocks.2.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/1 [00:00<?, ?it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  1.97it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  1.97it/s]
2024-04-16 02:08:57 - INFO - Finished.
2024-04-16 02:08:57 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-2_region-3_local-ue3lz0n7_Random_cluster') save_json_data=False sae_positions=None feature_indices=[22676, 24641, 24994, 25338, 25437, 26235, 26311, 26326, 26714, 27178, 27580, 27896, 28589, 28785, 30045, 30195, 31190, 33260, 33739, 34090, 34551, 35838, 36889, 38917, 39722, 41780, 41878, 43590, 44546, 44554, 46860, 47033, 47752, 49308, 49484, 49623, 50147, 50453, 51129, 52321, 52356, 52768, 54059, 55322, 59206, 59699, 60706, 60732, 62869] prompt_centric=None seed=0
2024-04-16 02:08:57 - INFO - Loading the model and SAEs
2024-04-16 02:08:57 - INFO - wandb_project='gpt2-layerwise_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/mnt/ssd-interp/dan/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=40000 eval_n_samples=500 batch_size=8 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=0.8, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=1.0), logits_kl=None) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.2.hook_resid_pre'])
2024-04-16 02:09:08 - INFO - done
2024-04-16 02:09:08 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-2_region-3_local-ue3lz0n7_Random_cluster
run_sae_path = /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Traceback (most recent call last):
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 51, in <module>
    fire.Fire(main)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 48, in main
    generate_dashboards(dashbaords_config, run_sae_path)
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 1005, in main
    generate_dashboards(model, dashboards_config, save_dir=save_dir)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 852, in generate_dashboards
    dashboards_data: dict[str, SaeVisData] = get_dashboards_data(
                                             ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 385, in get_dashboards_data
    assert (
AssertionError: Error: Some feature indices are greater than the number of SAE features
2024-04-16 02:09:15 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-6_region-0_e2e-zgdpkafo_Blue_area_in_bottom_left') save_json_data=False sae_positions=None feature_indices=[688, 880, 1517, 1774, 1928, 2009, 2484, 3074, 3213, 3583, 5038, 5205, 5790, 6592, 7463, 8659, 9404, 10344, 11272, 11326, 11383, 11669, 11728, 12166, 12222, 12273, 13237, 13271, 13274, 14545, 14579, 15237, 16037, 16716, 17363, 17447, 17575, 18068, 18940, 19364, 19384, 20019, 20279, 21185, 21322] prompt_centric=None seed=0
2024-04-16 02:09:15 - INFO - Loading the model and SAEs
2024-04-16 02:09:15 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=3.0, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.6.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-16 02:09:28 - INFO - done
2024-04-16 02:09:28 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-6_region-0_e2e-zgdpkafo_Blue_area_in_bottom_left
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/313 [00:00<?, ?it/s]Computing feature acts:   0%|          | 1/313 [00:01<08:42,  1.68s/it]Computing feature acts:   1%|          | 2/313 [00:02<06:39,  1.28s/it]Computing feature acts:   1%|          | 3/313 [00:03<05:58,  1.16s/it]Computing feature acts:   1%|▏         | 4/313 [00:04<05:39,  1.10s/it]Computing feature acts:   2%|▏         | 5/313 [00:05<05:28,  1.07s/it]Computing feature acts:   2%|▏         | 6/313 [00:06<05:21,  1.05s/it]Computing feature acts:   2%|▏         | 7/313 [00:07<05:15,  1.03s/it]Computing feature acts:   3%|▎         | 8/313 [00:08<05:05,  1.00s/it]Computing feature acts:   3%|▎         | 9/313 [00:09<05:01,  1.01it/s]Computing feature acts:   3%|▎         | 10/313 [00:10<05:00,  1.01it/s]Computing feature acts:   4%|▎         | 11/313 [00:11<04:57,  1.02it/s]Computing feature acts:   4%|▍         | 12/313 [00:12<04:54,  1.02it/s]Computing feature acts:   4%|▍         | 13/313 [00:13<04:52,  1.02it/s]Computing feature acts:   4%|▍         | 14/313 [00:14<04:44,  1.05it/s]Computing feature acts:   5%|▍         | 15/313 [00:15<04:45,  1.04it/s]Computing feature acts:   5%|▌         | 16/313 [00:16<04:45,  1.04it/s]Computing feature acts:   5%|▌         | 17/313 [00:17<04:44,  1.04it/s]Computing feature acts:   6%|▌         | 18/313 [00:18<04:43,  1.04it/s]Computing feature acts:   6%|▌         | 19/313 [00:19<04:41,  1.05it/s]Computing feature acts:   6%|▋         | 20/313 [00:20<04:40,  1.05it/s]Computing feature acts:   7%|▋         | 21/313 [00:21<04:39,  1.04it/s]Computing feature acts:   7%|▋         | 22/313 [00:22<04:38,  1.04it/s]Computing feature acts:   7%|▋         | 23/313 [00:23<04:37,  1.04it/s]Computing feature acts:   8%|▊         | 24/313 [00:24<04:36,  1.05it/s]Computing feature acts:   8%|▊         | 25/313 [00:24<04:35,  1.05it/s]Computing feature acts:   8%|▊         | 26/313 [00:25<04:34,  1.04it/s]Computing feature acts:   9%|▊         | 27/313 [00:26<04:33,  1.05it/s]Computing feature acts:   9%|▉         | 28/313 [00:27<04:32,  1.05it/s]Computing feature acts:   9%|▉         | 29/313 [00:28<04:32,  1.04it/s]Computing feature acts:  10%|▉         | 30/313 [00:29<04:36,  1.02it/s]Computing feature acts:  10%|▉         | 31/313 [00:31<04:58,  1.06s/it]Computing feature acts:  10%|█         | 32/313 [00:32<04:56,  1.06s/it]Computing feature acts:  11%|█         | 33/313 [00:33<04:56,  1.06s/it]Computing feature acts:  11%|█         | 34/313 [00:34<04:54,  1.06s/it]Computing feature acts:  11%|█         | 35/313 [00:35<04:54,  1.06s/it]Computing feature acts:  12%|█▏        | 36/313 [00:36<04:54,  1.06s/it]Computing feature acts:  12%|█▏        | 37/313 [00:37<04:49,  1.05s/it]Computing feature acts:  12%|█▏        | 38/313 [00:38<04:46,  1.04s/it]Computing feature acts:  12%|█▏        | 39/313 [00:39<05:25,  1.19s/it]Computing feature acts:  13%|█▎        | 40/313 [00:41<05:27,  1.20s/it]Computing feature acts:  13%|█▎        | 41/313 [00:42<05:11,  1.14s/it]Computing feature acts:  13%|█▎        | 42/313 [00:43<05:00,  1.11s/it]Computing feature acts:  14%|█▎        | 43/313 [00:44<04:52,  1.08s/it]Computing feature acts:  14%|█▍        | 44/313 [00:45<04:52,  1.09s/it]Computing feature acts:  14%|█▍        | 45/313 [00:46<04:43,  1.06s/it]Computing feature acts:  15%|█▍        | 46/313 [00:47<04:41,  1.05s/it]Computing feature acts:  15%|█▌        | 47/313 [00:48<04:36,  1.04s/it]Computing feature acts:  15%|█▌        | 48/313 [00:49<04:40,  1.06s/it]Computing feature acts:  16%|█▌        | 49/313 [00:50<04:34,  1.04s/it]Computing feature acts:  16%|█▌        | 50/313 [00:51<04:31,  1.03s/it]Computing feature acts:  16%|█▋        | 51/313 [00:52<04:29,  1.03s/it]Computing feature acts:  17%|█▋        | 52/313 [00:53<04:31,  1.04s/it]Computing feature acts:  17%|█▋        | 53/313 [00:54<04:15,  1.02it/s]Computing feature acts:  17%|█▋        | 54/313 [00:55<04:07,  1.05it/s]Computing feature acts:  18%|█▊        | 55/313 [00:56<04:01,  1.07it/s]Computing feature acts:  18%|█▊        | 56/313 [00:57<03:59,  1.07it/s]Computing feature acts:  18%|█▊        | 57/313 [00:58<03:54,  1.09it/s]Computing feature acts:  19%|█▊        | 58/313 [00:58<03:58,  1.07it/s]Computing feature acts:  19%|█▉        | 59/313 [01:00<04:06,  1.03it/s]Computing feature acts:  19%|█▉        | 60/313 [01:01<04:12,  1.00it/s]Computing feature acts:  19%|█▉        | 61/313 [01:02<04:13,  1.01s/it]Computing feature acts:  20%|█▉        | 62/313 [01:03<04:16,  1.02s/it]Computing feature acts:  20%|██        | 63/313 [01:04<04:02,  1.03it/s]Computing feature acts:  20%|██        | 64/313 [01:05<04:07,  1.01it/s]Computing feature acts:  21%|██        | 65/313 [01:05<03:59,  1.03it/s]Computing feature acts:  21%|██        | 66/313 [01:06<03:58,  1.04it/s]Computing feature acts:  21%|██▏       | 67/313 [01:07<03:57,  1.04it/s]Computing feature acts:  22%|██▏       | 68/313 [01:08<04:02,  1.01it/s]Computing feature acts:  22%|██▏       | 69/313 [01:09<03:58,  1.02it/s]Computing feature acts:  22%|██▏       | 70/313 [01:10<03:56,  1.03it/s]Computing feature acts:  23%|██▎       | 71/313 [01:11<03:52,  1.04it/s]Computing feature acts:  23%|██▎       | 72/313 [01:12<03:55,  1.02it/s]Computing feature acts:  23%|██▎       | 73/313 [01:13<03:54,  1.02it/s]Computing feature acts:  24%|██▎       | 74/313 [01:14<03:57,  1.01it/s]Computing feature acts:  24%|██▍       | 75/313 [01:15<03:58,  1.00s/it]Computing feature acts:  24%|██▍       | 76/313 [01:17<04:09,  1.05s/it]Computing feature acts:  25%|██▍       | 77/313 [01:17<04:03,  1.03s/it]Computing feature acts:  25%|██▍       | 78/313 [01:19<04:08,  1.06s/it]Computing feature acts:  25%|██▌       | 79/313 [01:20<04:04,  1.05s/it]Computing feature acts:  26%|██▌       | 80/313 [01:21<04:09,  1.07s/it]Computing feature acts:  26%|██▌       | 81/313 [01:22<04:04,  1.05s/it]Computing feature acts:  26%|██▌       | 82/313 [01:23<03:57,  1.03s/it]Computing feature acts:  27%|██▋       | 83/313 [01:24<03:56,  1.03s/it]Computing feature acts:  27%|██▋       | 84/313 [01:25<03:58,  1.04s/it]Computing feature acts:  27%|██▋       | 85/313 [01:26<03:55,  1.03s/it]Computing feature acts:  27%|██▋       | 86/313 [01:27<03:54,  1.03s/it]Computing feature acts:  28%|██▊       | 87/313 [01:28<03:52,  1.03s/it]Computing feature acts:  28%|██▊       | 88/313 [01:29<03:56,  1.05s/it]Computing feature acts:  28%|██▊       | 89/313 [01:30<03:53,  1.04s/it]Computing feature acts:  29%|██▉       | 90/313 [01:31<03:50,  1.03s/it]Computing feature acts:  29%|██▉       | 91/313 [01:32<03:46,  1.02s/it]Computing feature acts:  29%|██▉       | 92/313 [01:33<03:47,  1.03s/it]Computing feature acts:  30%|██▉       | 93/313 [01:34<03:46,  1.03s/it]Computing feature acts:  30%|███       | 94/313 [01:35<03:45,  1.03s/it]Computing feature acts:  30%|███       | 95/313 [01:36<03:44,  1.03s/it]Computing feature acts:  31%|███       | 96/313 [01:37<03:56,  1.09s/it]Computing feature acts:  31%|███       | 97/313 [01:38<03:43,  1.04s/it]Computing feature acts:  31%|███▏      | 98/313 [01:39<03:37,  1.01s/it]Computing feature acts:  32%|███▏      | 99/313 [01:40<03:32,  1.01it/s]Computing feature acts:  32%|███▏      | 100/313 [01:41<03:31,  1.01it/s]Computing feature acts:  32%|███▏      | 101/313 [01:42<03:27,  1.02it/s]Computing feature acts:  33%|███▎      | 102/313 [01:43<03:25,  1.03it/s]Computing feature acts:  33%|███▎      | 103/313 [01:44<03:23,  1.03it/s]Computing feature acts:  33%|███▎      | 104/313 [01:45<03:32,  1.02s/it]Computing feature acts:  34%|███▎      | 105/313 [01:46<03:27,  1.00it/s]Computing feature acts:  34%|███▍      | 106/313 [01:47<03:24,  1.01it/s]Computing feature acts:  34%|███▍      | 107/313 [01:48<03:21,  1.02it/s]Computing feature acts:  35%|███▍      | 108/313 [01:49<03:25,  1.00s/it]Computing feature acts:  35%|███▍      | 109/313 [01:50<03:21,  1.01it/s]Computing feature acts:  35%|███▌      | 110/313 [01:51<03:13,  1.05it/s]Computing feature acts:  35%|███▌      | 111/313 [01:52<03:08,  1.07it/s]Computing feature acts:  36%|███▌      | 112/313 [01:53<03:12,  1.05it/s]Computing feature acts:  36%|███▌      | 113/313 [01:54<03:07,  1.07it/s]Computing feature acts:  36%|███▋      | 114/313 [01:55<03:04,  1.08it/s]Computing feature acts:  37%|███▋      | 115/313 [01:56<03:02,  1.08it/s]Computing feature acts:  37%|███▋      | 116/313 [01:57<03:06,  1.06it/s]Computing feature acts:  37%|███▋      | 117/313 [01:57<03:03,  1.07it/s]Computing feature acts:  38%|███▊      | 118/313 [01:58<03:00,  1.08it/s]Computing feature acts:  38%|███▊      | 119/313 [01:59<02:58,  1.09it/s]Computing feature acts:  38%|███▊      | 120/313 [02:00<03:01,  1.06it/s]Computing feature acts:  39%|███▊      | 121/313 [02:01<03:00,  1.06it/s]Computing feature acts:  39%|███▉      | 122/313 [02:02<03:00,  1.06it/s]Computing feature acts:  39%|███▉      | 123/313 [02:03<03:00,  1.05it/s]Computing feature acts:  40%|███▉      | 124/313 [02:04<03:05,  1.02it/s]Computing feature acts:  40%|███▉      | 125/313 [02:05<03:03,  1.03it/s]Computing feature acts:  40%|████      | 126/313 [02:06<03:00,  1.04it/s]Computing feature acts:  41%|████      | 127/313 [02:07<02:59,  1.04it/s]Computing feature acts:  41%|████      | 128/313 [02:08<03:03,  1.01it/s]Computing feature acts:  41%|████      | 129/313 [02:09<03:01,  1.01it/s]Computing feature acts:  42%|████▏     | 130/313 [02:10<03:00,  1.01it/s]Computing feature acts:  42%|████▏     | 131/313 [02:11<02:58,  1.02it/s]Computing feature acts:  42%|████▏     | 132/313 [02:12<03:00,  1.00it/s]Computing feature acts:  42%|████▏     | 133/313 [02:13<02:56,  1.02it/s]Computing feature acts:  43%|████▎     | 134/313 [02:14<02:53,  1.03it/s]Computing feature acts:  43%|████▎     | 135/313 [02:15<02:51,  1.03it/s]Computing feature acts:  43%|████▎     | 136/313 [02:16<02:59,  1.02s/it]Computing feature acts:  44%|████▍     | 137/313 [02:17<02:54,  1.01it/s]Computing feature acts:  44%|████▍     | 138/313 [02:18<02:52,  1.01it/s]Computing feature acts:  44%|████▍     | 139/313 [02:19<02:50,  1.02it/s]Computing feature acts:  45%|████▍     | 140/313 [02:20<02:51,  1.01it/s]Computing feature acts:  45%|████▌     | 141/313 [02:21<02:47,  1.03it/s]Computing feature acts:  45%|████▌     | 142/313 [02:22<02:45,  1.04it/s]Computing feature acts:  46%|████▌     | 143/313 [02:23<02:43,  1.04it/s]Computing feature acts:  46%|████▌     | 144/313 [02:24<02:44,  1.03it/s]Computing feature acts:  46%|████▋     | 145/313 [02:25<02:40,  1.05it/s]Computing feature acts:  47%|████▋     | 146/313 [02:26<02:37,  1.06it/s]Computing feature acts:  47%|████▋     | 147/313 [02:27<02:33,  1.08it/s]Computing feature acts:  47%|████▋     | 148/313 [02:27<02:33,  1.07it/s]Computing feature acts:  48%|████▊     | 149/313 [02:28<02:31,  1.08it/s]Computing feature acts:  48%|████▊     | 150/313 [02:29<02:30,  1.08it/s]Computing feature acts:  48%|████▊     | 151/313 [02:30<02:31,  1.07it/s]Computing feature acts:  49%|████▊     | 152/313 [02:31<02:33,  1.05it/s]Computing feature acts:  49%|████▉     | 153/313 [02:32<02:33,  1.04it/s]Computing feature acts:  49%|████▉     | 154/313 [02:33<02:32,  1.04it/s]Computing feature acts:  50%|████▉     | 155/313 [02:34<02:32,  1.04it/s]Computing feature acts:  50%|████▉     | 156/313 [02:35<02:35,  1.01it/s]Computing feature acts:  50%|█████     | 157/313 [02:36<02:33,  1.02it/s]Computing feature acts:  50%|█████     | 158/313 [02:37<02:31,  1.02it/s]Computing feature acts:  51%|█████     | 159/313 [02:38<02:30,  1.02it/s]Computing feature acts:  51%|█████     | 160/313 [02:39<02:31,  1.01it/s]Computing feature acts:  51%|█████▏    | 161/313 [02:40<02:36,  1.03s/it]Computing feature acts:  52%|█████▏    | 162/313 [02:41<02:32,  1.01s/it]Computing feature acts:  52%|█████▏    | 163/313 [02:42<02:29,  1.00it/s]Computing feature acts:  52%|█████▏    | 164/313 [02:43<02:31,  1.02s/it]Computing feature acts:  53%|█████▎    | 165/313 [02:44<02:28,  1.00s/it]Computing feature acts:  53%|█████▎    | 166/313 [02:45<02:26,  1.01it/s]Computing feature acts:  53%|█████▎    | 167/313 [02:46<02:23,  1.02it/s]Computing feature acts:  54%|█████▎    | 168/313 [02:47<02:23,  1.01it/s]Computing feature acts:  54%|█████▍    | 169/313 [02:48<02:21,  1.02it/s]Computing feature acts:  54%|█████▍    | 170/313 [02:49<02:23,  1.00s/it]Computing feature acts:  55%|█████▍    | 171/313 [02:50<02:25,  1.02s/it]Computing feature acts:  55%|█████▍    | 172/313 [02:51<02:28,  1.06s/it]Computing feature acts:  55%|█████▌    | 173/313 [02:52<02:27,  1.05s/it]Computing feature acts:  56%|█████▌    | 174/313 [02:53<02:23,  1.04s/it]Computing feature acts:  56%|█████▌    | 175/313 [02:54<02:23,  1.04s/it]Computing feature acts:  56%|█████▌    | 176/313 [02:56<02:26,  1.07s/it]Computing feature acts:  57%|█████▋    | 177/313 [02:57<02:19,  1.03s/it]Computing feature acts:  57%|█████▋    | 178/313 [02:58<02:16,  1.01s/it]Computing feature acts:  57%|█████▋    | 179/313 [02:58<02:12,  1.01it/s]Computing feature acts:  58%|█████▊    | 180/313 [02:59<02:13,  1.00s/it]Computing feature acts:  58%|█████▊    | 181/313 [03:00<02:09,  1.02it/s]Computing feature acts:  58%|█████▊    | 182/313 [03:01<02:07,  1.02it/s]Computing feature acts:  58%|█████▊    | 183/313 [03:02<02:05,  1.03it/s]Computing feature acts:  59%|█████▉    | 184/313 [03:03<02:09,  1.00s/it]Computing feature acts:  59%|█████▉    | 185/313 [03:04<02:07,  1.00it/s]Computing feature acts:  59%|█████▉    | 186/313 [03:05<02:05,  1.01it/s]Computing feature acts:  60%|█████▉    | 187/313 [03:06<02:06,  1.01s/it]Computing feature acts:  60%|██████    | 188/313 [03:07<02:07,  1.02s/it]Computing feature acts:  60%|██████    | 189/313 [03:08<02:02,  1.01it/s]Computing feature acts:  61%|██████    | 190/313 [03:09<01:58,  1.03it/s]Computing feature acts:  61%|██████    | 191/313 [03:10<01:55,  1.05it/s]Computing feature acts:  61%|██████▏   | 192/313 [03:11<01:56,  1.04it/s]Computing feature acts:  62%|██████▏   | 193/313 [03:12<01:53,  1.06it/s]Computing feature acts:  62%|██████▏   | 194/313 [03:13<01:50,  1.07it/s]Computing feature acts:  62%|██████▏   | 195/313 [03:14<01:48,  1.08it/s]Computing feature acts:  63%|██████▎   | 196/313 [03:15<01:49,  1.07it/s]Computing feature acts:  63%|██████▎   | 197/313 [03:16<01:47,  1.08it/s]Computing feature acts:  63%|██████▎   | 198/313 [03:17<01:46,  1.08it/s]Computing feature acts:  64%|██████▎   | 199/313 [03:18<01:45,  1.08it/s]Computing feature acts:  64%|██████▍   | 200/313 [03:19<01:48,  1.04it/s]Computing feature acts:  64%|██████▍   | 201/313 [03:20<01:46,  1.05it/s]Computing feature acts:  65%|██████▍   | 202/313 [03:20<01:43,  1.07it/s]Computing feature acts:  65%|██████▍   | 203/313 [03:21<01:42,  1.08it/s]Computing feature acts:  65%|██████▌   | 204/313 [03:22<01:43,  1.05it/s]Computing feature acts:  65%|██████▌   | 205/313 [03:23<01:41,  1.06it/s]Computing feature acts:  66%|██████▌   | 206/313 [03:24<01:39,  1.08it/s]Computing feature acts:  66%|██████▌   | 207/313 [03:25<01:37,  1.08it/s]Computing feature acts:  66%|██████▋   | 208/313 [03:26<01:43,  1.02it/s]Computing feature acts:  67%|██████▋   | 209/313 [03:27<01:39,  1.04it/s]Computing feature acts:  67%|██████▋   | 210/313 [03:28<01:38,  1.05it/s]Computing feature acts:  67%|██████▋   | 211/313 [03:29<01:37,  1.04it/s]Computing feature acts:  68%|██████▊   | 212/313 [03:30<01:39,  1.01it/s]Computing feature acts:  68%|██████▊   | 213/313 [03:31<01:37,  1.02it/s]Computing feature acts:  68%|██████▊   | 214/313 [03:32<01:34,  1.05it/s]Computing feature acts:  69%|██████▊   | 215/313 [03:33<01:34,  1.04it/s]Computing feature acts:  69%|██████▉   | 216/313 [03:34<01:37,  1.01s/it]Computing feature acts:  69%|██████▉   | 217/313 [03:35<01:36,  1.01s/it]Computing feature acts:  70%|██████▉   | 218/313 [03:36<01:34,  1.01it/s]Computing feature acts:  70%|██████▉   | 219/313 [03:37<01:31,  1.02it/s]Computing feature acts:  70%|███████   | 220/313 [03:38<01:33,  1.00s/it]Computing feature acts:  71%|███████   | 221/313 [03:39<01:30,  1.02it/s]Computing feature acts:  71%|███████   | 222/313 [03:40<01:28,  1.03it/s]Computing feature acts:  71%|███████   | 223/313 [03:41<01:26,  1.04it/s]Computing feature acts:  72%|███████▏  | 224/313 [03:42<01:28,  1.00it/s]Computing feature acts:  72%|███████▏  | 225/313 [03:43<01:27,  1.01it/s]Computing feature acts:  72%|███████▏  | 226/313 [03:44<01:25,  1.01it/s]Computing feature acts:  73%|███████▎  | 227/313 [03:45<01:27,  1.01s/it]Computing feature acts:  73%|███████▎  | 228/313 [03:46<01:24,  1.00it/s]Computing feature acts:  73%|███████▎  | 229/313 [03:47<01:21,  1.03it/s]Computing feature acts:  73%|███████▎  | 230/313 [03:48<01:19,  1.05it/s]Computing feature acts:  74%|███████▍  | 231/313 [03:49<01:17,  1.05it/s]Computing feature acts:  74%|███████▍  | 232/313 [03:50<01:19,  1.02it/s]Computing feature acts:  74%|███████▍  | 233/313 [03:51<01:20,  1.00s/it]Computing feature acts:  75%|███████▍  | 234/313 [03:52<01:20,  1.02s/it]Computing feature acts:  75%|███████▌  | 235/313 [03:53<01:20,  1.03s/it]Computing feature acts:  75%|███████▌  | 236/313 [03:54<01:22,  1.07s/it]Computing feature acts:  76%|███████▌  | 237/313 [03:55<01:21,  1.07s/it]Computing feature acts:  76%|███████▌  | 238/313 [03:56<01:20,  1.07s/it]Computing feature acts:  76%|███████▋  | 239/313 [03:57<01:19,  1.07s/it]Computing feature acts:  77%|███████▋  | 240/313 [03:58<01:19,  1.09s/it]Computing feature acts:  77%|███████▋  | 241/313 [03:59<01:17,  1.08s/it]Computing feature acts:  77%|███████▋  | 242/313 [04:01<01:16,  1.08s/it]Computing feature acts:  78%|███████▊  | 243/313 [04:02<01:15,  1.07s/it]Computing feature acts:  78%|███████▊  | 244/313 [04:03<01:16,  1.11s/it]Computing feature acts:  78%|███████▊  | 245/313 [04:04<01:14,  1.10s/it]Computing feature acts:  79%|███████▊  | 246/313 [04:05<01:13,  1.09s/it]Computing feature acts:  79%|███████▉  | 247/313 [04:06<01:11,  1.08s/it]Computing feature acts:  79%|███████▉  | 248/313 [04:07<01:12,  1.11s/it]Computing feature acts:  80%|███████▉  | 249/313 [04:08<01:10,  1.10s/it]Computing feature acts:  80%|███████▉  | 250/313 [04:09<01:09,  1.10s/it]Computing feature acts:  80%|████████  | 251/313 [04:10<01:07,  1.10s/it]Computing feature acts:  81%|████████  | 252/313 [04:12<01:07,  1.11s/it]Computing feature acts:  81%|████████  | 253/313 [04:13<01:05,  1.10s/it]Computing feature acts:  81%|████████  | 254/313 [04:14<01:04,  1.09s/it]Computing feature acts:  81%|████████▏ | 255/313 [04:15<01:02,  1.08s/it]Computing feature acts:  82%|████████▏ | 256/313 [04:16<01:01,  1.08s/it]Computing feature acts:  82%|████████▏ | 257/313 [04:17<00:58,  1.05s/it]Computing feature acts:  82%|████████▏ | 258/313 [04:18<00:54,  1.02it/s]Computing feature acts:  83%|████████▎ | 259/313 [04:19<00:52,  1.04it/s]Computing feature acts:  83%|████████▎ | 260/313 [04:20<00:51,  1.04it/s]Computing feature acts:  83%|████████▎ | 261/313 [04:20<00:49,  1.06it/s]Computing feature acts:  84%|████████▎ | 262/313 [04:21<00:47,  1.07it/s]Computing feature acts:  84%|████████▍ | 263/313 [04:22<00:46,  1.08it/s]Computing feature acts:  84%|████████▍ | 264/313 [04:23<00:47,  1.04it/s]Computing feature acts:  85%|████████▍ | 265/313 [04:24<00:45,  1.06it/s]Computing feature acts:  85%|████████▍ | 266/313 [04:25<00:43,  1.08it/s]Computing feature acts:  85%|████████▌ | 267/313 [04:26<00:42,  1.09it/s]Computing feature acts:  86%|████████▌ | 268/313 [04:27<00:43,  1.03it/s]Computing feature acts:  86%|████████▌ | 269/313 [04:28<00:42,  1.04it/s]Computing feature acts:  86%|████████▋ | 270/313 [04:29<00:41,  1.04it/s]Computing feature acts:  87%|████████▋ | 271/313 [04:30<00:40,  1.04it/s]Computing feature acts:  87%|████████▋ | 272/313 [04:31<00:40,  1.01it/s]Computing feature acts:  87%|████████▋ | 273/313 [04:32<00:39,  1.02it/s]Computing feature acts:  88%|████████▊ | 274/313 [04:33<00:38,  1.02it/s]Computing feature acts:  88%|████████▊ | 275/313 [04:34<00:35,  1.06it/s]Computing feature acts:  88%|████████▊ | 276/313 [04:35<00:34,  1.06it/s]Computing feature acts:  88%|████████▊ | 277/313 [04:36<00:33,  1.07it/s]Computing feature acts:  89%|████████▉ | 278/313 [04:37<00:32,  1.08it/s]Computing feature acts:  89%|████████▉ | 279/313 [04:37<00:31,  1.09it/s]Computing feature acts:  89%|████████▉ | 280/313 [04:38<00:30,  1.07it/s]Computing feature acts:  90%|████████▉ | 281/313 [04:39<00:29,  1.08it/s]Computing feature acts:  90%|█████████ | 282/313 [04:40<00:28,  1.09it/s]Computing feature acts:  90%|█████████ | 283/313 [04:41<00:27,  1.08it/s]Computing feature acts:  91%|█████████ | 284/313 [04:42<00:27,  1.06it/s]Computing feature acts:  91%|█████████ | 285/313 [04:43<00:26,  1.06it/s]Computing feature acts:  91%|█████████▏| 286/313 [04:44<00:25,  1.06it/s]Computing feature acts:  92%|█████████▏| 287/313 [04:45<00:24,  1.06it/s]Computing feature acts:  92%|█████████▏| 288/313 [04:46<00:23,  1.04it/s]Computing feature acts:  92%|█████████▏| 289/313 [04:47<00:22,  1.05it/s]Computing feature acts:  93%|█████████▎| 290/313 [04:48<00:21,  1.05it/s]Computing feature acts:  93%|█████████▎| 291/313 [04:49<00:20,  1.05it/s]Computing feature acts:  93%|█████████▎| 292/313 [04:50<00:20,  1.02it/s]Computing feature acts:  94%|█████████▎| 293/313 [04:51<00:19,  1.00it/s]Computing feature acts:  94%|█████████▍| 294/313 [04:52<00:18,  1.04it/s]Computing feature acts:  94%|█████████▍| 295/313 [04:53<00:17,  1.04it/s]Computing feature acts:  95%|█████████▍| 296/313 [04:54<00:17,  1.02s/it]Computing feature acts:  95%|█████████▍| 297/313 [04:55<00:15,  1.03it/s]Computing feature acts:  95%|█████████▌| 298/313 [04:56<00:14,  1.02it/s]Computing feature acts:  96%|█████████▌| 299/313 [04:57<00:13,  1.06it/s]Computing feature acts:  96%|█████████▌| 300/313 [04:58<00:12,  1.04it/s]Computing feature acts:  96%|█████████▌| 301/313 [04:59<00:11,  1.06it/s]Computing feature acts:  96%|█████████▋| 302/313 [05:00<00:10,  1.05it/s]Computing feature acts:  97%|█████████▋| 303/313 [05:00<00:09,  1.04it/s]Computing feature acts:  97%|█████████▋| 304/313 [05:02<00:08,  1.00it/s]Computing feature acts:  97%|█████████▋| 305/313 [05:03<00:08,  1.00s/it]Computing feature acts:  98%|█████████▊| 306/313 [05:04<00:07,  1.01s/it]Computing feature acts:  98%|█████████▊| 307/313 [05:05<00:06,  1.01s/it]Computing feature acts:  98%|█████████▊| 308/313 [05:06<00:05,  1.03s/it]Computing feature acts:  99%|█████████▊| 309/313 [05:07<00:04,  1.03s/it]Computing feature acts:  99%|█████████▉| 310/313 [05:08<00:03,  1.03s/it]Computing feature acts:  99%|█████████▉| 311/313 [05:09<00:02,  1.03s/it]Computing feature acts: 100%|█████████▉| 312/313 [05:10<00:01,  1.05s/it]Computing feature acts: 100%|██████████| 313/313 [05:11<00:00,  1.04s/it]Computing feature acts: 100%|██████████| 313/313 [05:12<00:00,  1.00it/s]
Parsing activation data:   0%|          | 0/1 [00:00<?, ?it/s]Parsing activation data: 100%|██████████| 1/1 [00:06<00:00,  6.59s/it]Parsing activation data: 100%|██████████| 1/1 [00:06<00:00,  6.59s/it]
2024-04-16 02:15:01 - INFO - Saving HTML feature dashboards for the SAE at blocks.6.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/1 [00:00<?, ?it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:01<00:00,  1.96s/it]Dashboard HTML files: 100%|██████████| 1/1 [00:01<00:00,  1.96s/it]
2024-04-16 02:15:03 - INFO - Finished.
2024-04-16 02:15:03 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-6_region-0_local-1jy3m5j0_Blue_area_in_bottom_left') save_json_data=False sae_positions=None feature_indices=[] prompt_centric=None seed=0
2024-04-16 02:15:03 - INFO - Loading the model and SAEs
2024-04-16 02:15:03 - INFO - wandb_project='gpt2-layerwise_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/mnt/ssd-interp/dan/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=40000 eval_n_samples=500 batch_size=8 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=4.0, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=1.0), logits_kl=None) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.6.hook_resid_pre'])
2024-04-16 02:15:15 - INFO - done
2024-04-16 02:15:15 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-6_region-0_local-1jy3m5j0_Blue_area_in_bottom_left
run_sae_path = /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Traceback (most recent call last):
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 51, in <module>
    fire.Fire(main)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 48, in main
    generate_dashboards(dashbaords_config, run_sae_path)
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 1005, in main
    generate_dashboards(model, dashboards_config, save_dir=save_dir)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 852, in generate_dashboards
    dashboards_data: dict[str, SaeVisData] = get_dashboards_data(
                                             ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 386, in get_dashboards_data
    feature_indices_tensors[sae_name].max().item()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: max(): Expected reduction dim to be specified for input.numel() == 0. Specify the reduction dim with the 'dim' argument.
2024-04-16 02:15:22 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-6_region-1_e2e-zgdpkafo_Orange_line_structure_at_bottom') save_json_data=False sae_positions=None feature_indices=[71, 887, 1591, 2389, 2714, 2913, 3981, 4152, 5299, 6148, 6192, 6286, 6579, 6962, 7371, 8156, 9398, 10296, 10300, 10366, 11296, 11621, 12340, 13092, 13401, 14637, 15355, 15544, 15565, 15597, 15843, 16560, 17964, 19518, 20791, 21590, 21650, 21915, 22309] prompt_centric=None seed=0
2024-04-16 02:15:22 - INFO - Loading the model and SAEs
2024-04-16 02:15:22 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=3.0, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.6.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-16 02:15:35 - INFO - done
2024-04-16 02:15:35 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-6_region-1_e2e-zgdpkafo_Orange_line_structure_at_bottom
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/313 [00:00<?, ?it/s]Computing feature acts:   0%|          | 1/313 [00:01<06:42,  1.29s/it]Computing feature acts:   1%|          | 2/313 [00:02<05:50,  1.13s/it]Computing feature acts:   1%|          | 3/313 [00:03<05:34,  1.08s/it]Computing feature acts:   1%|▏         | 4/313 [00:04<05:26,  1.06s/it]Computing feature acts:   2%|▏         | 5/313 [00:05<05:21,  1.04s/it]Computing feature acts:   2%|▏         | 6/313 [00:06<05:17,  1.04s/it]Computing feature acts:   2%|▏         | 7/313 [00:07<05:15,  1.03s/it]Computing feature acts:   3%|▎         | 8/313 [00:08<05:14,  1.03s/it]Computing feature acts:   3%|▎         | 9/313 [00:09<05:09,  1.02s/it]Computing feature acts:   3%|▎         | 10/313 [00:10<05:06,  1.01s/it]Computing feature acts:   4%|▎         | 11/313 [00:11<05:03,  1.00s/it]Computing feature acts:   4%|▍         | 12/313 [00:12<05:12,  1.04s/it]Computing feature acts:   4%|▍         | 13/313 [00:13<05:06,  1.02s/it]Computing feature acts:   4%|▍         | 14/313 [00:14<05:02,  1.01s/it]Computing feature acts:   5%|▍         | 15/313 [00:15<04:57,  1.00it/s]Computing feature acts:   5%|▌         | 16/313 [00:16<05:08,  1.04s/it]Computing feature acts:   5%|▌         | 17/313 [00:17<05:03,  1.03s/it]Computing feature acts:   6%|▌         | 18/313 [00:18<05:01,  1.02s/it]Computing feature acts:   6%|▌         | 19/313 [00:19<04:56,  1.01s/it]Computing feature acts:   6%|▋         | 20/313 [00:20<05:01,  1.03s/it]Computing feature acts:   7%|▋         | 21/313 [00:21<04:57,  1.02s/it]Computing feature acts:   7%|▋         | 22/313 [00:22<04:53,  1.01s/it]Computing feature acts:   7%|▋         | 23/313 [00:23<04:50,  1.00s/it]Computing feature acts:   8%|▊         | 24/313 [00:24<05:05,  1.06s/it]Computing feature acts:   8%|▊         | 25/313 [00:25<04:58,  1.04s/it]Computing feature acts:   8%|▊         | 26/313 [00:26<04:53,  1.02s/it]Computing feature acts:   9%|▊         | 27/313 [00:27<04:49,  1.01s/it]Computing feature acts:   9%|▉         | 28/313 [00:28<04:50,  1.02s/it]Computing feature acts:   9%|▉         | 29/313 [00:29<04:45,  1.01s/it]Computing feature acts:  10%|▉         | 30/313 [00:30<04:43,  1.00s/it]Computing feature acts:  10%|▉         | 31/313 [00:31<04:56,  1.05s/it]Computing feature acts:  10%|█         | 32/313 [00:32<04:52,  1.04s/it]Computing feature acts:  11%|█         | 33/313 [00:33<04:47,  1.03s/it]Computing feature acts:  11%|█         | 34/313 [00:34<04:43,  1.02s/it]Computing feature acts:  11%|█         | 35/313 [00:35<04:41,  1.01s/it]Computing feature acts:  12%|█▏        | 36/313 [00:37<04:46,  1.03s/it]Computing feature acts:  12%|█▏        | 37/313 [00:37<04:32,  1.01it/s]Computing feature acts:  12%|█▏        | 38/313 [00:38<04:24,  1.04it/s]Computing feature acts:  12%|█▏        | 39/313 [00:39<04:17,  1.07it/s]Computing feature acts:  13%|█▎        | 40/313 [00:40<04:19,  1.05it/s]Computing feature acts:  13%|█▎        | 41/313 [00:41<04:13,  1.07it/s]Computing feature acts:  13%|█▎        | 42/313 [00:42<04:22,  1.03it/s]Computing feature acts:  14%|█▎        | 43/313 [00:43<04:19,  1.04it/s]Computing feature acts:  14%|█▍        | 44/313 [00:44<04:27,  1.01it/s]Computing feature acts:  14%|█▍        | 45/313 [00:45<04:18,  1.04it/s]Computing feature acts:  15%|█▍        | 46/313 [00:46<04:17,  1.04it/s]Computing feature acts:  15%|█▌        | 47/313 [00:47<04:18,  1.03it/s]Computing feature acts:  15%|█▌        | 48/313 [00:48<04:26,  1.00s/it]Computing feature acts:  16%|█▌        | 49/313 [00:49<04:23,  1.00it/s]Computing feature acts:  16%|█▌        | 50/313 [00:50<04:19,  1.01it/s]Computing feature acts:  16%|█▋        | 51/313 [00:51<04:21,  1.00it/s]Computing feature acts:  17%|█▋        | 52/313 [00:52<04:23,  1.01s/it]Computing feature acts:  17%|█▋        | 53/313 [00:53<04:22,  1.01s/it]Computing feature acts:  17%|█▋        | 54/313 [00:54<04:21,  1.01s/it]Computing feature acts:  18%|█▊        | 55/313 [00:55<04:20,  1.01s/it]Computing feature acts:  18%|█▊        | 56/313 [00:56<04:24,  1.03s/it]Computing feature acts:  18%|█▊        | 57/313 [00:57<04:22,  1.03s/it]Computing feature acts:  19%|█▊        | 58/313 [00:58<04:21,  1.02s/it]Computing feature acts:  19%|█▉        | 59/313 [00:59<04:16,  1.01s/it]Computing feature acts:  19%|█▉        | 60/313 [01:00<04:22,  1.04s/it]Computing feature acts:  19%|█▉        | 61/313 [01:01<04:19,  1.03s/it]Computing feature acts:  20%|█▉        | 62/313 [01:02<04:18,  1.03s/it]Computing feature acts:  20%|██        | 63/313 [01:03<04:12,  1.01s/it]Computing feature acts:  20%|██        | 64/313 [01:04<04:14,  1.02s/it]Computing feature acts:  21%|██        | 65/313 [01:05<04:11,  1.01s/it]Computing feature acts:  21%|██        | 66/313 [01:06<04:09,  1.01s/it]Computing feature acts:  21%|██▏       | 67/313 [01:07<04:09,  1.01s/it]Computing feature acts:  22%|██▏       | 68/313 [01:09<04:16,  1.05s/it]Computing feature acts:  22%|██▏       | 69/313 [01:09<04:11,  1.03s/it]Computing feature acts:  22%|██▏       | 70/313 [01:11<04:09,  1.03s/it]Computing feature acts:  23%|██▎       | 71/313 [01:12<04:06,  1.02s/it]Computing feature acts:  23%|██▎       | 72/313 [01:13<04:05,  1.02s/it]Computing feature acts:  23%|██▎       | 73/313 [01:13<04:00,  1.00s/it]Computing feature acts:  24%|██▎       | 74/313 [01:14<03:55,  1.01it/s]Computing feature acts:  24%|██▍       | 75/313 [01:15<03:54,  1.02it/s]Computing feature acts:  24%|██▍       | 76/313 [01:16<03:57,  1.00s/it]Computing feature acts:  25%|██▍       | 77/313 [01:17<03:56,  1.00s/it]Computing feature acts:  25%|██▍       | 78/313 [01:18<03:55,  1.00s/it]Computing feature acts:  25%|██▌       | 79/313 [01:19<03:54,  1.00s/it]Computing feature acts:  26%|██▌       | 80/313 [01:20<03:54,  1.01s/it]Computing feature acts:  26%|██▌       | 81/313 [01:21<03:45,  1.03it/s]Computing feature acts:  26%|██▌       | 82/313 [01:22<03:44,  1.03it/s]Computing feature acts:  27%|██▋       | 83/313 [01:23<03:43,  1.03it/s]Computing feature acts:  27%|██▋       | 84/313 [01:24<03:50,  1.01s/it]Computing feature acts:  27%|██▋       | 85/313 [01:25<03:40,  1.04it/s]Computing feature acts:  27%|██▋       | 86/313 [01:26<03:37,  1.04it/s]Computing feature acts:  28%|██▊       | 87/313 [01:27<03:34,  1.05it/s]Computing feature acts:  28%|██▊       | 88/313 [01:28<03:35,  1.04it/s]Computing feature acts:  28%|██▊       | 89/313 [01:29<03:27,  1.08it/s]Computing feature acts:  29%|██▉       | 90/313 [01:30<03:22,  1.10it/s]Computing feature acts:  29%|██▉       | 91/313 [01:31<03:21,  1.10it/s]Computing feature acts:  29%|██▉       | 92/313 [01:32<03:27,  1.07it/s]Computing feature acts:  30%|██▉       | 93/313 [01:33<03:23,  1.08it/s]Computing feature acts:  30%|███       | 94/313 [01:34<03:21,  1.09it/s]Computing feature acts:  30%|███       | 95/313 [01:35<03:22,  1.08it/s]Computing feature acts:  31%|███       | 96/313 [01:36<03:39,  1.01s/it]Computing feature acts:  31%|███       | 97/313 [01:37<03:38,  1.01s/it]Computing feature acts:  31%|███▏      | 98/313 [01:38<03:37,  1.01s/it]Computing feature acts:  32%|███▏      | 99/313 [01:39<03:36,  1.01s/it]Computing feature acts:  32%|███▏      | 100/313 [01:40<03:41,  1.04s/it]Computing feature acts:  32%|███▏      | 101/313 [01:41<03:39,  1.03s/it]Computing feature acts:  33%|███▎      | 102/313 [01:42<03:36,  1.03s/it]Computing feature acts:  33%|███▎      | 103/313 [01:43<03:34,  1.02s/it]Computing feature acts:  33%|███▎      | 104/313 [01:44<03:34,  1.03s/it]Computing feature acts:  34%|███▎      | 105/313 [01:45<03:32,  1.02s/it]Computing feature acts:  34%|███▍      | 106/313 [01:46<03:23,  1.02it/s]Computing feature acts:  34%|███▍      | 107/313 [01:47<03:19,  1.03it/s]Computing feature acts:  35%|███▍      | 108/313 [01:48<03:23,  1.01it/s]Computing feature acts:  35%|███▍      | 109/313 [01:49<03:19,  1.02it/s]Computing feature acts:  35%|███▌      | 110/313 [01:50<03:16,  1.03it/s]Computing feature acts:  35%|███▌      | 111/313 [01:51<03:14,  1.04it/s]Computing feature acts:  36%|███▌      | 112/313 [01:52<03:21,  1.00s/it]Computing feature acts:  36%|███▌      | 113/313 [01:53<03:22,  1.01s/it]Computing feature acts:  36%|███▋      | 114/313 [01:54<03:22,  1.02s/it]Computing feature acts:  37%|███▋      | 115/313 [01:55<03:22,  1.02s/it]Computing feature acts:  37%|███▋      | 116/313 [01:56<03:27,  1.05s/it]Computing feature acts:  37%|███▋      | 117/313 [01:57<03:24,  1.04s/it]Computing feature acts:  38%|███▊      | 118/313 [01:58<03:21,  1.03s/it]Computing feature acts:  38%|███▊      | 119/313 [01:59<03:19,  1.03s/it]Computing feature acts:  38%|███▊      | 120/313 [02:00<03:18,  1.03s/it]Computing feature acts:  39%|███▊      | 121/313 [02:01<03:16,  1.02s/it]Computing feature acts:  39%|███▉      | 122/313 [02:02<03:14,  1.02s/it]Computing feature acts:  39%|███▉      | 123/313 [02:03<03:14,  1.02s/it]Computing feature acts:  40%|███▉      | 124/313 [02:04<03:16,  1.04s/it]Computing feature acts:  40%|███▉      | 125/313 [02:05<03:14,  1.03s/it]Computing feature acts:  40%|████      | 126/313 [02:06<03:11,  1.03s/it]Computing feature acts:  41%|████      | 127/313 [02:07<03:09,  1.02s/it]Computing feature acts:  41%|████      | 128/313 [02:08<03:09,  1.03s/it]Computing feature acts:  41%|████      | 129/313 [02:09<03:07,  1.02s/it]Computing feature acts:  42%|████▏     | 130/313 [02:10<03:04,  1.01s/it]Computing feature acts:  42%|████▏     | 131/313 [02:11<03:01,  1.00it/s]Computing feature acts:  42%|████▏     | 132/313 [02:12<03:09,  1.05s/it]Computing feature acts:  42%|████▏     | 133/313 [02:13<03:07,  1.04s/it]Computing feature acts:  43%|████▎     | 134/313 [02:14<03:03,  1.03s/it]Computing feature acts:  43%|████▎     | 135/313 [02:15<03:00,  1.02s/it]Computing feature acts:  43%|████▎     | 136/313 [02:16<03:01,  1.02s/it]Computing feature acts:  44%|████▍     | 137/313 [02:17<02:59,  1.02s/it]Computing feature acts:  44%|████▍     | 138/313 [02:18<02:58,  1.02s/it]Computing feature acts:  44%|████▍     | 139/313 [02:19<02:57,  1.02s/it]Computing feature acts:  45%|████▍     | 140/313 [02:21<02:57,  1.03s/it]Computing feature acts:  45%|████▌     | 141/313 [02:22<02:56,  1.03s/it]Computing feature acts:  45%|████▌     | 142/313 [02:23<02:55,  1.03s/it]Computing feature acts:  46%|████▌     | 143/313 [02:24<02:54,  1.03s/it]Computing feature acts:  46%|████▌     | 144/313 [02:25<02:54,  1.03s/it]Computing feature acts:  46%|████▋     | 145/313 [02:26<02:52,  1.03s/it]Computing feature acts:  47%|████▋     | 146/313 [02:27<02:51,  1.03s/it]Computing feature acts:  47%|████▋     | 147/313 [02:28<02:50,  1.03s/it]Computing feature acts:  47%|████▋     | 148/313 [02:29<02:51,  1.04s/it]Computing feature acts:  48%|████▊     | 149/313 [02:30<02:50,  1.04s/it]Computing feature acts:  48%|████▊     | 150/313 [02:31<02:49,  1.04s/it]Computing feature acts:  48%|████▊     | 151/313 [02:32<02:47,  1.04s/it]Computing feature acts:  49%|████▊     | 152/313 [02:33<02:47,  1.04s/it]Computing feature acts:  49%|████▉     | 153/313 [02:34<02:44,  1.03s/it]Computing feature acts:  49%|████▉     | 154/313 [02:35<02:42,  1.02s/it]Computing feature acts:  50%|████▉     | 155/313 [02:36<02:41,  1.02s/it]Computing feature acts:  50%|████▉     | 156/313 [02:37<02:43,  1.04s/it]Computing feature acts:  50%|█████     | 157/313 [02:38<02:40,  1.03s/it]Computing feature acts:  50%|█████     | 158/313 [02:39<02:39,  1.03s/it]Computing feature acts:  51%|█████     | 159/313 [02:40<02:38,  1.03s/it]Computing feature acts:  51%|█████     | 160/313 [02:41<02:38,  1.04s/it]Computing feature acts:  51%|█████▏    | 161/313 [02:42<02:44,  1.08s/it]Computing feature acts:  52%|█████▏    | 162/313 [02:43<02:39,  1.06s/it]Computing feature acts:  52%|█████▏    | 163/313 [02:44<02:36,  1.05s/it]Computing feature acts:  52%|█████▏    | 164/313 [02:46<02:38,  1.06s/it]Computing feature acts:  53%|█████▎    | 165/313 [02:47<02:35,  1.05s/it]Computing feature acts:  53%|█████▎    | 166/313 [02:48<02:32,  1.04s/it]Computing feature acts:  53%|█████▎    | 167/313 [02:49<02:30,  1.03s/it]Computing feature acts:  54%|█████▎    | 168/313 [02:50<02:29,  1.03s/it]Computing feature acts:  54%|█████▍    | 169/313 [02:51<02:27,  1.03s/it]Computing feature acts:  54%|█████▍    | 170/313 [02:52<02:24,  1.01s/it]Computing feature acts:  55%|█████▍    | 171/313 [02:53<02:24,  1.02s/it]Computing feature acts:  55%|█████▍    | 172/313 [02:54<02:30,  1.07s/it]Computing feature acts:  55%|█████▌    | 173/313 [02:55<02:28,  1.06s/it]Computing feature acts:  56%|█████▌    | 174/313 [02:56<02:25,  1.05s/it]Computing feature acts:  56%|█████▌    | 175/313 [02:57<02:22,  1.03s/it]Computing feature acts:  56%|█████▌    | 176/313 [02:58<02:25,  1.06s/it]Computing feature acts:  57%|█████▋    | 177/313 [02:59<02:22,  1.05s/it]Computing feature acts:  57%|█████▋    | 178/313 [03:00<02:20,  1.04s/it]Computing feature acts:  57%|█████▋    | 179/313 [03:01<02:19,  1.04s/it]Computing feature acts:  58%|█████▊    | 180/313 [03:02<02:19,  1.05s/it]Computing feature acts:  58%|█████▊    | 181/313 [03:03<02:16,  1.04s/it]Computing feature acts:  58%|█████▊    | 182/313 [03:04<02:15,  1.03s/it]Computing feature acts:  58%|█████▊    | 183/313 [03:05<02:13,  1.03s/it]Computing feature acts:  59%|█████▉    | 184/313 [03:06<02:12,  1.03s/it]Computing feature acts:  59%|█████▉    | 185/313 [03:07<02:11,  1.03s/it]Computing feature acts:  59%|█████▉    | 186/313 [03:08<02:10,  1.02s/it]Computing feature acts:  60%|█████▉    | 187/313 [03:09<02:14,  1.07s/it]Computing feature acts:  60%|██████    | 188/313 [03:11<02:18,  1.11s/it]Computing feature acts:  60%|██████    | 189/313 [03:12<02:13,  1.08s/it]Computing feature acts:  61%|██████    | 190/313 [03:13<02:11,  1.07s/it]Computing feature acts:  61%|██████    | 191/313 [03:14<02:10,  1.07s/it]Computing feature acts:  61%|██████▏   | 192/313 [03:15<02:08,  1.07s/it]Computing feature acts:  62%|██████▏   | 193/313 [03:16<02:06,  1.05s/it]Computing feature acts:  62%|██████▏   | 194/313 [03:17<02:04,  1.05s/it]Computing feature acts:  62%|██████▏   | 195/313 [03:18<02:04,  1.05s/it]Computing feature acts:  63%|██████▎   | 196/313 [03:19<02:03,  1.05s/it]Computing feature acts:  63%|██████▎   | 197/313 [03:20<02:00,  1.04s/it]Computing feature acts:  63%|██████▎   | 198/313 [03:21<01:58,  1.03s/it]Computing feature acts:  64%|██████▎   | 199/313 [03:22<01:56,  1.03s/it]Computing feature acts:  64%|██████▍   | 200/313 [03:23<01:57,  1.04s/it]Computing feature acts:  64%|██████▍   | 201/313 [03:24<01:56,  1.04s/it]Computing feature acts:  65%|██████▍   | 202/313 [03:25<01:55,  1.04s/it]Computing feature acts:  65%|██████▍   | 203/313 [03:26<01:54,  1.04s/it]Computing feature acts:  65%|██████▌   | 204/313 [03:27<01:54,  1.05s/it]Computing feature acts:  65%|██████▌   | 205/313 [03:28<01:53,  1.05s/it]Computing feature acts:  66%|██████▌   | 206/313 [03:29<01:52,  1.05s/it]Computing feature acts:  66%|██████▌   | 207/313 [03:30<01:51,  1.06s/it]Computing feature acts:  66%|██████▋   | 208/313 [03:31<01:50,  1.06s/it]Computing feature acts:  67%|██████▋   | 209/313 [03:33<01:50,  1.06s/it]Computing feature acts:  67%|██████▋   | 210/313 [03:34<01:48,  1.05s/it]Computing feature acts:  67%|██████▋   | 211/313 [03:35<01:46,  1.05s/it]Computing feature acts:  68%|██████▊   | 212/313 [03:36<01:48,  1.08s/it]Computing feature acts:  68%|██████▊   | 213/313 [03:37<01:46,  1.06s/it]Computing feature acts:  68%|██████▊   | 214/313 [03:38<01:44,  1.05s/it]Computing feature acts:  69%|██████▊   | 215/313 [03:39<01:42,  1.05s/it]Computing feature acts:  69%|██████▉   | 216/313 [03:40<01:42,  1.05s/it]Computing feature acts:  69%|██████▉   | 217/313 [03:41<01:40,  1.05s/it]Computing feature acts:  70%|██████▉   | 218/313 [03:42<01:39,  1.04s/it]Computing feature acts:  70%|██████▉   | 219/313 [03:43<01:37,  1.04s/it]Computing feature acts:  70%|███████   | 220/313 [03:44<01:38,  1.05s/it]Computing feature acts:  71%|███████   | 221/313 [03:45<01:36,  1.05s/it]Computing feature acts:  71%|███████   | 222/313 [03:46<01:34,  1.04s/it]Computing feature acts:  71%|███████   | 223/313 [03:47<01:33,  1.04s/it]Computing feature acts:  72%|███████▏  | 224/313 [03:48<01:33,  1.05s/it]Computing feature acts:  72%|███████▏  | 225/313 [03:49<01:31,  1.04s/it]Computing feature acts:  72%|███████▏  | 226/313 [03:50<01:29,  1.03s/it]Computing feature acts:  73%|███████▎  | 227/313 [03:51<01:29,  1.04s/it]Computing feature acts:  73%|███████▎  | 228/313 [03:52<01:30,  1.06s/it]Computing feature acts:  73%|███████▎  | 229/313 [03:54<01:29,  1.06s/it]Computing feature acts:  73%|███████▎  | 230/313 [03:55<01:28,  1.06s/it]Computing feature acts:  74%|███████▍  | 231/313 [03:56<01:27,  1.07s/it]Computing feature acts:  74%|███████▍  | 232/313 [03:57<01:26,  1.07s/it]Computing feature acts:  74%|███████▍  | 233/313 [03:58<01:25,  1.07s/it]Computing feature acts:  75%|███████▍  | 234/313 [03:59<01:24,  1.06s/it]Computing feature acts:  75%|███████▌  | 235/313 [04:00<01:18,  1.00s/it]Computing feature acts:  75%|███████▌  | 236/313 [04:01<01:16,  1.01it/s]Computing feature acts:  76%|███████▌  | 237/313 [04:02<01:13,  1.03it/s]Computing feature acts:  76%|███████▌  | 238/313 [04:03<01:11,  1.05it/s]Computing feature acts:  76%|███████▋  | 239/313 [04:03<01:09,  1.06it/s]Computing feature acts:  77%|███████▋  | 240/313 [04:04<01:11,  1.03it/s]Computing feature acts:  77%|███████▋  | 241/313 [04:05<01:08,  1.05it/s]Computing feature acts:  77%|███████▋  | 242/313 [04:06<01:06,  1.06it/s]Computing feature acts:  78%|███████▊  | 243/313 [04:07<01:05,  1.07it/s]Computing feature acts:  78%|███████▊  | 244/313 [04:08<01:05,  1.05it/s]Computing feature acts:  78%|███████▊  | 245/313 [04:09<01:04,  1.06it/s]Computing feature acts:  79%|███████▊  | 246/313 [04:10<01:02,  1.07it/s]Computing feature acts:  79%|███████▉  | 247/313 [04:11<01:01,  1.08it/s]Computing feature acts:  79%|███████▉  | 248/313 [04:12<01:00,  1.07it/s]Computing feature acts:  80%|███████▉  | 249/313 [04:13<00:59,  1.08it/s]Computing feature acts:  80%|███████▉  | 250/313 [04:14<00:58,  1.08it/s]Computing feature acts:  80%|████████  | 251/313 [04:15<00:58,  1.06it/s]Computing feature acts:  81%|████████  | 252/313 [04:16<00:59,  1.03it/s]Computing feature acts:  81%|████████  | 253/313 [04:17<00:58,  1.03it/s]Computing feature acts:  81%|████████  | 254/313 [04:18<00:57,  1.03it/s]Computing feature acts:  81%|████████▏ | 255/313 [04:19<00:56,  1.03it/s]Computing feature acts:  82%|████████▏ | 256/313 [04:20<00:57,  1.01s/it]Computing feature acts:  82%|████████▏ | 257/313 [04:21<00:55,  1.00it/s]Computing feature acts:  82%|████████▏ | 258/313 [04:22<00:54,  1.01it/s]Computing feature acts:  83%|████████▎ | 259/313 [04:23<00:53,  1.02it/s]Computing feature acts:  83%|████████▎ | 260/313 [04:24<00:52,  1.01it/s]Computing feature acts:  83%|████████▎ | 261/313 [04:25<00:51,  1.02it/s]Computing feature acts:  84%|████████▎ | 262/313 [04:26<00:49,  1.03it/s]Computing feature acts:  84%|████████▍ | 263/313 [04:27<00:48,  1.03it/s]Computing feature acts:  84%|████████▍ | 264/313 [04:28<00:47,  1.03it/s]Computing feature acts:  85%|████████▍ | 265/313 [04:28<00:46,  1.04it/s]Computing feature acts:  85%|████████▍ | 266/313 [04:29<00:45,  1.04it/s]Computing feature acts:  85%|████████▌ | 267/313 [04:30<00:43,  1.05it/s]Computing feature acts:  86%|████████▌ | 268/313 [04:31<00:44,  1.02it/s]Computing feature acts:  86%|████████▌ | 269/313 [04:32<00:42,  1.03it/s]Computing feature acts:  86%|████████▋ | 270/313 [04:33<00:41,  1.04it/s]Computing feature acts:  87%|████████▋ | 271/313 [04:34<00:40,  1.04it/s]Computing feature acts:  87%|████████▋ | 272/313 [04:35<00:40,  1.00it/s]Computing feature acts:  87%|████████▋ | 273/313 [04:36<00:39,  1.02it/s]Computing feature acts:  88%|████████▊ | 274/313 [04:37<00:37,  1.03it/s]Computing feature acts:  88%|████████▊ | 275/313 [04:38<00:37,  1.02it/s]Computing feature acts:  88%|████████▊ | 276/313 [04:39<00:38,  1.03s/it]Computing feature acts:  88%|████████▊ | 277/313 [04:40<00:36,  1.02s/it]Computing feature acts:  89%|████████▉ | 278/313 [04:41<00:34,  1.01it/s]Computing feature acts:  89%|████████▉ | 279/313 [04:42<00:32,  1.04it/s]Computing feature acts:  89%|████████▉ | 280/313 [04:43<00:32,  1.03it/s]Computing feature acts:  90%|████████▉ | 281/313 [04:44<00:30,  1.04it/s]Computing feature acts:  90%|█████████ | 282/313 [04:45<00:29,  1.04it/s]Computing feature acts:  90%|█████████ | 283/313 [04:46<00:29,  1.03it/s]Computing feature acts:  91%|█████████ | 284/313 [04:47<00:30,  1.04s/it]Computing feature acts:  91%|█████████ | 285/313 [04:48<00:28,  1.02s/it]Computing feature acts:  91%|█████████▏| 286/313 [04:49<00:26,  1.03it/s]Computing feature acts:  92%|█████████▏| 287/313 [04:50<00:24,  1.04it/s]Computing feature acts:  92%|█████████▏| 288/313 [04:51<00:23,  1.04it/s]Computing feature acts:  92%|█████████▏| 289/313 [04:52<00:23,  1.03it/s]Computing feature acts:  93%|█████████▎| 290/313 [04:53<00:22,  1.02it/s]Computing feature acts:  93%|█████████▎| 291/313 [04:54<00:21,  1.01it/s]Computing feature acts:  93%|█████████▎| 292/313 [04:55<00:21,  1.01s/it]Computing feature acts:  94%|█████████▎| 293/313 [04:56<00:21,  1.06s/it]Computing feature acts:  94%|█████████▍| 294/313 [04:57<00:19,  1.05s/it]Computing feature acts:  94%|█████████▍| 295/313 [04:58<00:18,  1.04s/it]Computing feature acts:  95%|█████████▍| 296/313 [04:59<00:18,  1.08s/it]Computing feature acts:  95%|█████████▍| 297/313 [05:00<00:16,  1.06s/it]Computing feature acts:  95%|█████████▌| 298/313 [05:01<00:15,  1.04s/it]Computing feature acts:  96%|█████████▌| 299/313 [05:02<00:14,  1.03s/it]Computing feature acts:  96%|█████████▌| 300/313 [05:04<00:13,  1.07s/it]Computing feature acts:  96%|█████████▌| 301/313 [05:05<00:12,  1.04s/it]Computing feature acts:  96%|█████████▋| 302/313 [05:06<00:11,  1.04s/it]Computing feature acts:  97%|█████████▋| 303/313 [05:07<00:10,  1.03s/it]Computing feature acts:  97%|█████████▋| 304/313 [05:08<00:09,  1.03s/it]Computing feature acts:  97%|█████████▋| 305/313 [05:09<00:08,  1.02s/it]Computing feature acts:  98%|█████████▊| 306/313 [05:10<00:07,  1.02s/it]Computing feature acts:  98%|█████████▊| 307/313 [05:11<00:06,  1.02s/it]Computing feature acts:  98%|█████████▊| 308/313 [05:12<00:05,  1.04s/it]Computing feature acts:  99%|█████████▊| 309/313 [05:13<00:04,  1.03s/it]Computing feature acts:  99%|█████████▉| 310/313 [05:14<00:03,  1.03s/it]Computing feature acts:  99%|█████████▉| 311/313 [05:15<00:02,  1.02s/it]Computing feature acts: 100%|█████████▉| 312/313 [05:16<00:01,  1.04s/it]Computing feature acts: 100%|██████████| 313/313 [05:17<00:00,  1.03s/it]Computing feature acts: 100%|██████████| 313/313 [05:18<00:00,  1.02s/it]
Parsing activation data:   0%|          | 0/1 [00:00<?, ?it/s]Parsing activation data: 100%|██████████| 1/1 [00:03<00:00,  3.80s/it]Parsing activation data: 100%|██████████| 1/1 [00:03<00:00,  3.80s/it]
2024-04-16 02:21:12 - INFO - Saving HTML feature dashboards for the SAE at blocks.6.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/1 [00:00<?, ?it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:01<00:00,  1.38s/it]Dashboard HTML files: 100%|██████████| 1/1 [00:01<00:00,  1.38s/it]
2024-04-16 02:21:13 - INFO - Finished.
2024-04-16 02:21:13 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-6_region-1_local-1jy3m5j0_Orange_line_structure_at_bottom') save_json_data=False sae_positions=None feature_indices=[22770, 22799, 22808, 22913, 22968, 22969, 22976, 23000, 23117, 23128, 23144, 23173, 23194, 23221, 23348, 23375, 23539, 23615, 23810, 23909, 23969, 24075, 24102, 24273, 24334, 24337, 24381, 24579, 24688, 24813, 24839, 24910, 24946, 25091, 25129, 25148, 25248, 25314, 25336, 25411, 25439, 25471, 25604, 25706, 25721, 25760, 25785, 25942, 26191, 26291, 26343, 26459, 26484, 26563, 26616, 26661, 26737, 26746, 26779, 27013, 27132, 27170, 27215, 27433, 27478, 27523, 27546, 27636, 27645, 27651, 27767, 27863, 27875, 27920, 27954, 28181, 28343, 28484, 28490, 28565, 28583, 28669, 28687, 28775, 28804, 28859, 28908, 28917, 28968, 29034, 29223, 29235, 29241, 29339, 29390, 29400, 29424, 29708, 29909, 29927, 29962, 29966, 30085, 30169, 30207, 30384, 30519, 30551, 30718, 30720, 30783, 30799, 30918, 30938, 31063, 31096, 31132, 31197, 31216, 31268, 31385, 31397, 31509, 31708, 31759, 32354, 32407, 32432, 32443, 32448, 32450, 32519, 32539, 32847, 33029, 33080, 33204, 33236, 33285, 33327, 33340, 33576, 33583, 33721, 33748, 33769, 33839, 33868, 33921, 33930, 33939, 33942, 33966, 34157, 34165, 34207, 34208, 34421, 34727, 34795, 34956, 34972, 35353, 35540, 35562, 35563, 35582, 35629, 35630, 35686, 35803, 35920, 36135, 36356, 36434, 36445, 36671, 36958, 37056, 37118, 37322, 37343, 37380, 37399, 37433, 37452, 37805, 37982, 38009, 38093, 38098, 38181, 38204, 38223, 38296, 38310, 38379, 38404, 38469, 38490, 38670, 38690, 38776, 38813, 38888, 38921, 38984, 39168, 39170, 39432, 39474, 39487, 39529, 39573, 39794, 39813, 39842, 40024, 40129, 40227, 40233, 40251, 40310, 40577, 40627, 40675, 40750, 40764, 40790, 40808, 40884, 41022, 41172, 41238, 41406, 41467, 41538, 41630, 41718, 41768, 41852, 41973, 42070, 42089, 42196, 42255, 42329, 42457, 42519, 42563, 42583, 42635, 42716, 42749, 42868, 42926, 43236, 43359, 43366, 43403, 43412, 43505, 43575, 43611, 43656, 43873, 43984, 44001, 44004, 44005, 44092, 44197, 44393, 44411, 44445, 44584, 44659, 44693, 44749, 44791, 44819, 44823, 44947, 45173, 45174, 45191, 45274, 45317, 45384, 45476, 45489, 45552, 45556, 45569, 45589, 45600, 45677, 45776, 45781, 45905, 45912, 45931, 45974, 46013, 46462, 46570, 46678, 46835, 46856, 46969, 46973, 47053, 47080, 47100, 47314, 47422, 47447, 47501, 47654, 47757, 47820, 47833, 48095, 48167, 48182, 48192, 48257, 48382, 48405, 48503, 48517, 48575, 48686, 48840, 48896, 48900, 48978, 48994, 49011, 49031] prompt_centric=None seed=0
2024-04-16 02:21:13 - INFO - Loading the model and SAEs
2024-04-16 02:21:13 - INFO - wandb_project='gpt2-layerwise_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/mnt/ssd-interp/dan/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=40000 eval_n_samples=500 batch_size=8 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=4.0, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=1.0), logits_kl=None) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.6.hook_resid_pre'])
2024-04-16 02:21:25 - INFO - done
2024-04-16 02:21:25 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-6_region-1_local-1jy3m5j0_Orange_line_structure_at_bottom
run_sae_path = /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Traceback (most recent call last):
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 51, in <module>
    fire.Fire(main)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 48, in main
    generate_dashboards(dashbaords_config, run_sae_path)
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 1005, in main
    generate_dashboards(model, dashboards_config, save_dir=save_dir)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 852, in generate_dashboards
    dashboards_data: dict[str, SaeVisData] = get_dashboards_data(
                                             ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 385, in get_dashboards_data
    assert (
AssertionError: Error: Some feature indices are greater than the number of SAE features
2024-04-16 02:21:32 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-6_region-2_e2e-zgdpkafo_Blue_region_above_orange_line') save_json_data=False sae_positions=None feature_indices=[111, 117, 188, 456, 489, 748, 781, 1201, 1386, 1597, 1726, 1732, 1912, 1964, 2007, 2022, 2148, 2418, 2668, 2720, 2953, 3085, 3692, 3751, 3951, 3969, 4171, 4485, 4493, 4531, 4536, 4748, 4769, 4873, 4913, 5141, 5165, 5556, 5612, 5758, 6079, 6337, 6338, 6398, 6568, 6634, 7126, 7566, 7628, 7676, 7801, 7838, 8271, 8318, 8319, 8632, 8636, 8916, 9049, 9123, 9332, 9598, 9765, 10510, 10810, 10874, 10908, 10925, 11110, 11282, 11330, 12253, 12497, 12729, 12853, 12895, 12900, 12981, 13576, 13611, 13646, 13732, 13796, 13891, 14077, 14242, 14396, 14447, 14490, 14591, 14978, 15104, 15133, 15327, 15549, 15647, 15846, 16142, 16192, 16330, 16335, 16377, 16526, 16665, 17609, 17839, 18070, 18132, 18189, 18269, 18323, 18487, 18706, 18883, 18896, 19953, 19996, 20147, 20148, 20238, 20557, 20687, 20809, 20818, 20821, 20853, 21133, 21177, 21202, 21441, 21457, 21630, 21680, 21832, 21977, 22119, 22195, 22288, 22512] prompt_centric=None seed=0
2024-04-16 02:21:32 - INFO - Loading the model and SAEs
2024-04-16 02:21:32 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=3.0, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.6.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-16 02:21:44 - INFO - done
2024-04-16 02:21:44 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-6_region-2_e2e-zgdpkafo_Blue_region_above_orange_line
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/313 [00:00<?, ?it/s]Computing feature acts:   0%|          | 1/313 [00:01<06:17,  1.21s/it]Computing feature acts:   1%|          | 2/313 [00:02<05:22,  1.04s/it]Computing feature acts:   1%|          | 3/313 [00:03<05:04,  1.02it/s]Computing feature acts:   1%|▏         | 4/313 [00:03<04:55,  1.05it/s]Computing feature acts:   2%|▏         | 5/313 [00:04<04:50,  1.06it/s]Computing feature acts:   2%|▏         | 6/313 [00:05<04:52,  1.05it/s]Computing feature acts:   2%|▏         | 7/313 [00:06<04:47,  1.07it/s]Computing feature acts:   3%|▎         | 8/313 [00:07<04:46,  1.07it/s]Computing feature acts:   3%|▎         | 9/313 [00:08<04:45,  1.07it/s]Computing feature acts:   3%|▎         | 10/313 [00:09<04:44,  1.06it/s]Computing feature acts:   4%|▎         | 11/313 [00:10<04:44,  1.06it/s]Computing feature acts:   4%|▍         | 12/313 [00:11<04:47,  1.05it/s]Computing feature acts:   4%|▍         | 13/313 [00:12<04:47,  1.04it/s]Computing feature acts:   4%|▍         | 14/313 [00:13<04:41,  1.06it/s]Computing feature acts:   5%|▍         | 15/313 [00:14<04:40,  1.06it/s]Computing feature acts:   5%|▌         | 16/313 [00:15<04:42,  1.05it/s]Computing feature acts:   5%|▌         | 17/313 [00:16<04:39,  1.06it/s]Computing feature acts:   6%|▌         | 18/313 [00:17<04:38,  1.06it/s]Computing feature acts:   6%|▌         | 19/313 [00:18<04:35,  1.07it/s]Computing feature acts:   6%|▋         | 20/313 [00:19<04:35,  1.06it/s]Computing feature acts:   7%|▋         | 21/313 [00:19<04:34,  1.06it/s]Computing feature acts:   7%|▋         | 22/313 [00:20<04:39,  1.04it/s]Computing feature acts:   7%|▋         | 23/313 [00:21<04:34,  1.06it/s]Computing feature acts:   8%|▊         | 24/313 [00:22<04:31,  1.06it/s]Computing feature acts:   8%|▊         | 25/313 [00:23<04:28,  1.07it/s]Computing feature acts:   8%|▊         | 26/313 [00:24<04:38,  1.03it/s]Computing feature acts:   9%|▊         | 27/313 [00:25<04:43,  1.01it/s]Computing feature acts:   9%|▉         | 28/313 [00:26<04:49,  1.02s/it]Computing feature acts:   9%|▉         | 29/313 [00:27<04:46,  1.01s/it]Computing feature acts:  10%|▉         | 30/313 [00:28<04:50,  1.03s/it]Computing feature acts:  10%|▉         | 31/313 [00:30<05:06,  1.09s/it]Computing feature acts:  10%|█         | 32/313 [00:31<05:04,  1.09s/it]Computing feature acts:  11%|█         | 33/313 [00:32<05:00,  1.07s/it]Computing feature acts:  11%|█         | 34/313 [00:33<04:58,  1.07s/it]Computing feature acts:  11%|█         | 35/313 [00:34<04:55,  1.06s/it]Computing feature acts:  12%|█▏        | 36/313 [00:35<04:53,  1.06s/it]Computing feature acts:  12%|█▏        | 37/313 [00:36<04:50,  1.05s/it]Computing feature acts:  12%|█▏        | 38/313 [00:37<04:53,  1.07s/it]Computing feature acts:  12%|█▏        | 39/313 [00:38<04:49,  1.06s/it]Computing feature acts:  13%|█▎        | 40/313 [00:39<04:47,  1.05s/it]Computing feature acts:  13%|█▎        | 41/313 [00:40<04:46,  1.05s/it]Computing feature acts:  13%|█▎        | 42/313 [00:41<04:45,  1.05s/it]Computing feature acts:  14%|█▎        | 43/313 [00:43<05:11,  1.15s/it]Computing feature acts:  14%|█▍        | 44/313 [00:44<05:29,  1.22s/it]Computing feature acts:  14%|█▍        | 45/313 [00:45<05:08,  1.15s/it]Computing feature acts:  15%|█▍        | 46/313 [00:46<04:57,  1.11s/it]Computing feature acts:  15%|█▌        | 47/313 [00:47<04:50,  1.09s/it]Computing feature acts:  15%|█▌        | 48/313 [00:48<04:49,  1.09s/it]Computing feature acts:  16%|█▌        | 49/313 [00:49<04:44,  1.08s/it]Computing feature acts:  16%|█▌        | 50/313 [00:50<04:49,  1.10s/it]Computing feature acts:  16%|█▋        | 51/313 [00:51<04:43,  1.08s/it]Computing feature acts:  17%|█▋        | 52/313 [00:52<04:39,  1.07s/it]Computing feature acts:  17%|█▋        | 53/313 [00:53<04:22,  1.01s/it]Computing feature acts:  17%|█▋        | 54/313 [00:54<04:13,  1.02it/s]Computing feature acts:  18%|█▊        | 55/313 [00:55<04:07,  1.04it/s]Computing feature acts:  18%|█▊        | 56/313 [00:56<04:06,  1.04it/s]Computing feature acts:  18%|█▊        | 57/313 [00:57<04:03,  1.05it/s]Computing feature acts:  19%|█▊        | 58/313 [00:58<04:08,  1.03it/s]Computing feature acts:  19%|█▉        | 59/313 [00:59<04:03,  1.04it/s]Computing feature acts:  19%|█▉        | 60/313 [01:00<04:02,  1.04it/s]Computing feature acts:  19%|█▉        | 61/313 [01:01<04:02,  1.04it/s]Computing feature acts:  20%|█▉        | 62/313 [01:02<03:57,  1.06it/s]Computing feature acts:  20%|██        | 63/313 [01:03<03:55,  1.06it/s]Computing feature acts:  20%|██        | 64/313 [01:04<04:00,  1.03it/s]Computing feature acts:  21%|██        | 65/313 [01:05<03:54,  1.06it/s]Computing feature acts:  21%|██        | 66/313 [01:06<03:51,  1.07it/s]Computing feature acts:  21%|██▏       | 67/313 [01:07<03:48,  1.08it/s]Computing feature acts:  22%|██▏       | 68/313 [01:07<03:47,  1.08it/s]Computing feature acts:  22%|██▏       | 69/313 [01:08<03:43,  1.09it/s]Computing feature acts:  22%|██▏       | 70/313 [01:09<03:43,  1.09it/s]Computing feature acts:  23%|██▎       | 71/313 [01:10<03:42,  1.09it/s]Computing feature acts:  23%|██▎       | 72/313 [01:11<03:38,  1.10it/s]Computing feature acts:  23%|██▎       | 73/313 [01:12<03:39,  1.10it/s]Computing feature acts:  24%|██▎       | 74/313 [01:13<03:42,  1.07it/s]Computing feature acts:  24%|██▍       | 75/313 [01:14<03:38,  1.09it/s]Computing feature acts:  24%|██▍       | 76/313 [01:15<03:40,  1.07it/s]Computing feature acts:  25%|██▍       | 77/313 [01:16<03:40,  1.07it/s]Computing feature acts:  25%|██▍       | 78/313 [01:17<03:50,  1.02it/s]Computing feature acts:  25%|██▌       | 79/313 [01:18<03:51,  1.01it/s]Computing feature acts:  26%|██▌       | 80/313 [01:19<03:45,  1.03it/s]Computing feature acts:  26%|██▌       | 81/313 [01:20<03:38,  1.06it/s]Computing feature acts:  26%|██▌       | 82/313 [01:21<03:45,  1.03it/s]Computing feature acts:  27%|██▋       | 83/313 [01:22<03:41,  1.04it/s]Computing feature acts:  27%|██▋       | 84/313 [01:23<03:42,  1.03it/s]Computing feature acts:  27%|██▋       | 85/313 [01:24<03:44,  1.02it/s]Computing feature acts:  27%|██▋       | 86/313 [01:25<03:45,  1.01it/s]Computing feature acts:  28%|██▊       | 87/313 [01:26<03:50,  1.02s/it]Computing feature acts:  28%|██▊       | 88/313 [01:27<03:54,  1.04s/it]Computing feature acts:  28%|██▊       | 89/313 [01:28<03:56,  1.05s/it]Computing feature acts:  29%|██▉       | 90/313 [01:29<03:58,  1.07s/it]Computing feature acts:  29%|██▉       | 91/313 [01:30<03:55,  1.06s/it]Computing feature acts:  29%|██▉       | 92/313 [01:31<03:57,  1.07s/it]Computing feature acts:  30%|██▉       | 93/313 [01:32<03:55,  1.07s/it]Computing feature acts:  30%|███       | 94/313 [01:33<03:56,  1.08s/it]Computing feature acts:  30%|███       | 95/313 [01:34<03:53,  1.07s/it]Computing feature acts:  31%|███       | 96/313 [01:36<04:11,  1.16s/it]Computing feature acts:  31%|███       | 97/313 [01:37<04:10,  1.16s/it]Computing feature acts:  31%|███▏      | 98/313 [01:38<04:10,  1.17s/it]Computing feature acts:  32%|███▏      | 99/313 [01:39<04:04,  1.14s/it]Computing feature acts:  32%|███▏      | 100/313 [01:40<03:59,  1.12s/it]Computing feature acts:  32%|███▏      | 101/313 [01:41<03:55,  1.11s/it]Computing feature acts:  33%|███▎      | 102/313 [01:42<03:55,  1.12s/it]Computing feature acts:  33%|███▎      | 103/313 [01:44<03:53,  1.11s/it]Computing feature acts:  33%|███▎      | 104/313 [01:45<03:57,  1.13s/it]Computing feature acts:  34%|███▎      | 105/313 [01:46<03:57,  1.14s/it]Computing feature acts:  34%|███▍      | 106/313 [01:47<03:58,  1.15s/it]Computing feature acts:  34%|███▍      | 107/313 [01:48<03:58,  1.16s/it]Computing feature acts:  35%|███▍      | 108/313 [01:49<03:56,  1.16s/it]Computing feature acts:  35%|███▍      | 109/313 [01:51<03:50,  1.13s/it]Computing feature acts:  35%|███▌      | 110/313 [01:52<03:51,  1.14s/it]Computing feature acts:  35%|███▌      | 111/313 [01:53<03:47,  1.13s/it]Computing feature acts:  36%|███▌      | 112/313 [01:54<03:46,  1.12s/it]Computing feature acts:  36%|███▌      | 113/313 [01:55<03:44,  1.12s/it]Computing feature acts:  36%|███▋      | 114/313 [01:56<03:42,  1.12s/it]Computing feature acts:  37%|███▋      | 115/313 [01:57<03:41,  1.12s/it]Computing feature acts:  37%|███▋      | 116/313 [01:58<03:40,  1.12s/it]Computing feature acts:  37%|███▋      | 117/313 [01:59<03:36,  1.11s/it]Computing feature acts:  38%|███▊      | 118/313 [02:01<03:36,  1.11s/it]Computing feature acts:  38%|███▊      | 119/313 [02:02<03:34,  1.11s/it]Computing feature acts:  38%|███▊      | 120/313 [02:03<03:33,  1.11s/it]Computing feature acts:  39%|███▊      | 121/313 [02:04<03:33,  1.11s/it]Computing feature acts:  39%|███▉      | 122/313 [02:05<03:32,  1.12s/it]Computing feature acts:  39%|███▉      | 123/313 [02:06<03:18,  1.04s/it]Computing feature acts:  40%|███▉      | 124/313 [02:07<03:12,  1.02s/it]Computing feature acts:  40%|███▉      | 125/313 [02:08<03:06,  1.01it/s]Computing feature acts:  40%|████      | 126/313 [02:09<03:06,  1.00it/s]Computing feature acts:  41%|████      | 127/313 [02:10<03:00,  1.03it/s]Computing feature acts:  41%|████      | 128/313 [02:11<02:58,  1.04it/s]Computing feature acts:  41%|████      | 129/313 [02:12<02:54,  1.05it/s]Computing feature acts:  42%|████▏     | 130/313 [02:13<02:57,  1.03it/s]Computing feature acts:  42%|████▏     | 131/313 [02:14<02:57,  1.02it/s]Computing feature acts:  42%|████▏     | 132/313 [02:15<02:58,  1.01it/s]Computing feature acts:  42%|████▏     | 133/313 [02:16<02:57,  1.01it/s]Computing feature acts:  43%|████▎     | 134/313 [02:17<02:57,  1.01it/s]Computing feature acts:  43%|████▎     | 135/313 [02:17<02:52,  1.03it/s]Computing feature acts:  43%|████▎     | 136/313 [02:18<02:50,  1.04it/s]Computing feature acts:  44%|████▍     | 137/313 [02:19<02:47,  1.05it/s]Computing feature acts:  44%|████▍     | 138/313 [02:20<02:46,  1.05it/s]Computing feature acts:  44%|████▍     | 139/313 [02:21<02:45,  1.05it/s]Computing feature acts:  45%|████▍     | 140/313 [02:22<02:47,  1.03it/s]Computing feature acts:  45%|████▌     | 141/313 [02:23<02:42,  1.06it/s]Computing feature acts:  45%|████▌     | 142/313 [02:24<02:48,  1.01it/s]Computing feature acts:  46%|████▌     | 143/313 [02:25<02:53,  1.02s/it]Computing feature acts:  46%|████▌     | 144/313 [02:26<02:58,  1.05s/it]Computing feature acts:  46%|████▋     | 145/313 [02:28<02:59,  1.07s/it]Computing feature acts:  47%|████▋     | 146/313 [02:29<03:01,  1.09s/it]Computing feature acts:  47%|████▋     | 147/313 [02:30<02:59,  1.08s/it]Computing feature acts:  47%|████▋     | 148/313 [02:31<03:01,  1.10s/it]Computing feature acts:  48%|████▊     | 149/313 [02:32<02:59,  1.09s/it]Computing feature acts:  48%|████▊     | 150/313 [02:33<02:59,  1.10s/it]Computing feature acts:  48%|████▊     | 151/313 [02:34<02:58,  1.10s/it]Computing feature acts:  49%|████▊     | 152/313 [02:35<02:56,  1.10s/it]Computing feature acts:  49%|████▉     | 153/313 [02:36<02:53,  1.08s/it]Computing feature acts:  49%|████▉     | 154/313 [02:37<02:53,  1.09s/it]Computing feature acts:  50%|████▉     | 155/313 [02:39<02:52,  1.09s/it]Computing feature acts:  50%|████▉     | 156/313 [02:40<02:51,  1.09s/it]Computing feature acts:  50%|█████     | 157/313 [02:41<02:52,  1.10s/it]Computing feature acts:  50%|█████     | 158/313 [02:42<02:53,  1.12s/it]Computing feature acts:  51%|█████     | 159/313 [02:43<02:47,  1.09s/it]Computing feature acts:  51%|█████     | 160/313 [02:44<02:46,  1.09s/it]Computing feature acts:  51%|█████▏    | 161/313 [02:45<02:52,  1.14s/it]Computing feature acts:  52%|█████▏    | 162/313 [02:46<02:49,  1.12s/it]Computing feature acts:  52%|█████▏    | 163/313 [02:47<02:46,  1.11s/it]Computing feature acts:  52%|█████▏    | 164/313 [02:49<02:45,  1.11s/it]Computing feature acts:  53%|█████▎    | 165/313 [02:50<02:43,  1.11s/it]Computing feature acts:  53%|█████▎    | 166/313 [02:51<02:43,  1.11s/it]Computing feature acts:  53%|█████▎    | 167/313 [02:52<02:41,  1.10s/it]Computing feature acts:  54%|█████▎    | 168/313 [02:53<02:39,  1.10s/it]Computing feature acts:  54%|█████▍    | 169/313 [02:54<02:38,  1.10s/it]Computing feature acts:  54%|█████▍    | 170/313 [02:55<02:37,  1.10s/it]Computing feature acts:  55%|█████▍    | 171/313 [02:56<02:35,  1.09s/it]Computing feature acts:  55%|█████▍    | 172/313 [02:57<02:32,  1.08s/it]Computing feature acts:  55%|█████▌    | 173/313 [02:58<02:32,  1.09s/it]Computing feature acts:  56%|█████▌    | 174/313 [03:00<02:37,  1.13s/it]Computing feature acts:  56%|█████▌    | 175/313 [03:01<02:36,  1.13s/it]Computing feature acts:  56%|█████▌    | 176/313 [03:02<02:37,  1.15s/it]Computing feature acts:  57%|█████▋    | 177/313 [03:03<02:35,  1.15s/it]Computing feature acts:  57%|█████▋    | 178/313 [03:04<02:31,  1.12s/it]Computing feature acts:  57%|█████▋    | 179/313 [03:05<02:28,  1.11s/it]Computing feature acts:  58%|█████▊    | 180/313 [03:06<02:21,  1.06s/it]Computing feature acts:  58%|█████▊    | 181/313 [03:07<02:17,  1.04s/it]Computing feature acts:  58%|█████▊    | 182/313 [03:08<02:15,  1.04s/it]Computing feature acts:  58%|█████▊    | 183/313 [03:09<02:12,  1.02s/it]Computing feature acts:  59%|█████▉    | 184/313 [03:10<02:10,  1.01s/it]Computing feature acts:  59%|█████▉    | 185/313 [03:11<02:08,  1.01s/it]Computing feature acts:  59%|█████▉    | 186/313 [03:12<02:12,  1.04s/it]Computing feature acts:  60%|█████▉    | 187/313 [03:14<02:20,  1.11s/it]Computing feature acts:  60%|██████    | 188/313 [03:15<02:19,  1.12s/it]Computing feature acts:  60%|██████    | 189/313 [03:16<02:17,  1.11s/it]Computing feature acts:  61%|██████    | 190/313 [03:17<02:16,  1.11s/it]Computing feature acts:  61%|██████    | 191/313 [03:18<02:14,  1.11s/it]Computing feature acts:  61%|██████▏   | 192/313 [03:19<02:14,  1.11s/it]Computing feature acts:  62%|██████▏   | 193/313 [03:20<02:12,  1.10s/it]Computing feature acts:  62%|██████▏   | 194/313 [03:21<02:11,  1.10s/it]Computing feature acts:  62%|██████▏   | 195/313 [03:22<02:07,  1.08s/it]Computing feature acts:  63%|██████▎   | 196/313 [03:23<02:06,  1.08s/it]Computing feature acts:  63%|██████▎   | 197/313 [03:25<02:05,  1.08s/it]Computing feature acts:  63%|██████▎   | 198/313 [03:26<02:02,  1.06s/it]Computing feature acts:  64%|██████▎   | 199/313 [03:26<01:56,  1.02s/it]Computing feature acts:  64%|██████▍   | 200/313 [03:27<01:53,  1.01s/it]Computing feature acts:  64%|██████▍   | 201/313 [03:28<01:50,  1.02it/s]Computing feature acts:  65%|██████▍   | 202/313 [03:29<01:47,  1.03it/s]Computing feature acts:  65%|██████▍   | 203/313 [03:30<01:45,  1.04it/s]Computing feature acts:  65%|██████▌   | 204/313 [03:31<01:44,  1.04it/s]Computing feature acts:  65%|██████▌   | 205/313 [03:32<01:41,  1.07it/s]Computing feature acts:  66%|██████▌   | 206/313 [03:33<01:41,  1.06it/s]Computing feature acts:  66%|██████▌   | 207/313 [03:34<01:39,  1.06it/s]Computing feature acts:  66%|██████▋   | 208/313 [03:35<01:39,  1.06it/s]Computing feature acts:  67%|██████▋   | 209/313 [03:36<01:37,  1.06it/s]Computing feature acts:  67%|██████▋   | 210/313 [03:37<01:37,  1.05it/s]Computing feature acts:  67%|██████▋   | 211/313 [03:38<01:39,  1.03it/s]Computing feature acts:  68%|██████▊   | 212/313 [03:39<01:41,  1.00s/it]Computing feature acts:  68%|██████▊   | 213/313 [03:40<01:43,  1.03s/it]Computing feature acts:  68%|██████▊   | 214/313 [03:41<01:44,  1.06s/it]Computing feature acts:  69%|██████▊   | 215/313 [03:42<01:44,  1.07s/it]Computing feature acts:  69%|██████▉   | 216/313 [03:43<01:44,  1.08s/it]Computing feature acts:  69%|██████▉   | 217/313 [03:44<01:43,  1.08s/it]Computing feature acts:  70%|██████▉   | 218/313 [03:46<01:43,  1.09s/it]Computing feature acts:  70%|██████▉   | 219/313 [03:47<01:42,  1.09s/it]Computing feature acts:  70%|███████   | 220/313 [03:48<01:42,  1.10s/it]Computing feature acts:  71%|███████   | 221/313 [03:49<01:41,  1.10s/it]Computing feature acts:  71%|███████   | 222/313 [03:50<01:42,  1.12s/it]Computing feature acts:  71%|███████   | 223/313 [03:51<01:41,  1.13s/it]Computing feature acts:  72%|███████▏  | 224/313 [03:52<01:42,  1.15s/it]Computing feature acts:  72%|███████▏  | 225/313 [03:53<01:39,  1.14s/it]Computing feature acts:  72%|███████▏  | 226/313 [03:55<01:39,  1.14s/it]Computing feature acts:  73%|███████▎  | 227/313 [03:56<01:40,  1.17s/it]Computing feature acts:  73%|███████▎  | 228/313 [03:57<01:38,  1.16s/it]Computing feature acts:  73%|███████▎  | 229/313 [03:58<01:36,  1.14s/it]Computing feature acts:  73%|███████▎  | 230/313 [03:59<01:34,  1.14s/it]Computing feature acts:  74%|███████▍  | 231/313 [04:00<01:33,  1.14s/it]Computing feature acts:  74%|███████▍  | 232/313 [04:01<01:31,  1.13s/it]Computing feature acts:  74%|███████▍  | 233/313 [04:03<01:30,  1.13s/it]Computing feature acts:  75%|███████▍  | 234/313 [04:04<01:28,  1.12s/it]Computing feature acts:  75%|███████▌  | 235/313 [04:05<01:27,  1.12s/it]Computing feature acts:  75%|███████▌  | 236/313 [04:06<01:27,  1.14s/it]Computing feature acts:  76%|███████▌  | 237/313 [04:07<01:27,  1.15s/it]Computing feature acts:  76%|███████▌  | 238/313 [04:08<01:22,  1.10s/it]Computing feature acts:  76%|███████▋  | 239/313 [04:09<01:22,  1.11s/it]Computing feature acts:  77%|███████▋  | 240/313 [04:11<01:22,  1.14s/it]Computing feature acts:  77%|███████▋  | 241/313 [04:12<01:23,  1.16s/it]Computing feature acts:  77%|███████▋  | 242/313 [04:13<01:23,  1.17s/it]Computing feature acts:  78%|███████▊  | 243/313 [04:14<01:20,  1.16s/it]Computing feature acts:  78%|███████▊  | 244/313 [04:15<01:18,  1.14s/it]Computing feature acts:  78%|███████▊  | 245/313 [04:16<01:17,  1.13s/it]Computing feature acts:  79%|███████▊  | 246/313 [04:17<01:15,  1.13s/it]Computing feature acts:  79%|███████▉  | 247/313 [04:19<01:14,  1.13s/it]Computing feature acts:  79%|███████▉  | 248/313 [04:20<01:13,  1.13s/it]Computing feature acts:  80%|███████▉  | 249/313 [04:21<01:11,  1.11s/it]Computing feature acts:  80%|███████▉  | 250/313 [04:22<01:06,  1.05s/it]Computing feature acts:  80%|████████  | 251/313 [04:23<01:03,  1.02s/it]Computing feature acts:  81%|████████  | 252/313 [04:24<01:01,  1.00s/it]Computing feature acts:  81%|████████  | 253/313 [04:24<00:59,  1.02it/s]Computing feature acts:  81%|████████  | 254/313 [04:25<00:57,  1.02it/s]Computing feature acts:  81%|████████▏ | 255/313 [04:26<00:56,  1.03it/s]Computing feature acts:  82%|████████▏ | 256/313 [04:27<00:55,  1.03it/s]Computing feature acts:  82%|████████▏ | 257/313 [04:28<00:53,  1.04it/s]Computing feature acts:  82%|████████▏ | 258/313 [04:29<00:53,  1.03it/s]Computing feature acts:  83%|████████▎ | 259/313 [04:30<00:52,  1.04it/s]Computing feature acts:  83%|████████▎ | 260/313 [04:31<00:50,  1.04it/s]Computing feature acts:  83%|████████▎ | 261/313 [04:32<00:49,  1.05it/s]Computing feature acts:  84%|████████▎ | 262/313 [04:33<00:48,  1.05it/s]Computing feature acts:  84%|████████▍ | 263/313 [04:34<00:46,  1.07it/s]Computing feature acts:  84%|████████▍ | 264/313 [04:35<00:45,  1.07it/s]Computing feature acts:  85%|████████▍ | 265/313 [04:36<00:44,  1.08it/s]Computing feature acts:  85%|████████▍ | 266/313 [04:37<00:43,  1.08it/s]Computing feature acts:  85%|████████▌ | 267/313 [04:38<00:42,  1.08it/s]Computing feature acts:  86%|████████▌ | 268/313 [04:39<00:41,  1.07it/s]Computing feature acts:  86%|████████▌ | 269/313 [04:40<00:40,  1.08it/s]Computing feature acts:  86%|████████▋ | 270/313 [04:41<00:41,  1.04it/s]Computing feature acts:  87%|████████▋ | 271/313 [04:42<00:40,  1.05it/s]Computing feature acts:  87%|████████▋ | 272/313 [04:42<00:38,  1.05it/s]Computing feature acts:  87%|████████▋ | 273/313 [04:43<00:37,  1.06it/s]Computing feature acts:  88%|████████▊ | 274/313 [04:44<00:36,  1.06it/s]Computing feature acts:  88%|████████▊ | 275/313 [04:45<00:35,  1.07it/s]Computing feature acts:  88%|████████▊ | 276/313 [04:46<00:35,  1.05it/s]Computing feature acts:  88%|████████▊ | 277/313 [04:47<00:33,  1.07it/s]Computing feature acts:  89%|████████▉ | 278/313 [04:48<00:33,  1.05it/s]Computing feature acts:  89%|████████▉ | 279/313 [04:49<00:31,  1.07it/s]Computing feature acts:  89%|████████▉ | 280/313 [04:50<00:31,  1.05it/s]Computing feature acts:  90%|████████▉ | 281/313 [04:51<00:30,  1.06it/s]Computing feature acts:  90%|█████████ | 282/313 [04:52<00:29,  1.06it/s]Computing feature acts:  90%|█████████ | 283/313 [04:53<00:28,  1.06it/s]Computing feature acts:  91%|█████████ | 284/313 [04:54<00:27,  1.07it/s]Computing feature acts:  91%|█████████ | 285/313 [04:55<00:25,  1.08it/s]Computing feature acts:  91%|█████████▏| 286/313 [04:56<00:25,  1.06it/s]Computing feature acts:  92%|█████████▏| 287/313 [04:57<00:24,  1.05it/s]Computing feature acts:  92%|█████████▏| 288/313 [04:58<00:24,  1.03it/s]Computing feature acts:  92%|█████████▏| 289/313 [04:59<00:23,  1.02it/s]Computing feature acts:  93%|█████████▎| 290/313 [05:00<00:22,  1.00it/s]Computing feature acts:  93%|█████████▎| 291/313 [05:01<00:21,  1.02it/s]Computing feature acts:  93%|█████████▎| 292/313 [05:02<00:20,  1.03it/s]Computing feature acts:  94%|█████████▎| 293/313 [05:03<00:20,  1.01s/it]Computing feature acts:  94%|█████████▍| 294/313 [05:04<00:18,  1.01it/s]Computing feature acts:  94%|█████████▍| 295/313 [05:04<00:17,  1.03it/s]Computing feature acts:  95%|█████████▍| 296/313 [05:05<00:16,  1.04it/s]Computing feature acts:  95%|█████████▍| 297/313 [05:06<00:15,  1.05it/s]Computing feature acts:  95%|█████████▌| 298/313 [05:07<00:14,  1.06it/s]Computing feature acts:  96%|█████████▌| 299/313 [05:08<00:13,  1.07it/s]Computing feature acts:  96%|█████████▌| 300/313 [05:09<00:12,  1.07it/s]Computing feature acts:  96%|█████████▌| 301/313 [05:10<00:11,  1.08it/s]Computing feature acts:  96%|█████████▋| 302/313 [05:11<00:10,  1.05it/s]Computing feature acts:  97%|█████████▋| 303/313 [05:12<00:09,  1.06it/s]Computing feature acts:  97%|█████████▋| 304/313 [05:13<00:08,  1.06it/s]Computing feature acts:  97%|█████████▋| 305/313 [05:14<00:07,  1.07it/s]Computing feature acts:  98%|█████████▊| 306/313 [05:15<00:06,  1.04it/s]Computing feature acts:  98%|█████████▊| 307/313 [05:16<00:05,  1.00it/s]Computing feature acts:  98%|█████████▊| 308/313 [05:17<00:05,  1.03s/it]Computing feature acts:  99%|█████████▊| 309/313 [05:18<00:04,  1.05s/it]Computing feature acts:  99%|█████████▉| 310/313 [05:19<00:03,  1.07s/it]Computing feature acts:  99%|█████████▉| 311/313 [05:20<00:02,  1.08s/it]Computing feature acts: 100%|█████████▉| 312/313 [05:21<00:01,  1.09s/it]Computing feature acts: 100%|██████████| 313/313 [05:23<00:00,  1.09s/it]Computing feature acts: 100%|██████████| 313/313 [05:24<00:00,  1.04s/it]
Parsing activation data:   0%|          | 0/2 [00:00<?, ?it/s]Parsing activation data:  50%|█████     | 1/2 [00:09<00:09,  9.83s/it]Parsing activation data: 100%|██████████| 2/2 [00:17<00:00,  8.62s/it]Parsing activation data: 100%|██████████| 2/2 [00:17<00:00,  8.80s/it]
2024-04-16 02:27:39 - INFO - Saving HTML feature dashboards for the SAE at blocks.6.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/2 [00:00<?, ?it/s]Dashboard HTML files:  50%|█████     | 1/2 [00:02<00:02,  2.51s/it]Dashboard HTML files: 100%|██████████| 2/2 [00:03<00:00,  1.73s/it]Dashboard HTML files: 100%|██████████| 2/2 [00:03<00:00,  1.85s/it]
2024-04-16 02:27:43 - INFO - Finished.
2024-04-16 02:27:43 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-6_region-2_local-1jy3m5j0_Blue_region_above_orange_line') save_json_data=False sae_positions=None feature_indices=[22983, 24649, 24874, 25394, 33011, 34561, 41955, 42060] prompt_centric=None seed=0
2024-04-16 02:27:43 - INFO - Loading the model and SAEs
2024-04-16 02:27:43 - INFO - wandb_project='gpt2-layerwise_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/mnt/ssd-interp/dan/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=40000 eval_n_samples=500 batch_size=8 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=4.0, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=1.0), logits_kl=None) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.6.hook_resid_pre'])
2024-04-16 02:27:54 - INFO - done
2024-04-16 02:27:54 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-6_region-2_local-1jy3m5j0_Blue_region_above_orange_line
run_sae_path = /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/313 [00:00<?, ?it/s]Computing feature acts:   0%|          | 1/313 [00:01<06:18,  1.21s/it]Computing feature acts:   1%|          | 2/313 [00:02<05:33,  1.07s/it]Computing feature acts:   1%|          | 3/313 [00:03<05:11,  1.00s/it]Computing feature acts:   1%|▏         | 4/313 [00:04<05:12,  1.01s/it]Computing feature acts:   2%|▏         | 5/313 [00:05<04:55,  1.04it/s]Computing feature acts:   2%|▏         | 6/313 [00:05<04:45,  1.08it/s]Computing feature acts:   2%|▏         | 7/313 [00:06<04:37,  1.10it/s]Computing feature acts:   3%|▎         | 8/313 [00:07<04:32,  1.12it/s]Computing feature acts:   3%|▎         | 9/313 [00:08<04:28,  1.13it/s]Computing feature acts:   3%|▎         | 10/313 [00:09<04:26,  1.14it/s]Computing feature acts:   4%|▎         | 11/313 [00:10<04:24,  1.14it/s]Computing feature acts:   4%|▍         | 12/313 [00:11<04:25,  1.14it/s]Computing feature acts:   4%|▍         | 13/313 [00:12<04:29,  1.11it/s]Computing feature acts:   4%|▍         | 14/313 [00:12<04:31,  1.10it/s]Computing feature acts:   5%|▍         | 15/313 [00:13<04:39,  1.07it/s]Computing feature acts:   5%|▌         | 16/313 [00:14<04:42,  1.05it/s]Computing feature acts:   5%|▌         | 17/313 [00:15<04:44,  1.04it/s]Computing feature acts:   6%|▌         | 18/313 [00:16<04:48,  1.02it/s]Computing feature acts:   6%|▌         | 19/313 [00:17<04:49,  1.02it/s]Computing feature acts:   6%|▋         | 20/313 [00:18<04:49,  1.01it/s]Computing feature acts:   7%|▋         | 21/313 [00:19<04:48,  1.01it/s]Computing feature acts:   7%|▋         | 22/313 [00:20<04:47,  1.01it/s]Computing feature acts:   7%|▋         | 23/313 [00:21<04:45,  1.02it/s]Computing feature acts:   8%|▊         | 24/313 [00:22<04:45,  1.01it/s]Computing feature acts:   8%|▊         | 25/313 [00:23<04:45,  1.01it/s]Computing feature acts:   8%|▊         | 26/313 [00:24<04:47,  1.00s/it]Computing feature acts:   9%|▊         | 27/313 [00:25<04:50,  1.02s/it]Computing feature acts:   9%|▉         | 28/313 [00:27<04:53,  1.03s/it]Computing feature acts:   9%|▉         | 29/313 [00:28<04:55,  1.04s/it]Computing feature acts:  10%|▉         | 30/313 [00:29<04:52,  1.03s/it]Computing feature acts:  10%|▉         | 31/313 [00:30<04:48,  1.02s/it]Computing feature acts:  10%|█         | 32/313 [00:30<04:32,  1.03it/s]Computing feature acts:  11%|█         | 33/313 [00:31<04:22,  1.07it/s]Computing feature acts:  11%|█         | 34/313 [00:32<04:14,  1.09it/s]Computing feature acts:  11%|█         | 35/313 [00:33<04:09,  1.11it/s]Computing feature acts:  12%|█▏        | 36/313 [00:34<04:06,  1.13it/s]Computing feature acts:  12%|█▏        | 37/313 [00:35<04:02,  1.14it/s]Computing feature acts:  12%|█▏        | 38/313 [00:36<04:00,  1.14it/s]Computing feature acts:  12%|█▏        | 39/313 [00:36<03:58,  1.15it/s]Computing feature acts:  13%|█▎        | 40/313 [00:37<03:57,  1.15it/s]Computing feature acts:  13%|█▎        | 41/313 [00:38<03:55,  1.15it/s]Computing feature acts:  13%|█▎        | 42/313 [00:39<03:58,  1.13it/s]Computing feature acts:  14%|█▎        | 43/313 [00:40<04:05,  1.10it/s]Computing feature acts:  14%|█▍        | 44/313 [00:41<04:18,  1.04it/s]Computing feature acts:  14%|█▍        | 45/313 [00:42<04:27,  1.00it/s]Computing feature acts:  15%|█▍        | 46/313 [00:43<04:36,  1.03s/it]Computing feature acts:  15%|█▌        | 47/313 [00:44<04:31,  1.02s/it]Computing feature acts:  15%|█▌        | 48/313 [00:45<04:29,  1.02s/it]Computing feature acts:  16%|█▌        | 49/313 [00:46<04:26,  1.01s/it]Computing feature acts:  16%|█▌        | 50/313 [00:47<04:14,  1.03it/s]Computing feature acts:  16%|█▋        | 51/313 [00:48<04:04,  1.07it/s]Computing feature acts:  17%|█▋        | 52/313 [00:49<04:01,  1.08it/s]Computing feature acts:  17%|█▋        | 53/313 [00:50<03:57,  1.09it/s]Computing feature acts:  17%|█▋        | 54/313 [00:51<03:55,  1.10it/s]Computing feature acts:  18%|█▊        | 55/313 [00:52<03:52,  1.11it/s]Computing feature acts:  18%|█▊        | 56/313 [00:53<04:00,  1.07it/s]Computing feature acts:  18%|█▊        | 57/313 [00:54<04:04,  1.05it/s]Computing feature acts:  19%|█▊        | 58/313 [00:55<04:08,  1.03it/s]Computing feature acts:  19%|█▉        | 59/313 [00:56<04:09,  1.02it/s]Computing feature acts:  19%|█▉        | 60/313 [00:57<04:10,  1.01it/s]Computing feature acts:  19%|█▉        | 61/313 [00:58<04:10,  1.01it/s]Computing feature acts:  20%|█▉        | 62/313 [00:59<04:16,  1.02s/it]Computing feature acts:  20%|██        | 63/313 [01:00<04:13,  1.01s/it]Computing feature acts:  20%|██        | 64/313 [01:01<04:02,  1.03it/s]Computing feature acts:  21%|██        | 65/313 [01:02<03:55,  1.05it/s]Computing feature acts:  21%|██        | 66/313 [01:03<03:55,  1.05it/s]Computing feature acts:  21%|██▏       | 67/313 [01:03<03:49,  1.07it/s]Computing feature acts:  22%|██▏       | 68/313 [01:04<03:47,  1.08it/s]Computing feature acts:  22%|██▏       | 69/313 [01:05<03:52,  1.05it/s]Computing feature acts:  22%|██▏       | 70/313 [01:06<03:49,  1.06it/s]Computing feature acts:  23%|██▎       | 71/313 [01:07<03:43,  1.08it/s]Computing feature acts:  23%|██▎       | 72/313 [01:08<03:42,  1.08it/s]Computing feature acts:  23%|██▎       | 73/313 [01:09<03:37,  1.11it/s]Computing feature acts:  24%|██▎       | 74/313 [01:10<03:36,  1.11it/s]Computing feature acts:  24%|██▍       | 75/313 [01:11<03:33,  1.12it/s]Computing feature acts:  24%|██▍       | 76/313 [01:12<03:34,  1.10it/s]Computing feature acts:  25%|██▍       | 77/313 [01:13<03:31,  1.11it/s]Computing feature acts:  25%|██▍       | 78/313 [01:13<03:34,  1.10it/s]Computing feature acts:  25%|██▌       | 79/313 [01:14<03:29,  1.12it/s]Computing feature acts:  26%|██▌       | 80/313 [01:15<03:29,  1.11it/s]Computing feature acts:  26%|██▌       | 81/313 [01:16<03:27,  1.12it/s]Computing feature acts:  26%|██▌       | 82/313 [01:17<03:30,  1.10it/s]Computing feature acts:  27%|██▋       | 83/313 [01:18<03:29,  1.10it/s]Computing feature acts:  27%|██▋       | 84/313 [01:19<03:31,  1.08it/s]Computing feature acts:  27%|██▋       | 85/313 [01:20<03:27,  1.10it/s]Computing feature acts:  27%|██▋       | 86/313 [01:21<03:26,  1.10it/s]Computing feature acts:  28%|██▊       | 87/313 [01:22<03:22,  1.12it/s]Computing feature acts:  28%|██▊       | 88/313 [01:23<03:25,  1.10it/s]Computing feature acts:  28%|██▊       | 89/313 [01:23<03:23,  1.10it/s]Computing feature acts:  29%|██▉       | 90/313 [01:24<03:31,  1.05it/s]Computing feature acts:  29%|██▉       | 91/313 [01:25<03:26,  1.07it/s]Computing feature acts:  29%|██▉       | 92/313 [01:26<03:21,  1.10it/s]Computing feature acts:  30%|██▉       | 93/313 [01:27<03:18,  1.11it/s]Computing feature acts:  30%|███       | 94/313 [01:28<03:17,  1.11it/s]Computing feature acts:  30%|███       | 95/313 [01:29<03:14,  1.12it/s]Computing feature acts:  31%|███       | 96/313 [01:30<03:15,  1.11it/s]Computing feature acts:  31%|███       | 97/313 [01:31<03:17,  1.09it/s]Computing feature acts:  31%|███▏      | 98/313 [01:32<03:16,  1.09it/s]Computing feature acts:  32%|███▏      | 99/313 [01:33<03:12,  1.11it/s]Computing feature acts:  32%|███▏      | 100/313 [01:33<03:10,  1.12it/s]Computing feature acts:  32%|███▏      | 101/313 [01:34<03:08,  1.12it/s]Computing feature acts:  33%|███▎      | 102/313 [01:35<03:08,  1.12it/s]Computing feature acts:  33%|███▎      | 103/313 [01:36<03:06,  1.13it/s]Computing feature acts:  33%|███▎      | 104/313 [01:37<03:10,  1.10it/s]Computing feature acts:  34%|███▎      | 105/313 [01:38<03:14,  1.07it/s]Computing feature acts:  34%|███▍      | 106/313 [01:39<03:19,  1.04it/s]Computing feature acts:  34%|███▍      | 107/313 [01:40<03:20,  1.03it/s]Computing feature acts:  35%|███▍      | 108/313 [01:41<03:22,  1.01it/s]Computing feature acts:  35%|███▍      | 109/313 [01:42<03:22,  1.01it/s]Computing feature acts:  35%|███▌      | 110/313 [01:43<03:22,  1.00it/s]Computing feature acts:  35%|███▌      | 111/313 [01:44<03:21,  1.00it/s]Computing feature acts:  36%|███▌      | 112/313 [01:45<03:21,  1.00s/it]Computing feature acts:  36%|███▌      | 113/313 [01:46<03:20,  1.00s/it]Computing feature acts:  36%|███▋      | 114/313 [01:47<03:21,  1.01s/it]Computing feature acts:  37%|███▋      | 115/313 [01:48<03:19,  1.01s/it]Computing feature acts:  37%|███▋      | 116/313 [01:49<03:19,  1.01s/it]Computing feature acts:  37%|███▋      | 117/313 [01:50<03:17,  1.01s/it]Computing feature acts:  38%|███▊      | 118/313 [01:51<03:20,  1.03s/it]Computing feature acts:  38%|███▊      | 119/313 [01:52<03:17,  1.02s/it]Computing feature acts:  38%|███▊      | 120/313 [01:53<03:17,  1.03s/it]Computing feature acts:  39%|███▊      | 121/313 [01:54<03:15,  1.02s/it]Computing feature acts:  39%|███▉      | 122/313 [01:55<03:16,  1.03s/it]Computing feature acts:  39%|███▉      | 123/313 [01:56<03:14,  1.02s/it]Computing feature acts:  40%|███▉      | 124/313 [01:57<03:17,  1.05s/it]Computing feature acts:  40%|███▉      | 125/313 [01:58<03:18,  1.05s/it]Computing feature acts:  40%|████      | 126/313 [02:00<03:19,  1.07s/it]Computing feature acts:  41%|████      | 127/313 [02:01<03:19,  1.07s/it]Computing feature acts:  41%|████      | 128/313 [02:02<03:21,  1.09s/it]Computing feature acts:  41%|████      | 129/313 [02:03<03:15,  1.06s/it]Computing feature acts:  42%|████▏     | 130/313 [02:04<03:16,  1.07s/it]Computing feature acts:  42%|████▏     | 131/313 [02:05<03:16,  1.08s/it]Computing feature acts:  42%|████▏     | 132/313 [02:06<03:17,  1.09s/it]Computing feature acts:  42%|████▏     | 133/313 [02:07<03:14,  1.08s/it]Computing feature acts:  43%|████▎     | 134/313 [02:08<03:22,  1.13s/it]Computing feature acts:  43%|████▎     | 135/313 [02:09<03:15,  1.10s/it]Computing feature acts:  43%|████▎     | 136/313 [02:11<03:16,  1.11s/it]Computing feature acts:  44%|████▍     | 137/313 [02:12<03:12,  1.10s/it]Computing feature acts:  44%|████▍     | 138/313 [02:13<03:15,  1.11s/it]Computing feature acts:  44%|████▍     | 139/313 [02:14<03:13,  1.11s/it]Computing feature acts:  45%|████▍     | 140/313 [02:15<03:11,  1.11s/it]Computing feature acts:  45%|████▌     | 141/313 [02:16<03:08,  1.10s/it]Computing feature acts:  45%|████▌     | 142/313 [02:17<03:08,  1.10s/it]Computing feature acts:  46%|████▌     | 143/313 [02:18<03:03,  1.08s/it]Computing feature acts:  46%|████▌     | 144/313 [02:19<03:02,  1.08s/it]Computing feature acts:  46%|████▋     | 145/313 [02:20<02:58,  1.06s/it]Computing feature acts:  47%|████▋     | 146/313 [02:21<02:56,  1.05s/it]Computing feature acts:  47%|████▋     | 147/313 [02:22<02:53,  1.05s/it]Computing feature acts:  47%|████▋     | 148/313 [02:23<02:52,  1.05s/it]Computing feature acts:  48%|████▊     | 149/313 [02:24<02:51,  1.05s/it]Computing feature acts:  48%|████▊     | 150/313 [02:26<02:55,  1.08s/it]Computing feature acts:  48%|████▊     | 151/313 [02:27<02:55,  1.09s/it]Computing feature acts:  49%|████▊     | 152/313 [02:28<02:55,  1.09s/it]Computing feature acts:  49%|████▉     | 153/313 [02:29<02:54,  1.09s/it]Computing feature acts:  49%|████▉     | 154/313 [02:30<02:53,  1.09s/it]Computing feature acts:  50%|████▉     | 155/313 [02:31<02:50,  1.08s/it]Computing feature acts:  50%|████▉     | 156/313 [02:32<02:50,  1.08s/it]Computing feature acts:  50%|█████     | 157/313 [02:33<02:49,  1.09s/it]Computing feature acts:  50%|█████     | 158/313 [02:34<02:50,  1.10s/it]Computing feature acts:  51%|█████     | 159/313 [02:35<02:48,  1.10s/it]Computing feature acts:  51%|█████     | 160/313 [02:37<02:48,  1.10s/it]Computing feature acts:  51%|█████▏    | 161/313 [02:38<02:47,  1.10s/it]Computing feature acts:  52%|█████▏    | 162/313 [02:39<02:45,  1.10s/it]Computing feature acts:  52%|█████▏    | 163/313 [02:40<02:41,  1.08s/it]Computing feature acts:  52%|█████▏    | 164/313 [02:41<02:39,  1.07s/it]Computing feature acts:  53%|█████▎    | 165/313 [02:42<02:36,  1.06s/it]Computing feature acts:  53%|█████▎    | 166/313 [02:43<02:37,  1.07s/it]Computing feature acts:  53%|█████▎    | 167/313 [02:44<02:35,  1.06s/it]Computing feature acts:  54%|█████▎    | 168/313 [02:45<02:34,  1.06s/it]Computing feature acts:  54%|█████▍    | 169/313 [02:46<02:31,  1.06s/it]Computing feature acts:  54%|█████▍    | 170/313 [02:47<02:31,  1.06s/it]Computing feature acts:  55%|█████▍    | 171/313 [02:48<02:29,  1.05s/it]Computing feature acts:  55%|█████▍    | 172/313 [02:49<02:29,  1.06s/it]Computing feature acts:  55%|█████▌    | 173/313 [02:50<02:28,  1.06s/it]Computing feature acts:  56%|█████▌    | 174/313 [02:52<02:32,  1.09s/it]Computing feature acts:  56%|█████▌    | 175/313 [02:53<02:27,  1.07s/it]Computing feature acts:  56%|█████▌    | 176/313 [02:54<02:25,  1.06s/it]Computing feature acts:  57%|█████▋    | 177/313 [02:55<02:22,  1.05s/it]Computing feature acts:  57%|█████▋    | 178/313 [02:56<02:21,  1.05s/it]Computing feature acts:  57%|█████▋    | 179/313 [02:57<02:19,  1.04s/it]Computing feature acts:  58%|█████▊    | 180/313 [02:58<02:19,  1.05s/it]Computing feature acts:  58%|█████▊    | 181/313 [02:59<02:17,  1.04s/it]Computing feature acts:  58%|█████▊    | 182/313 [03:00<02:16,  1.04s/it]Computing feature acts:  58%|█████▊    | 183/313 [03:01<02:14,  1.04s/it]Computing feature acts:  59%|█████▉    | 184/313 [03:02<02:15,  1.05s/it]Computing feature acts:  59%|█████▉    | 185/313 [03:03<02:13,  1.05s/it]Computing feature acts:  59%|█████▉    | 186/313 [03:04<02:13,  1.05s/it]Computing feature acts:  60%|█████▉    | 187/313 [03:05<02:18,  1.10s/it]Computing feature acts:  60%|██████    | 188/313 [03:06<02:16,  1.09s/it]Computing feature acts:  60%|██████    | 189/313 [03:07<02:13,  1.07s/it]Computing feature acts:  61%|██████    | 190/313 [03:08<02:12,  1.07s/it]Computing feature acts:  61%|██████    | 191/313 [03:09<02:09,  1.06s/it]Computing feature acts:  61%|██████▏   | 192/313 [03:10<02:07,  1.06s/it]Computing feature acts:  62%|██████▏   | 193/313 [03:12<02:05,  1.05s/it]Computing feature acts:  62%|██████▏   | 194/313 [03:13<02:04,  1.05s/it]Computing feature acts:  62%|██████▏   | 195/313 [03:14<02:03,  1.04s/it]Computing feature acts:  63%|██████▎   | 196/313 [03:15<02:02,  1.04s/it]Computing feature acts:  63%|██████▎   | 197/313 [03:16<02:00,  1.04s/it]Computing feature acts:  63%|██████▎   | 198/313 [03:17<02:00,  1.04s/it]Computing feature acts:  64%|██████▎   | 199/313 [03:18<01:58,  1.04s/it]Computing feature acts:  64%|██████▍   | 200/313 [03:19<02:02,  1.09s/it]Computing feature acts:  64%|██████▍   | 201/313 [03:20<01:59,  1.07s/it]Computing feature acts:  65%|██████▍   | 202/313 [03:21<01:57,  1.06s/it]Computing feature acts:  65%|██████▍   | 203/313 [03:22<01:55,  1.05s/it]Computing feature acts:  65%|██████▌   | 204/313 [03:23<01:55,  1.06s/it]Computing feature acts:  65%|██████▌   | 205/313 [03:24<01:53,  1.05s/it]Computing feature acts:  66%|██████▌   | 206/313 [03:25<01:52,  1.05s/it]Computing feature acts:  66%|██████▌   | 207/313 [03:26<01:50,  1.05s/it]Computing feature acts:  66%|██████▋   | 208/313 [03:27<01:49,  1.04s/it]Computing feature acts:  67%|██████▋   | 209/313 [03:28<01:48,  1.04s/it]Computing feature acts:  67%|██████▋   | 210/313 [03:29<01:48,  1.05s/it]Computing feature acts:  67%|██████▋   | 211/313 [03:30<01:46,  1.05s/it]Computing feature acts:  68%|██████▊   | 212/313 [03:32<01:46,  1.06s/it]Computing feature acts:  68%|██████▊   | 213/313 [03:33<01:45,  1.05s/it]Computing feature acts:  68%|██████▊   | 214/313 [03:34<01:43,  1.04s/it]Computing feature acts:  69%|██████▊   | 215/313 [03:34<01:37,  1.01it/s]Computing feature acts:  69%|██████▉   | 216/313 [03:35<01:34,  1.03it/s]Computing feature acts:  69%|██████▉   | 217/313 [03:36<01:30,  1.06it/s]Computing feature acts:  70%|██████▉   | 218/313 [03:37<01:29,  1.06it/s]Computing feature acts:  70%|██████▉   | 219/313 [03:38<01:26,  1.08it/s]Computing feature acts:  70%|███████   | 220/313 [03:39<01:26,  1.08it/s]Computing feature acts:  71%|███████   | 221/313 [03:40<01:23,  1.10it/s]Computing feature acts:  71%|███████   | 222/313 [03:41<01:24,  1.07it/s]Computing feature acts:  71%|███████   | 223/313 [03:42<01:24,  1.07it/s]Computing feature acts:  72%|███████▏  | 224/313 [03:43<01:23,  1.06it/s]Computing feature acts:  72%|███████▏  | 225/313 [03:44<01:22,  1.06it/s]Computing feature acts:  72%|███████▏  | 226/313 [03:45<01:23,  1.05it/s]Computing feature acts:  73%|███████▎  | 227/313 [03:46<01:21,  1.05it/s]Computing feature acts:  73%|███████▎  | 228/313 [03:47<01:21,  1.05it/s]Computing feature acts:  73%|███████▎  | 229/313 [03:48<01:19,  1.05it/s]Computing feature acts:  73%|███████▎  | 230/313 [03:48<01:19,  1.05it/s]Computing feature acts:  74%|███████▍  | 231/313 [03:49<01:17,  1.05it/s]Computing feature acts:  74%|███████▍  | 232/313 [03:50<01:17,  1.05it/s]Computing feature acts:  74%|███████▍  | 233/313 [03:51<01:15,  1.05it/s]Computing feature acts:  75%|███████▍  | 234/313 [03:52<01:15,  1.05it/s]Computing feature acts:  75%|███████▌  | 235/313 [03:53<01:14,  1.05it/s]Computing feature acts:  75%|███████▌  | 236/313 [03:54<01:13,  1.05it/s]Computing feature acts:  76%|███████▌  | 237/313 [03:55<01:10,  1.08it/s]Computing feature acts:  76%|███████▌  | 238/313 [03:56<01:09,  1.08it/s]Computing feature acts:  76%|███████▋  | 239/313 [03:57<01:07,  1.10it/s]Computing feature acts:  77%|███████▋  | 240/313 [03:58<01:07,  1.08it/s]Computing feature acts:  77%|███████▋  | 241/313 [03:59<01:05,  1.10it/s]Computing feature acts:  77%|███████▋  | 242/313 [04:00<01:04,  1.10it/s]Computing feature acts:  78%|███████▊  | 243/313 [04:00<01:02,  1.11it/s]Computing feature acts:  78%|███████▊  | 244/313 [04:01<01:01,  1.11it/s]Computing feature acts:  78%|███████▊  | 245/313 [04:02<01:00,  1.12it/s]Computing feature acts:  79%|███████▊  | 246/313 [04:03<01:00,  1.10it/s]Computing feature acts:  79%|███████▉  | 247/313 [04:04<01:00,  1.09it/s]Computing feature acts:  79%|███████▉  | 248/313 [04:05<01:00,  1.07it/s]Computing feature acts:  80%|███████▉  | 249/313 [04:06<00:59,  1.07it/s]Computing feature acts:  80%|███████▉  | 250/313 [04:07<00:59,  1.05it/s]Computing feature acts:  80%|████████  | 251/313 [04:08<00:57,  1.08it/s]Computing feature acts:  81%|████████  | 252/313 [04:09<00:56,  1.08it/s]Computing feature acts:  81%|████████  | 253/313 [04:10<00:55,  1.08it/s]Computing feature acts:  81%|████████  | 254/313 [04:11<00:54,  1.09it/s]Computing feature acts:  81%|████████▏ | 255/313 [04:12<00:52,  1.10it/s]Computing feature acts:  82%|████████▏ | 256/313 [04:12<00:51,  1.10it/s]Computing feature acts:  82%|████████▏ | 257/313 [04:13<00:50,  1.11it/s]Computing feature acts:  82%|████████▏ | 258/313 [04:14<00:49,  1.11it/s]Computing feature acts:  83%|████████▎ | 259/313 [04:15<00:48,  1.12it/s]Computing feature acts:  83%|████████▎ | 260/313 [04:16<00:48,  1.10it/s]Computing feature acts:  83%|████████▎ | 261/313 [04:17<00:46,  1.12it/s]Computing feature acts:  84%|████████▎ | 262/313 [04:18<00:46,  1.09it/s]Computing feature acts:  84%|████████▍ | 263/313 [04:19<00:45,  1.10it/s]Computing feature acts:  84%|████████▍ | 264/313 [04:20<00:46,  1.06it/s]Computing feature acts:  85%|████████▍ | 265/313 [04:21<00:45,  1.06it/s]Computing feature acts:  85%|████████▍ | 266/313 [04:22<00:47,  1.00s/it]Computing feature acts:  85%|████████▌ | 267/313 [04:23<00:44,  1.04it/s]Computing feature acts:  86%|████████▌ | 268/313 [04:24<00:42,  1.05it/s]Computing feature acts:  86%|████████▌ | 269/313 [04:25<00:40,  1.08it/s]Computing feature acts:  86%|████████▋ | 270/313 [04:25<00:40,  1.07it/s]Computing feature acts:  87%|████████▋ | 271/313 [04:26<00:39,  1.07it/s]Computing feature acts:  87%|████████▋ | 272/313 [04:27<00:38,  1.06it/s]Computing feature acts:  87%|████████▋ | 273/313 [04:28<00:37,  1.06it/s]Computing feature acts:  88%|████████▊ | 274/313 [04:29<00:36,  1.06it/s]Computing feature acts:  88%|████████▊ | 275/313 [04:30<00:35,  1.06it/s]Computing feature acts:  88%|████████▊ | 276/313 [04:31<00:35,  1.03it/s]Computing feature acts:  88%|████████▊ | 277/313 [04:32<00:34,  1.04it/s]Computing feature acts:  89%|████████▉ | 278/313 [04:33<00:33,  1.06it/s]Computing feature acts:  89%|████████▉ | 279/313 [04:34<00:31,  1.08it/s]Computing feature acts:  89%|████████▉ | 280/313 [04:35<00:30,  1.08it/s]Computing feature acts:  90%|████████▉ | 281/313 [04:36<00:29,  1.10it/s]Computing feature acts:  90%|█████████ | 282/313 [04:37<00:28,  1.10it/s]Computing feature acts:  90%|█████████ | 283/313 [04:38<00:26,  1.11it/s]Computing feature acts:  91%|█████████ | 284/313 [04:38<00:26,  1.11it/s]Computing feature acts:  91%|█████████ | 285/313 [04:39<00:25,  1.12it/s]Computing feature acts:  91%|█████████▏| 286/313 [04:40<00:24,  1.12it/s]Computing feature acts:  92%|█████████▏| 287/313 [04:41<00:23,  1.13it/s]Computing feature acts:  92%|█████████▏| 288/313 [04:42<00:22,  1.12it/s]Computing feature acts:  92%|█████████▏| 289/313 [04:43<00:22,  1.07it/s]Computing feature acts:  93%|█████████▎| 290/313 [04:44<00:22,  1.02it/s]Computing feature acts:  93%|█████████▎| 291/313 [04:45<00:22,  1.00s/it]Computing feature acts:  93%|█████████▎| 292/313 [04:46<00:21,  1.03s/it]Computing feature acts:  94%|█████████▎| 293/313 [04:47<00:20,  1.03s/it]Computing feature acts:  94%|█████████▍| 294/313 [04:48<00:18,  1.00it/s]Computing feature acts:  94%|█████████▍| 295/313 [04:49<00:17,  1.04it/s]Computing feature acts:  95%|█████████▍| 296/313 [04:50<00:16,  1.05it/s]Computing feature acts:  95%|█████████▍| 297/313 [04:51<00:14,  1.08it/s]Computing feature acts:  95%|█████████▌| 298/313 [04:52<00:14,  1.07it/s]Computing feature acts:  96%|█████████▌| 299/313 [04:53<00:12,  1.09it/s]Computing feature acts:  96%|█████████▌| 300/313 [04:54<00:11,  1.10it/s]Computing feature acts:  96%|█████████▌| 301/313 [04:54<00:10,  1.11it/s]Computing feature acts:  96%|█████████▋| 302/313 [04:55<00:09,  1.12it/s]Computing feature acts:  97%|█████████▋| 303/313 [04:56<00:08,  1.13it/s]Computing feature acts:  97%|█████████▋| 304/313 [04:57<00:07,  1.13it/s]Computing feature acts:  97%|█████████▋| 305/313 [04:58<00:07,  1.14it/s]Computing feature acts:  98%|█████████▊| 306/313 [04:59<00:06,  1.14it/s]Computing feature acts:  98%|█████████▊| 307/313 [05:00<00:05,  1.15it/s]Computing feature acts:  98%|█████████▊| 308/313 [05:01<00:04,  1.14it/s]Computing feature acts:  99%|█████████▊| 309/313 [05:01<00:03,  1.15it/s]Computing feature acts:  99%|█████████▉| 310/313 [05:02<00:02,  1.11it/s]Computing feature acts:  99%|█████████▉| 311/313 [05:03<00:01,  1.11it/s]Computing feature acts: 100%|█████████▉| 312/313 [05:04<00:00,  1.11it/s]Computing feature acts: 100%|██████████| 313/313 [05:05<00:00,  1.11it/s]Computing feature acts: 100%|██████████| 313/313 [05:06<00:00,  1.02it/s]
Parsing activation data:   0%|          | 0/1 [00:00<?, ?it/s]Parsing activation data: 100%|██████████| 1/1 [00:01<00:00,  1.99s/it]Parsing activation data: 100%|██████████| 1/1 [00:01<00:00,  1.99s/it]
2024-04-16 02:33:13 - INFO - Saving HTML feature dashboards for the SAE at blocks.6.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/1 [00:00<?, ?it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  3.78it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  3.78it/s]
2024-04-16 02:33:14 - INFO - Finished.
2024-04-16 02:33:23 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-6_region-3_e2e-zgdpkafo_Random_cluster_in_middle') save_json_data=False sae_positions=None feature_indices=[194, 311, 704, 1784, 2380, 2739, 2956, 4994, 5324, 5921, 6039, 7174, 8811, 8831, 9229, 9493, 9952, 11263, 12026, 12768, 12784, 12842, 13391, 14265, 14701, 16417, 17766, 20227, 20756, 21347, 22067, 22078, 22668, 22711] prompt_centric=None seed=0
2024-04-16 02:33:23 - INFO - Loading the model and SAEs
2024-04-16 02:33:23 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=3.0, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.6.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-16 02:33:35 - INFO - done
2024-04-16 02:33:35 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-6_region-3_e2e-zgdpkafo_Random_cluster_in_middle
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/313 [00:00<?, ?it/s]Computing feature acts:   0%|          | 1/313 [00:01<06:46,  1.30s/it]Computing feature acts:   1%|          | 2/313 [00:02<05:55,  1.14s/it]Computing feature acts:   1%|          | 3/313 [00:03<05:37,  1.09s/it]Computing feature acts:   1%|▏         | 4/313 [00:04<05:29,  1.07s/it]Computing feature acts:   2%|▏         | 5/313 [00:05<05:23,  1.05s/it]Computing feature acts:   2%|▏         | 6/313 [00:06<05:20,  1.04s/it]Computing feature acts:   2%|▏         | 7/313 [00:07<05:19,  1.04s/it]Computing feature acts:   3%|▎         | 8/313 [00:08<05:18,  1.04s/it]Computing feature acts:   3%|▎         | 9/313 [00:09<05:17,  1.04s/it]Computing feature acts:   3%|▎         | 10/313 [00:10<05:16,  1.04s/it]Computing feature acts:   4%|▎         | 11/313 [00:11<05:15,  1.04s/it]Computing feature acts:   4%|▍         | 12/313 [00:12<05:12,  1.04s/it]Computing feature acts:   4%|▍         | 13/313 [00:13<05:11,  1.04s/it]Computing feature acts:   4%|▍         | 14/313 [00:14<05:10,  1.04s/it]Computing feature acts:   5%|▍         | 15/313 [00:15<05:08,  1.04s/it]Computing feature acts:   5%|▌         | 16/313 [00:16<05:08,  1.04s/it]Computing feature acts:   5%|▌         | 17/313 [00:17<05:09,  1.04s/it]Computing feature acts:   6%|▌         | 18/313 [00:18<05:05,  1.04s/it]Computing feature acts:   6%|▌         | 19/313 [00:19<05:05,  1.04s/it]Computing feature acts:   6%|▋         | 20/313 [00:21<05:05,  1.04s/it]Computing feature acts:   7%|▋         | 21/313 [00:22<05:11,  1.07s/it]Computing feature acts:   7%|▋         | 22/313 [00:23<05:15,  1.08s/it]Computing feature acts:   7%|▋         | 23/313 [00:24<05:18,  1.10s/it]Computing feature acts:   8%|▊         | 24/313 [00:25<05:18,  1.10s/it]Computing feature acts:   8%|▊         | 25/313 [00:26<05:18,  1.11s/it]Computing feature acts:   8%|▊         | 26/313 [00:27<05:19,  1.11s/it]Computing feature acts:   9%|▊         | 27/313 [00:28<05:15,  1.10s/it]Computing feature acts:   9%|▉         | 28/313 [00:29<05:11,  1.09s/it]Computing feature acts:   9%|▉         | 29/313 [00:30<05:06,  1.08s/it]Computing feature acts:  10%|▉         | 30/313 [00:31<05:02,  1.07s/it]Computing feature acts:  10%|▉         | 31/313 [00:33<05:18,  1.13s/it]Computing feature acts:  10%|█         | 32/313 [00:34<05:07,  1.10s/it]Computing feature acts:  11%|█         | 33/313 [00:35<05:02,  1.08s/it]Computing feature acts:  11%|█         | 34/313 [00:36<04:57,  1.07s/it]Computing feature acts:  11%|█         | 35/313 [00:37<04:54,  1.06s/it]Computing feature acts:  12%|█▏        | 36/313 [00:38<04:48,  1.04s/it]Computing feature acts:  12%|█▏        | 37/313 [00:39<04:48,  1.04s/it]Computing feature acts:  12%|█▏        | 38/313 [00:40<04:49,  1.05s/it]Computing feature acts:  12%|█▏        | 39/313 [00:41<04:49,  1.06s/it]Computing feature acts:  13%|█▎        | 40/313 [00:42<04:53,  1.08s/it]Computing feature acts:  13%|█▎        | 41/313 [00:43<05:02,  1.11s/it]Computing feature acts:  13%|█▎        | 42/313 [00:44<04:51,  1.08s/it]Computing feature acts:  14%|█▎        | 43/313 [00:45<04:47,  1.06s/it]Computing feature acts:  14%|█▍        | 44/313 [00:46<04:41,  1.05s/it]Computing feature acts:  14%|█▍        | 45/313 [00:47<04:36,  1.03s/it]Computing feature acts:  15%|█▍        | 46/313 [00:48<04:32,  1.02s/it]Computing feature acts:  15%|█▌        | 47/313 [00:49<04:33,  1.03s/it]Computing feature acts:  15%|█▌        | 48/313 [00:50<04:22,  1.01it/s]Computing feature acts:  16%|█▌        | 49/313 [00:51<04:17,  1.02it/s]Computing feature acts:  16%|█▌        | 50/313 [00:52<04:10,  1.05it/s]Computing feature acts:  16%|█▋        | 51/313 [00:53<04:15,  1.03it/s]Computing feature acts:  17%|█▋        | 52/313 [00:54<04:18,  1.01it/s]Computing feature acts:  17%|█▋        | 53/313 [00:55<04:21,  1.01s/it]Computing feature acts:  17%|█▋        | 54/313 [00:56<04:22,  1.01s/it]Computing feature acts:  18%|█▊        | 55/313 [00:57<04:20,  1.01s/it]Computing feature acts:  18%|█▊        | 56/313 [00:58<04:22,  1.02s/it]Computing feature acts:  18%|█▊        | 57/313 [00:59<04:23,  1.03s/it]Computing feature acts:  19%|█▊        | 58/313 [01:00<04:24,  1.04s/it]Computing feature acts:  19%|█▉        | 59/313 [01:02<04:25,  1.05s/it]Computing feature acts:  19%|█▉        | 60/313 [01:03<04:25,  1.05s/it]Computing feature acts:  19%|█▉        | 61/313 [01:04<04:23,  1.04s/it]Computing feature acts:  20%|█▉        | 62/313 [01:05<04:23,  1.05s/it]Computing feature acts:  20%|██        | 63/313 [01:06<04:23,  1.05s/it]Computing feature acts:  20%|██        | 64/313 [01:07<04:19,  1.04s/it]Computing feature acts:  21%|██        | 65/313 [01:08<04:06,  1.01it/s]Computing feature acts:  21%|██        | 66/313 [01:09<03:57,  1.04it/s]Computing feature acts:  21%|██▏       | 67/313 [01:09<03:49,  1.07it/s]Computing feature acts:  22%|██▏       | 68/313 [01:10<03:52,  1.05it/s]Computing feature acts:  22%|██▏       | 69/313 [01:11<03:51,  1.06it/s]Computing feature acts:  22%|██▏       | 70/313 [01:12<03:54,  1.04it/s]Computing feature acts:  23%|██▎       | 71/313 [01:13<04:00,  1.01it/s]Computing feature acts:  23%|██▎       | 72/313 [01:14<03:59,  1.01it/s]Computing feature acts:  23%|██▎       | 73/313 [01:15<04:03,  1.02s/it]Computing feature acts:  24%|██▎       | 74/313 [01:16<04:02,  1.02s/it]Computing feature acts:  24%|██▍       | 75/313 [01:18<04:04,  1.03s/it]Computing feature acts:  24%|██▍       | 76/313 [01:18<03:53,  1.01it/s]Computing feature acts:  25%|██▍       | 77/313 [01:19<03:54,  1.01it/s]Computing feature acts:  25%|██▍       | 78/313 [01:20<03:56,  1.01s/it]Computing feature acts:  25%|██▌       | 79/313 [01:22<03:59,  1.02s/it]Computing feature acts:  26%|██▌       | 80/313 [01:23<04:00,  1.03s/it]Computing feature acts:  26%|██▌       | 81/313 [01:24<03:59,  1.03s/it]Computing feature acts:  26%|██▌       | 82/313 [01:25<04:01,  1.05s/it]Computing feature acts:  27%|██▋       | 83/313 [01:26<04:01,  1.05s/it]Computing feature acts:  27%|██▋       | 84/313 [01:27<04:00,  1.05s/it]Computing feature acts:  27%|██▋       | 85/313 [01:28<04:01,  1.06s/it]Computing feature acts:  27%|██▋       | 86/313 [01:29<04:01,  1.06s/it]Computing feature acts:  28%|██▊       | 87/313 [01:30<04:02,  1.07s/it]Computing feature acts:  28%|██▊       | 88/313 [01:31<04:00,  1.07s/it]Computing feature acts:  28%|██▊       | 89/313 [01:32<03:59,  1.07s/it]Computing feature acts:  29%|██▉       | 90/313 [01:33<03:56,  1.06s/it]Computing feature acts:  29%|██▉       | 91/313 [01:34<03:57,  1.07s/it]Computing feature acts:  29%|██▉       | 92/313 [01:35<03:55,  1.07s/it]Computing feature acts:  30%|██▉       | 93/313 [01:36<03:56,  1.07s/it]Computing feature acts:  30%|███       | 94/313 [01:38<03:53,  1.07s/it]Computing feature acts:  30%|███       | 95/313 [01:38<03:40,  1.01s/it]Computing feature acts:  31%|███       | 96/313 [01:39<03:44,  1.04s/it]Computing feature acts:  31%|███       | 97/313 [01:40<03:37,  1.01s/it]Computing feature acts:  31%|███▏      | 98/313 [01:41<03:34,  1.00it/s]Computing feature acts:  32%|███▏      | 99/313 [01:42<03:28,  1.02it/s]Computing feature acts:  32%|███▏      | 100/313 [01:43<03:24,  1.04it/s]Computing feature acts:  32%|███▏      | 101/313 [01:44<03:21,  1.05it/s]Computing feature acts:  33%|███▎      | 102/313 [01:45<03:18,  1.06it/s]Computing feature acts:  33%|███▎      | 103/313 [01:46<03:18,  1.06it/s]Computing feature acts:  33%|███▎      | 104/313 [01:47<03:16,  1.06it/s]Computing feature acts:  34%|███▎      | 105/313 [01:48<03:15,  1.07it/s]Computing feature acts:  34%|███▍      | 106/313 [01:49<03:15,  1.06it/s]Computing feature acts:  34%|███▍      | 107/313 [01:50<03:13,  1.06it/s]Computing feature acts:  35%|███▍      | 108/313 [01:51<03:13,  1.06it/s]Computing feature acts:  35%|███▍      | 109/313 [01:52<03:14,  1.05it/s]Computing feature acts:  35%|███▌      | 110/313 [01:53<03:15,  1.04it/s]Computing feature acts:  35%|███▌      | 111/313 [01:54<03:15,  1.03it/s]Computing feature acts:  36%|███▌      | 112/313 [01:55<03:18,  1.01it/s]Computing feature acts:  36%|███▌      | 113/313 [01:56<03:25,  1.03s/it]Computing feature acts:  36%|███▋      | 114/313 [01:57<03:25,  1.03s/it]Computing feature acts:  37%|███▋      | 115/313 [01:58<03:26,  1.04s/it]Computing feature acts:  37%|███▋      | 116/313 [01:59<03:26,  1.05s/it]Computing feature acts:  37%|███▋      | 117/313 [02:00<03:25,  1.05s/it]Computing feature acts:  38%|███▊      | 118/313 [02:01<03:24,  1.05s/it]Computing feature acts:  38%|███▊      | 119/313 [02:02<03:24,  1.05s/it]Computing feature acts:  38%|███▊      | 120/313 [02:03<03:18,  1.03s/it]Computing feature acts:  39%|███▊      | 121/313 [02:04<03:19,  1.04s/it]Computing feature acts:  39%|███▉      | 122/313 [02:05<03:14,  1.02s/it]Computing feature acts:  39%|███▉      | 123/313 [02:06<03:10,  1.00s/it]Computing feature acts:  40%|███▉      | 124/313 [02:07<03:03,  1.03it/s]Computing feature acts:  40%|███▉      | 125/313 [02:08<03:00,  1.04it/s]Computing feature acts:  40%|████      | 126/313 [02:09<02:57,  1.05it/s]Computing feature acts:  41%|████      | 127/313 [02:10<02:55,  1.06it/s]Computing feature acts:  41%|████      | 128/313 [02:11<02:54,  1.06it/s]Computing feature acts:  41%|████      | 129/313 [02:12<02:52,  1.06it/s]Computing feature acts:  42%|████▏     | 130/313 [02:13<02:52,  1.06it/s]Computing feature acts:  42%|████▏     | 131/313 [02:14<02:51,  1.06it/s]Computing feature acts:  42%|████▏     | 132/313 [02:15<02:49,  1.07it/s]Computing feature acts:  42%|████▏     | 133/313 [02:15<02:48,  1.07it/s]Computing feature acts:  43%|████▎     | 134/313 [02:16<02:47,  1.07it/s]Computing feature acts:  43%|████▎     | 135/313 [02:17<02:48,  1.06it/s]Computing feature acts:  43%|████▎     | 136/313 [02:18<02:46,  1.06it/s]Computing feature acts:  44%|████▍     | 137/313 [02:19<02:45,  1.06it/s]Computing feature acts:  44%|████▍     | 138/313 [02:20<02:43,  1.07it/s]Computing feature acts:  44%|████▍     | 139/313 [02:21<02:43,  1.06it/s]Computing feature acts:  45%|████▍     | 140/313 [02:22<02:45,  1.05it/s]Computing feature acts:  45%|████▌     | 141/313 [02:23<02:43,  1.05it/s]Computing feature acts:  45%|████▌     | 142/313 [02:24<02:42,  1.05it/s]Computing feature acts:  46%|████▌     | 143/313 [02:25<02:41,  1.05it/s]Computing feature acts:  46%|████▌     | 144/313 [02:26<02:39,  1.06it/s]Computing feature acts:  46%|████▋     | 145/313 [02:27<02:39,  1.05it/s]Computing feature acts:  47%|████▋     | 146/313 [02:28<02:39,  1.05it/s]Computing feature acts:  47%|████▋     | 147/313 [02:29<02:38,  1.04it/s]Computing feature acts:  47%|████▋     | 148/313 [02:30<02:38,  1.04it/s]Computing feature acts:  48%|████▊     | 149/313 [02:31<02:36,  1.05it/s]Computing feature acts:  48%|████▊     | 150/313 [02:32<02:35,  1.05it/s]Computing feature acts:  48%|████▊     | 151/313 [02:33<02:37,  1.03it/s]Computing feature acts:  49%|████▊     | 152/313 [02:34<02:36,  1.03it/s]Computing feature acts:  49%|████▉     | 153/313 [02:35<02:36,  1.02it/s]Computing feature acts:  49%|████▉     | 154/313 [02:36<02:33,  1.04it/s]Computing feature acts:  50%|████▉     | 155/313 [02:36<02:31,  1.05it/s]Computing feature acts:  50%|████▉     | 156/313 [02:37<02:29,  1.05it/s]Computing feature acts:  50%|█████     | 157/313 [02:38<02:27,  1.06it/s]Computing feature acts:  50%|█████     | 158/313 [02:39<02:25,  1.06it/s]Computing feature acts:  51%|█████     | 159/313 [02:40<02:24,  1.06it/s]Computing feature acts:  51%|█████     | 160/313 [02:41<02:23,  1.07it/s]Computing feature acts:  51%|█████▏    | 161/313 [02:42<02:29,  1.02it/s]Computing feature acts:  52%|█████▏    | 162/313 [02:43<02:29,  1.01it/s]Computing feature acts:  52%|█████▏    | 163/313 [02:44<02:24,  1.04it/s]Computing feature acts:  52%|█████▏    | 164/313 [02:45<02:22,  1.05it/s]Computing feature acts:  53%|█████▎    | 165/313 [02:46<02:20,  1.05it/s]Computing feature acts:  53%|█████▎    | 166/313 [02:47<02:17,  1.07it/s]Computing feature acts:  53%|█████▎    | 167/313 [02:48<02:18,  1.06it/s]Computing feature acts:  54%|█████▎    | 168/313 [02:49<02:18,  1.05it/s]Computing feature acts:  54%|█████▍    | 169/313 [02:50<02:16,  1.06it/s]Computing feature acts:  54%|█████▍    | 170/313 [02:51<02:14,  1.06it/s]Computing feature acts:  55%|█████▍    | 171/313 [02:52<02:15,  1.05it/s]Computing feature acts:  55%|█████▍    | 172/313 [02:53<02:15,  1.04it/s]Computing feature acts:  55%|█████▌    | 173/313 [02:54<02:16,  1.02it/s]Computing feature acts:  56%|█████▌    | 174/313 [02:55<02:16,  1.02it/s]Computing feature acts:  56%|█████▌    | 175/313 [02:56<02:16,  1.01it/s]Computing feature acts:  56%|█████▌    | 176/313 [02:57<02:16,  1.01it/s]Computing feature acts:  57%|█████▋    | 177/313 [02:58<02:15,  1.00it/s]Computing feature acts:  57%|█████▋    | 178/313 [02:59<02:14,  1.00it/s]Computing feature acts:  57%|█████▋    | 179/313 [03:00<02:14,  1.00s/it]Computing feature acts:  58%|█████▊    | 180/313 [03:01<02:13,  1.00s/it]Computing feature acts:  58%|█████▊    | 181/313 [03:02<02:11,  1.00it/s]Computing feature acts:  58%|█████▊    | 182/313 [03:03<02:11,  1.00s/it]Computing feature acts:  58%|█████▊    | 183/313 [03:04<02:10,  1.01s/it]Computing feature acts:  59%|█████▉    | 184/313 [03:05<02:10,  1.01s/it]Computing feature acts:  59%|█████▉    | 185/313 [03:06<02:08,  1.00s/it]Computing feature acts:  59%|█████▉    | 186/313 [03:07<02:07,  1.00s/it]Computing feature acts:  60%|█████▉    | 187/313 [03:08<02:10,  1.03s/it]Computing feature acts:  60%|██████    | 188/313 [03:09<02:07,  1.02s/it]Computing feature acts:  60%|██████    | 189/313 [03:10<02:07,  1.03s/it]Computing feature acts:  61%|██████    | 190/313 [03:11<02:07,  1.04s/it]Computing feature acts:  61%|██████    | 191/313 [03:12<02:07,  1.04s/it]Computing feature acts:  61%|██████▏   | 192/313 [03:13<02:08,  1.06s/it]Computing feature acts:  62%|██████▏   | 193/313 [03:14<02:09,  1.08s/it]Computing feature acts:  62%|██████▏   | 194/313 [03:15<02:08,  1.08s/it]Computing feature acts:  62%|██████▏   | 195/313 [03:16<02:08,  1.09s/it]Computing feature acts:  63%|██████▎   | 196/313 [03:18<02:06,  1.08s/it]Computing feature acts:  63%|██████▎   | 197/313 [03:19<02:05,  1.08s/it]Computing feature acts:  63%|██████▎   | 198/313 [03:20<02:00,  1.05s/it]Computing feature acts:  64%|██████▎   | 199/313 [03:21<01:58,  1.04s/it]Computing feature acts:  64%|██████▍   | 200/313 [03:22<01:55,  1.02s/it]Computing feature acts:  64%|██████▍   | 201/313 [03:23<01:52,  1.01s/it]Computing feature acts:  65%|██████▍   | 202/313 [03:24<01:53,  1.02s/it]Computing feature acts:  65%|██████▍   | 203/313 [03:25<01:51,  1.02s/it]Computing feature acts:  65%|██████▌   | 204/313 [03:26<01:48,  1.00it/s]Computing feature acts:  65%|██████▌   | 205/313 [03:27<01:47,  1.01it/s]Computing feature acts:  66%|██████▌   | 206/313 [03:27<01:44,  1.02it/s]Computing feature acts:  66%|██████▌   | 207/313 [03:28<01:43,  1.03it/s]Computing feature acts:  66%|██████▋   | 208/313 [03:29<01:40,  1.04it/s]Computing feature acts:  67%|██████▋   | 209/313 [03:30<01:42,  1.02it/s]Computing feature acts:  67%|██████▋   | 210/313 [03:31<01:43,  1.00s/it]Computing feature acts:  67%|██████▋   | 211/313 [03:32<01:42,  1.01s/it]Computing feature acts:  68%|██████▊   | 212/313 [03:33<01:41,  1.00s/it]Computing feature acts:  68%|██████▊   | 213/313 [03:34<01:40,  1.01s/it]Computing feature acts:  68%|██████▊   | 214/313 [03:35<01:39,  1.00s/it]Computing feature acts:  69%|██████▊   | 215/313 [03:36<01:35,  1.02it/s]Computing feature acts:  69%|██████▉   | 216/313 [03:37<01:35,  1.02it/s]Computing feature acts:  69%|██████▉   | 217/313 [03:38<01:34,  1.02it/s]Computing feature acts:  70%|██████▉   | 218/313 [03:39<01:33,  1.02it/s]Computing feature acts:  70%|██████▉   | 219/313 [03:40<01:31,  1.02it/s]Computing feature acts:  70%|███████   | 220/313 [03:41<01:32,  1.00it/s]Computing feature acts:  71%|███████   | 221/313 [03:42<01:33,  1.02s/it]Computing feature acts:  71%|███████   | 222/313 [03:43<01:33,  1.02s/it]Computing feature acts:  71%|███████   | 223/313 [03:45<01:32,  1.03s/it]Computing feature acts:  72%|███████▏  | 224/313 [03:46<01:32,  1.04s/it]Computing feature acts:  72%|███████▏  | 225/313 [03:47<01:30,  1.03s/it]Computing feature acts:  72%|███████▏  | 226/313 [03:48<01:28,  1.01s/it]Computing feature acts:  73%|███████▎  | 227/313 [03:49<01:29,  1.04s/it]Computing feature acts:  73%|███████▎  | 228/313 [03:50<01:25,  1.01s/it]Computing feature acts:  73%|███████▎  | 229/313 [03:51<01:22,  1.01it/s]Computing feature acts:  73%|███████▎  | 230/313 [03:52<01:22,  1.00it/s]Computing feature acts:  74%|███████▍  | 231/313 [03:53<01:22,  1.00s/it]Computing feature acts:  74%|███████▍  | 232/313 [03:54<01:21,  1.00s/it]Computing feature acts:  74%|███████▍  | 233/313 [03:55<01:20,  1.00s/it]Computing feature acts:  75%|███████▍  | 234/313 [03:56<01:19,  1.00s/it]Computing feature acts:  75%|███████▌  | 235/313 [03:57<01:18,  1.01s/it]Computing feature acts:  75%|███████▌  | 236/313 [03:58<01:17,  1.01s/it]Computing feature acts:  76%|███████▌  | 237/313 [03:58<01:13,  1.03it/s]Computing feature acts:  76%|███████▌  | 238/313 [03:59<01:11,  1.04it/s]Computing feature acts:  76%|███████▋  | 239/313 [04:00<01:10,  1.04it/s]Computing feature acts:  77%|███████▋  | 240/313 [04:01<01:09,  1.05it/s]Computing feature acts:  77%|███████▋  | 241/313 [04:02<01:08,  1.05it/s]Computing feature acts:  77%|███████▋  | 242/313 [04:03<01:07,  1.06it/s]Computing feature acts:  78%|███████▊  | 243/313 [04:04<01:04,  1.08it/s]Computing feature acts:  78%|███████▊  | 244/313 [04:05<01:04,  1.07it/s]Computing feature acts:  78%|███████▊  | 245/313 [04:06<01:04,  1.05it/s]Computing feature acts:  79%|███████▊  | 246/313 [04:07<01:04,  1.04it/s]Computing feature acts:  79%|███████▉  | 247/313 [04:08<01:04,  1.02it/s]Computing feature acts:  79%|███████▉  | 248/313 [04:09<01:04,  1.01it/s]Computing feature acts:  80%|███████▉  | 249/313 [04:10<01:02,  1.03it/s]Computing feature acts:  80%|███████▉  | 250/313 [04:11<01:01,  1.03it/s]Computing feature acts:  80%|████████  | 251/313 [04:12<01:01,  1.02it/s]Computing feature acts:  81%|████████  | 252/313 [04:13<01:00,  1.01it/s]Computing feature acts:  81%|████████  | 253/313 [04:14<00:59,  1.01it/s]Computing feature acts:  81%|████████  | 254/313 [04:15<00:58,  1.01it/s]Computing feature acts:  81%|████████▏ | 255/313 [04:16<00:56,  1.03it/s]Computing feature acts:  82%|████████▏ | 256/313 [04:17<00:56,  1.01it/s]Computing feature acts:  82%|████████▏ | 257/313 [04:18<00:56,  1.01s/it]Computing feature acts:  82%|████████▏ | 258/313 [04:19<00:54,  1.00it/s]Computing feature acts:  83%|████████▎ | 259/313 [04:20<00:53,  1.01it/s]Computing feature acts:  83%|████████▎ | 260/313 [04:21<00:51,  1.02it/s]Computing feature acts:  83%|████████▎ | 261/313 [04:22<00:49,  1.05it/s]Computing feature acts:  84%|████████▎ | 262/313 [04:23<00:48,  1.06it/s]Computing feature acts:  84%|████████▍ | 263/313 [04:24<00:46,  1.08it/s]Computing feature acts:  84%|████████▍ | 264/313 [04:24<00:45,  1.08it/s]Computing feature acts:  85%|████████▍ | 265/313 [04:25<00:44,  1.09it/s]Computing feature acts:  85%|████████▍ | 266/313 [04:26<00:43,  1.08it/s]Computing feature acts:  85%|████████▌ | 267/313 [04:27<00:42,  1.08it/s]Computing feature acts:  86%|████████▌ | 268/313 [04:28<00:41,  1.08it/s]Computing feature acts:  86%|████████▌ | 269/313 [04:29<00:40,  1.09it/s]Computing feature acts:  86%|████████▋ | 270/313 [04:30<00:39,  1.09it/s]Computing feature acts:  87%|████████▋ | 271/313 [04:31<00:38,  1.09it/s]Computing feature acts:  87%|████████▋ | 272/313 [04:32<00:37,  1.09it/s]Computing feature acts:  87%|████████▋ | 273/313 [04:33<00:36,  1.08it/s]Computing feature acts:  88%|████████▊ | 274/313 [04:34<00:35,  1.08it/s]Computing feature acts:  88%|████████▊ | 275/313 [04:35<00:35,  1.08it/s]Computing feature acts:  88%|████████▊ | 276/313 [04:36<00:34,  1.06it/s]Computing feature acts:  88%|████████▊ | 277/313 [04:37<00:34,  1.05it/s]Computing feature acts:  89%|████████▉ | 278/313 [04:38<00:33,  1.04it/s]Computing feature acts:  89%|████████▉ | 279/313 [04:39<00:32,  1.03it/s]Computing feature acts:  89%|████████▉ | 280/313 [04:40<00:32,  1.02it/s]Computing feature acts:  90%|████████▉ | 281/313 [04:40<00:31,  1.02it/s]Computing feature acts:  90%|█████████ | 282/313 [04:42<00:30,  1.01it/s]Computing feature acts:  90%|█████████ | 283/313 [04:43<00:30,  1.01s/it]Computing feature acts:  91%|█████████ | 284/313 [04:44<00:29,  1.02s/it]Computing feature acts:  91%|█████████ | 285/313 [04:45<00:28,  1.02s/it]Computing feature acts:  91%|█████████▏| 286/313 [04:46<00:27,  1.02s/it]Computing feature acts:  92%|█████████▏| 287/313 [04:47<00:26,  1.02s/it]Computing feature acts:  92%|█████████▏| 288/313 [04:48<00:25,  1.04s/it]Computing feature acts:  92%|█████████▏| 289/313 [04:49<00:25,  1.05s/it]Computing feature acts:  93%|█████████▎| 290/313 [04:50<00:24,  1.05s/it]Computing feature acts:  93%|█████████▎| 291/313 [04:51<00:22,  1.04s/it]Computing feature acts:  93%|█████████▎| 292/313 [04:52<00:22,  1.05s/it]Computing feature acts:  94%|█████████▎| 293/313 [04:53<00:22,  1.11s/it]Computing feature acts:  94%|█████████▍| 294/313 [04:54<00:20,  1.09s/it]Computing feature acts:  94%|█████████▍| 295/313 [04:55<00:19,  1.08s/it]Computing feature acts:  95%|█████████▍| 296/313 [04:56<00:18,  1.07s/it]Computing feature acts:  95%|█████████▍| 297/313 [04:57<00:16,  1.06s/it]Computing feature acts:  95%|█████████▌| 298/313 [04:58<00:15,  1.06s/it]Computing feature acts:  96%|█████████▌| 299/313 [04:59<00:14,  1.05s/it]Computing feature acts:  96%|█████████▌| 300/313 [05:01<00:13,  1.04s/it]Computing feature acts:  96%|█████████▌| 301/313 [05:02<00:12,  1.04s/it]Computing feature acts:  96%|█████████▋| 302/313 [05:03<00:11,  1.04s/it]Computing feature acts:  97%|█████████▋| 303/313 [05:04<00:10,  1.04s/it]Computing feature acts:  97%|█████████▋| 304/313 [05:05<00:09,  1.04s/it]Computing feature acts:  97%|█████████▋| 305/313 [05:06<00:08,  1.05s/it]Computing feature acts:  98%|█████████▊| 306/313 [05:07<00:07,  1.06s/it]Computing feature acts:  98%|█████████▊| 307/313 [05:08<00:06,  1.06s/it]Computing feature acts:  98%|█████████▊| 308/313 [05:09<00:05,  1.06s/it]Computing feature acts:  99%|█████████▊| 309/313 [05:10<00:04,  1.07s/it]Computing feature acts:  99%|█████████▉| 310/313 [05:11<00:03,  1.07s/it]Computing feature acts:  99%|█████████▉| 311/313 [05:12<00:02,  1.07s/it]Computing feature acts: 100%|█████████▉| 312/313 [05:13<00:01,  1.07s/it]Computing feature acts: 100%|██████████| 313/313 [05:14<00:00,  1.07s/it]Computing feature acts: 100%|██████████| 313/313 [05:15<00:00,  1.01s/it]
Parsing activation data:   0%|          | 0/1 [00:00<?, ?it/s]Parsing activation data: 100%|██████████| 1/1 [00:05<00:00,  5.30s/it]Parsing activation data: 100%|██████████| 1/1 [00:05<00:00,  5.30s/it]
2024-04-16 02:39:09 - INFO - Saving HTML feature dashboards for the SAE at blocks.6.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/1 [00:00<?, ?it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  1.21it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  1.21it/s]
2024-04-16 02:39:10 - INFO - Finished.
2024-04-16 02:39:10 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-6_region-3_local-1jy3m5j0_Random_cluster_in_middle') save_json_data=False sae_positions=None feature_indices=[22802, 23137, 23222, 23965, 24074, 24396, 24474, 24659, 24773, 24848, 25548, 25717, 26194, 26279, 26455, 26565, 27169, 28522, 29045, 29108, 29346, 29357, 29382, 29856, 30185, 30775, 30791, 30826, 31184, 31292, 31706, 31944, 31963, 31983, 32358, 32363, 32766, 33082, 33406, 33444, 33773, 33912, 34090, 34205, 34451, 34541, 35319, 35884, 36578, 36736, 37349, 37688, 38082, 38501, 38802, 38804, 39008, 39133, 39526, 39554, 39747, 39872, 39949, 40215, 41237, 41247, 41305, 41420, 41661, 42002, 42654, 43012, 43050, 43234, 43281, 43435, 43950, 44122, 44189, 44739, 45470, 45653, 46551, 46621, 46708, 46815, 46926, 46965, 47095, 47172, 47179, 47712, 47749, 47795, 47892, 47924, 48295, 48312] prompt_centric=None seed=0
2024-04-16 02:39:10 - INFO - Loading the model and SAEs
2024-04-16 02:39:10 - INFO - wandb_project='gpt2-layerwise_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/mnt/ssd-interp/dan/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=40000 eval_n_samples=500 batch_size=8 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=4.0, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=1.0), logits_kl=None) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.6.hook_resid_pre'])
2024-04-16 02:39:21 - INFO - done
2024-04-16 02:39:21 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-6_region-3_local-1jy3m5j0_Random_cluster_in_middle
run_sae_path = /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Traceback (most recent call last):
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 51, in <module>
    fire.Fire(main)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 48, in main
    generate_dashboards(dashbaords_config, run_sae_path)
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 1005, in main
    generate_dashboards(model, dashboards_config, save_dir=save_dir)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 852, in generate_dashboards
    dashboards_data: dict[str, SaeVisData] = get_dashboards_data(
                                             ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 385, in get_dashboards_data
    assert (
AssertionError: Error: Some feature indices are greater than the number of SAE features
2024-04-16 02:39:28 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-1.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_8crnit9h/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-1.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_8crnit9h/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-10_region-0_e2e-8crnit9h_Blue_cluster_in_middle') save_json_data=False sae_positions=None feature_indices=[75, 165, 331, 379, 417, 753, 776, 946, 1120, 1177, 1362, 1368, 1395, 1569, 1599, 1621, 1643, 1706, 1818, 1979, 1988, 2022, 2072, 2290, 2338, 2358, 2450, 2503, 2506, 2539, 2567, 2594, 2901, 3030, 3093, 3170, 3186, 3378, 3411, 3501, 3576, 3710, 3777, 3794, 3881, 4068, 4371, 4411, 4446, 4546, 4885, 5031, 5088, 5214, 5494, 5580, 5829, 5896, 5957, 6094, 6220, 6305, 6467, 7071, 7152, 7271, 8449, 8541, 8757, 8775, 9054, 9159, 9985, 10108, 10208, 10300, 10301, 10607, 11037, 11100, 11158, 11547, 11568, 11790, 12298, 12313, 12457, 12696, 12764, 12813, 12818, 12887, 12890, 13053, 13106, 13380, 13507, 13534, 13571, 13697, 13760, 14043, 14108, 14298, 14333, 14509, 14554, 14656, 14671, 14689, 14924, 14979, 15058, 15137, 15195, 15350, 15397, 15402, 15703, 16216, 16243, 16291, 16436, 16490, 16523, 16526, 16527, 16568, 16575, 16602, 16642, 16680, 16745, 16756, 16780, 16789, 16793, 16797, 16808, 16854, 16884, 16910, 16980, 17243, 17344, 17346, 17415, 17416, 17438, 17500, 17512, 17694, 17700, 17725, 17781, 17805, 17832, 17882, 17968, 18088, 18144, 18182, 18227, 18238, 18296, 18421, 18429, 18473, 18546, 18605, 18779, 18921, 18974, 18976, 19043, 19080, 19089, 19199, 19230, 19292, 19315, 19426, 19568, 19643, 19652, 19708, 19712, 19805, 19883, 19906, 19922, 19930, 19933, 19958, 20012, 20064, 20106, 20151, 20188, 20243, 20267, 20269, 20350, 20352, 20353, 20390, 20547, 20554, 20734, 20771, 20794, 20918, 21029, 21208, 21295, 21333, 21398, 21586, 21852, 21937, 21970, 22163, 22176, 22181, 22186, 22257, 22280, 22287, 22320, 22325, 22345, 22358, 22367, 22400, 22416, 22462, 22516, 22538, 22552, 22623, 22641, 22643, 22660, 22892, 22916, 23119, 23146, 23220, 23253, 23267, 23283, 23308, 23455, 23468, 23566, 23599, 23703, 23704, 23769, 23776, 23896, 23915, 23947, 23949, 24001, 24016, 24187, 24328, 24336, 24464, 24623, 24735, 24751, 24779, 24806, 25023, 25032, 25042, 25166, 25219, 25223] prompt_centric=None seed=0
2024-04-16 02:39:28 - INFO - Loading the model and SAEs
2024-04-16 02:39:28 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=1.5, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.10.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-16 02:39:41 - INFO - done
2024-04-16 02:39:41 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-10_region-0_e2e-8crnit9h_Blue_cluster_in_middle
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-1.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_8crnit9h/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/313 [00:00<?, ?it/s]Computing feature acts:   0%|          | 1/313 [00:01<06:28,  1.24s/it]Computing feature acts:   1%|          | 2/313 [00:02<05:28,  1.06s/it]Computing feature acts:   1%|          | 3/313 [00:03<05:20,  1.03s/it]Computing feature acts:   1%|▏         | 4/313 [00:04<05:10,  1.01s/it]Computing feature acts:   2%|▏         | 5/313 [00:05<05:06,  1.01it/s]Computing feature acts:   2%|▏         | 6/313 [00:06<05:03,  1.01it/s]Computing feature acts:   2%|▏         | 7/313 [00:07<05:01,  1.02it/s]Computing feature acts:   3%|▎         | 8/313 [00:08<05:03,  1.00it/s]Computing feature acts:   3%|▎         | 9/313 [00:09<04:55,  1.03it/s]Computing feature acts:   3%|▎         | 10/313 [00:10<05:00,  1.01it/s]Computing feature acts:   4%|▎         | 11/313 [00:11<05:01,  1.00it/s]Computing feature acts:   4%|▍         | 12/313 [00:12<05:05,  1.01s/it]Computing feature acts:   4%|▍         | 13/313 [00:13<05:04,  1.01s/it]Computing feature acts:   4%|▍         | 14/313 [00:14<05:03,  1.02s/it]Computing feature acts:   5%|▍         | 15/313 [00:15<05:04,  1.02s/it]Computing feature acts:   5%|▌         | 16/313 [00:16<05:04,  1.03s/it]Computing feature acts:   5%|▌         | 17/313 [00:17<05:03,  1.03s/it]Computing feature acts:   6%|▌         | 18/313 [00:18<05:03,  1.03s/it]Computing feature acts:   6%|▌         | 19/313 [00:19<05:01,  1.03s/it]Computing feature acts:   6%|▋         | 20/313 [00:20<05:02,  1.03s/it]Computing feature acts:   7%|▋         | 21/313 [00:21<05:02,  1.03s/it]Computing feature acts:   7%|▋         | 22/313 [00:22<05:07,  1.06s/it]Computing feature acts:   7%|▋         | 23/313 [00:23<04:58,  1.03s/it]Computing feature acts:   8%|▊         | 24/313 [00:24<04:53,  1.02s/it]Computing feature acts:   8%|▊         | 25/313 [00:25<04:53,  1.02s/it]Computing feature acts:   8%|▊         | 26/313 [00:26<04:54,  1.02s/it]Computing feature acts:   9%|▊         | 27/313 [00:27<04:45,  1.00it/s]Computing feature acts:   9%|▉         | 28/313 [00:28<04:41,  1.01it/s]Computing feature acts:   9%|▉         | 29/313 [00:29<04:38,  1.02it/s]Computing feature acts:  10%|▉         | 30/313 [00:30<04:37,  1.02it/s]Computing feature acts:  10%|▉         | 31/313 [00:31<04:52,  1.04s/it]Computing feature acts:  10%|█         | 32/313 [00:32<04:52,  1.04s/it]Computing feature acts:  11%|█         | 33/313 [00:33<04:47,  1.03s/it]Computing feature acts:  11%|█         | 34/313 [00:34<04:50,  1.04s/it]Computing feature acts:  11%|█         | 35/313 [00:35<04:56,  1.07s/it]Computing feature acts:  12%|█▏        | 36/313 [00:36<04:54,  1.06s/it]Computing feature acts:  12%|█▏        | 37/313 [00:37<04:55,  1.07s/it]Computing feature acts:  12%|█▏        | 38/313 [00:38<04:41,  1.02s/it]Computing feature acts:  12%|█▏        | 39/313 [00:39<04:33,  1.00it/s]Computing feature acts:  13%|█▎        | 40/313 [00:40<04:28,  1.02it/s]Computing feature acts:  13%|█▎        | 41/313 [00:41<04:26,  1.02it/s]Computing feature acts:  13%|█▎        | 42/313 [00:42<04:22,  1.03it/s]Computing feature acts:  14%|█▎        | 43/313 [00:43<04:15,  1.06it/s]Computing feature acts:  14%|█▍        | 44/313 [00:44<04:13,  1.06it/s]Computing feature acts:  14%|█▍        | 45/313 [00:45<04:11,  1.07it/s]Computing feature acts:  15%|█▍        | 46/313 [00:46<04:11,  1.06it/s]Computing feature acts:  15%|█▌        | 47/313 [00:47<04:18,  1.03it/s]Computing feature acts:  15%|█▌        | 48/313 [00:48<04:22,  1.01it/s]Computing feature acts:  16%|█▌        | 49/313 [00:49<04:25,  1.01s/it]Computing feature acts:  16%|█▌        | 50/313 [00:50<04:28,  1.02s/it]Computing feature acts:  16%|█▋        | 51/313 [00:51<04:23,  1.01s/it]Computing feature acts:  17%|█▋        | 52/313 [00:52<04:20,  1.00it/s]Computing feature acts:  17%|█▋        | 53/313 [00:53<04:09,  1.04it/s]Computing feature acts:  17%|█▋        | 54/313 [00:54<04:04,  1.06it/s]Computing feature acts:  18%|█▊        | 55/313 [00:55<04:06,  1.05it/s]Computing feature acts:  18%|█▊        | 56/313 [00:56<04:06,  1.04it/s]Computing feature acts:  18%|█▊        | 57/313 [00:57<04:07,  1.03it/s]Computing feature acts:  19%|█▊        | 58/313 [00:58<04:07,  1.03it/s]Computing feature acts:  19%|█▉        | 59/313 [00:59<04:03,  1.04it/s]Computing feature acts:  19%|█▉        | 60/313 [01:00<04:01,  1.05it/s]Computing feature acts:  19%|█▉        | 61/313 [01:01<04:11,  1.00it/s]Computing feature acts:  20%|█▉        | 62/313 [01:02<04:08,  1.01it/s]Computing feature acts:  20%|██        | 63/313 [01:03<04:11,  1.00s/it]Computing feature acts:  20%|██        | 64/313 [01:04<04:08,  1.00it/s]Computing feature acts:  21%|██        | 65/313 [01:05<03:59,  1.04it/s]Computing feature acts:  21%|██        | 66/313 [01:06<04:01,  1.02it/s]Computing feature acts:  21%|██▏       | 67/313 [01:07<04:10,  1.02s/it]Computing feature acts:  22%|██▏       | 68/313 [01:08<04:15,  1.04s/it]Computing feature acts:  22%|██▏       | 69/313 [01:09<04:19,  1.06s/it]Computing feature acts:  22%|██▏       | 70/313 [01:10<04:17,  1.06s/it]Computing feature acts:  23%|██▎       | 71/313 [01:11<04:17,  1.06s/it]Computing feature acts:  23%|██▎       | 72/313 [01:12<04:15,  1.06s/it]Computing feature acts:  23%|██▎       | 73/313 [01:13<04:12,  1.05s/it]Computing feature acts:  24%|██▎       | 74/313 [01:14<04:15,  1.07s/it]Computing feature acts:  24%|██▍       | 75/313 [01:15<04:02,  1.02s/it]Computing feature acts:  24%|██▍       | 76/313 [01:16<03:58,  1.00s/it]Computing feature acts:  25%|██▍       | 77/313 [01:17<03:48,  1.03it/s]Computing feature acts:  25%|██▍       | 78/313 [01:18<03:42,  1.06it/s]Computing feature acts:  25%|██▌       | 79/313 [01:19<03:42,  1.05it/s]Computing feature acts:  26%|██▌       | 80/313 [01:20<03:47,  1.03it/s]Computing feature acts:  26%|██▌       | 81/313 [01:21<03:46,  1.02it/s]Computing feature acts:  26%|██▌       | 82/313 [01:22<03:44,  1.03it/s]Computing feature acts:  27%|██▋       | 83/313 [01:23<03:41,  1.04it/s]Computing feature acts:  27%|██▋       | 84/313 [01:24<03:35,  1.06it/s]Computing feature acts:  27%|██▋       | 85/313 [01:25<03:38,  1.04it/s]Computing feature acts:  27%|██▋       | 86/313 [01:26<03:40,  1.03it/s]Computing feature acts:  28%|██▊       | 87/313 [01:27<03:40,  1.03it/s]Computing feature acts:  28%|██▊       | 88/313 [01:28<03:39,  1.03it/s]Computing feature acts:  28%|██▊       | 89/313 [01:29<03:38,  1.03it/s]Computing feature acts:  29%|██▉       | 90/313 [01:29<03:37,  1.03it/s]Computing feature acts:  29%|██▉       | 91/313 [01:30<03:37,  1.02it/s]Computing feature acts:  29%|██▉       | 92/313 [01:31<03:34,  1.03it/s]Computing feature acts:  30%|██▉       | 93/313 [01:32<03:32,  1.04it/s]Computing feature acts:  30%|███       | 94/313 [01:33<03:29,  1.04it/s]Computing feature acts:  30%|███       | 95/313 [01:34<03:28,  1.05it/s]Computing feature acts:  31%|███       | 96/313 [01:35<03:41,  1.02s/it]Computing feature acts:  31%|███       | 97/313 [01:36<03:37,  1.01s/it]Computing feature acts:  31%|███▏      | 98/313 [01:37<03:36,  1.01s/it]Computing feature acts:  32%|███▏      | 99/313 [01:38<03:33,  1.00it/s]Computing feature acts:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s]Computing feature acts:  32%|███▏      | 101/313 [01:40<03:23,  1.04it/s]Computing feature acts:  33%|███▎      | 102/313 [01:41<03:26,  1.02it/s]Computing feature acts:  33%|███▎      | 103/313 [01:42<03:25,  1.02it/s]Computing feature acts:  33%|███▎      | 104/313 [01:43<03:23,  1.03it/s]Computing feature acts:  34%|███▎      | 105/313 [01:44<03:22,  1.03it/s]Computing feature acts:  34%|███▍      | 106/313 [01:45<03:21,  1.03it/s]Computing feature acts:  34%|███▍      | 107/313 [01:46<03:21,  1.02it/s]Computing feature acts:  35%|███▍      | 108/313 [01:47<03:19,  1.03it/s]Computing feature acts:  35%|███▍      | 109/313 [01:48<03:16,  1.04it/s]Computing feature acts:  35%|███▌      | 110/313 [01:49<03:13,  1.05it/s]Computing feature acts:  35%|███▌      | 111/313 [01:50<03:11,  1.05it/s]Computing feature acts:  36%|███▌      | 112/313 [01:51<03:08,  1.07it/s]Computing feature acts:  36%|███▌      | 113/313 [01:52<03:08,  1.06it/s]Computing feature acts:  36%|███▋      | 114/313 [01:53<03:06,  1.07it/s]Computing feature acts:  37%|███▋      | 115/313 [01:54<03:06,  1.06it/s]Computing feature acts:  37%|███▋      | 116/313 [01:55<03:06,  1.05it/s]Computing feature acts:  37%|███▋      | 117/313 [01:56<03:06,  1.05it/s]Computing feature acts:  38%|███▊      | 118/313 [01:57<03:05,  1.05it/s]Computing feature acts:  38%|███▊      | 119/313 [01:57<03:01,  1.07it/s]Computing feature acts:  38%|███▊      | 120/313 [01:58<03:02,  1.06it/s]Computing feature acts:  39%|███▊      | 121/313 [01:59<03:06,  1.03it/s]Computing feature acts:  39%|███▉      | 122/313 [02:00<03:09,  1.01it/s]Computing feature acts:  39%|███▉      | 123/313 [02:02<03:14,  1.02s/it]Computing feature acts:  40%|███▉      | 124/313 [02:03<03:22,  1.07s/it]Computing feature acts:  40%|███▉      | 125/313 [02:04<03:26,  1.10s/it]Computing feature acts:  40%|████      | 126/313 [02:05<03:21,  1.08s/it]Computing feature acts:  41%|████      | 127/313 [02:06<03:19,  1.07s/it]Computing feature acts:  41%|████      | 128/313 [02:07<03:17,  1.07s/it]Computing feature acts:  41%|████      | 129/313 [02:08<03:16,  1.07s/it]Computing feature acts:  42%|████▏     | 130/313 [02:09<03:17,  1.08s/it]Computing feature acts:  42%|████▏     | 131/313 [02:10<03:16,  1.08s/it]Computing feature acts:  42%|████▏     | 132/313 [02:11<03:12,  1.06s/it]Computing feature acts:  42%|████▏     | 133/313 [02:12<03:11,  1.07s/it]Computing feature acts:  43%|████▎     | 134/313 [02:14<03:12,  1.08s/it]Computing feature acts:  43%|████▎     | 135/313 [02:15<03:12,  1.08s/it]Computing feature acts:  43%|████▎     | 136/313 [02:16<03:07,  1.06s/it]Computing feature acts:  44%|████▍     | 137/313 [02:17<03:02,  1.04s/it]Computing feature acts:  44%|████▍     | 138/313 [02:18<02:58,  1.02s/it]Computing feature acts:  44%|████▍     | 139/313 [02:19<02:54,  1.00s/it]Computing feature acts:  45%|████▍     | 140/313 [02:19<02:50,  1.01it/s]Computing feature acts:  45%|████▌     | 141/313 [02:20<02:49,  1.01it/s]Computing feature acts:  45%|████▌     | 142/313 [02:22<02:51,  1.00s/it]Computing feature acts:  46%|████▌     | 143/313 [02:23<02:49,  1.00it/s]Computing feature acts:  46%|████▌     | 144/313 [02:23<02:47,  1.01it/s]Computing feature acts:  46%|████▋     | 145/313 [02:24<02:44,  1.02it/s]Computing feature acts:  47%|████▋     | 146/313 [02:25<02:47,  1.00s/it]Computing feature acts:  47%|████▋     | 147/313 [02:27<02:50,  1.03s/it]Computing feature acts:  47%|████▋     | 148/313 [02:28<02:48,  1.02s/it]Computing feature acts:  48%|████▊     | 149/313 [02:29<02:48,  1.03s/it]Computing feature acts:  48%|████▊     | 150/313 [02:30<02:50,  1.04s/it]Computing feature acts:  48%|████▊     | 151/313 [02:31<02:54,  1.08s/it]Computing feature acts:  49%|████▊     | 152/313 [02:32<02:55,  1.09s/it]Computing feature acts:  49%|████▉     | 153/313 [02:33<02:55,  1.10s/it]Computing feature acts:  49%|████▉     | 154/313 [02:34<02:56,  1.11s/it]Computing feature acts:  50%|████▉     | 155/313 [02:35<02:56,  1.12s/it]Computing feature acts:  50%|████▉     | 156/313 [02:37<02:58,  1.14s/it]Computing feature acts:  50%|█████     | 157/313 [02:38<02:58,  1.14s/it]Computing feature acts:  50%|█████     | 158/313 [02:39<02:58,  1.15s/it]Computing feature acts:  51%|█████     | 159/313 [02:40<02:55,  1.14s/it]Computing feature acts:  51%|█████     | 160/313 [02:41<02:58,  1.17s/it]Computing feature acts:  51%|█████▏    | 161/313 [02:43<03:05,  1.22s/it]Computing feature acts:  52%|█████▏    | 162/313 [02:44<02:59,  1.19s/it]Computing feature acts:  52%|█████▏    | 163/313 [02:45<02:55,  1.17s/it]Computing feature acts:  52%|█████▏    | 164/313 [02:46<02:52,  1.16s/it]Computing feature acts:  53%|█████▎    | 165/313 [02:47<02:49,  1.14s/it]Computing feature acts:  53%|█████▎    | 166/313 [02:48<02:48,  1.14s/it]Computing feature acts:  53%|█████▎    | 167/313 [02:49<02:48,  1.15s/it]Computing feature acts:  54%|█████▎    | 168/313 [02:51<02:47,  1.15s/it]Computing feature acts:  54%|█████▍    | 169/313 [02:52<02:43,  1.13s/it]Computing feature acts:  54%|█████▍    | 170/313 [02:53<02:39,  1.12s/it]Computing feature acts:  55%|█████▍    | 171/313 [02:54<02:37,  1.11s/it]Computing feature acts:  55%|█████▍    | 172/313 [02:55<02:37,  1.11s/it]Computing feature acts:  55%|█████▌    | 173/313 [02:56<02:37,  1.12s/it]Computing feature acts:  56%|█████▌    | 174/313 [02:57<02:35,  1.12s/it]Computing feature acts:  56%|█████▌    | 175/313 [02:58<02:33,  1.11s/it]Computing feature acts:  56%|█████▌    | 176/313 [02:59<02:29,  1.09s/it]Computing feature acts:  57%|█████▋    | 177/313 [03:00<02:28,  1.09s/it]Computing feature acts:  57%|█████▋    | 178/313 [03:01<02:27,  1.09s/it]Computing feature acts:  57%|█████▋    | 179/313 [03:03<02:26,  1.09s/it]Computing feature acts:  58%|█████▊    | 180/313 [03:04<02:24,  1.09s/it]Computing feature acts:  58%|█████▊    | 181/313 [03:05<02:23,  1.09s/it]Computing feature acts:  58%|█████▊    | 182/313 [03:06<02:23,  1.10s/it]Computing feature acts:  58%|█████▊    | 183/313 [03:07<02:22,  1.10s/it]Computing feature acts:  59%|█████▉    | 184/313 [03:08<02:20,  1.09s/it]Computing feature acts:  59%|█████▉    | 185/313 [03:09<02:20,  1.10s/it]Computing feature acts:  59%|█████▉    | 186/313 [03:10<02:19,  1.10s/it]Computing feature acts:  60%|█████▉    | 187/313 [03:12<02:25,  1.15s/it]Computing feature acts:  60%|██████    | 188/313 [03:13<02:22,  1.14s/it]Computing feature acts:  60%|██████    | 189/313 [03:14<02:17,  1.11s/it]Computing feature acts:  61%|██████    | 190/313 [03:15<02:18,  1.13s/it]Computing feature acts:  61%|██████    | 191/313 [03:16<02:17,  1.13s/it]Computing feature acts:  61%|██████▏   | 192/313 [03:17<02:16,  1.13s/it]Computing feature acts:  62%|██████▏   | 193/313 [03:18<02:14,  1.12s/it]Computing feature acts:  62%|██████▏   | 194/313 [03:19<02:13,  1.12s/it]Computing feature acts:  62%|██████▏   | 195/313 [03:20<02:11,  1.11s/it]Computing feature acts:  63%|██████▎   | 196/313 [03:22<02:09,  1.11s/it]Computing feature acts:  63%|██████▎   | 197/313 [03:23<02:07,  1.10s/it]Computing feature acts:  63%|██████▎   | 198/313 [03:24<02:07,  1.11s/it]Computing feature acts:  64%|██████▎   | 199/313 [03:25<02:07,  1.12s/it]Computing feature acts:  64%|██████▍   | 200/313 [03:26<02:07,  1.13s/it]Computing feature acts:  64%|██████▍   | 201/313 [03:27<02:05,  1.12s/it]Computing feature acts:  65%|██████▍   | 202/313 [03:28<01:57,  1.06s/it]Computing feature acts:  65%|██████▍   | 203/313 [03:29<01:54,  1.04s/it]Computing feature acts:  65%|██████▌   | 204/313 [03:30<01:51,  1.02s/it]Computing feature acts:  65%|██████▌   | 205/313 [03:31<01:49,  1.01s/it]Computing feature acts:  66%|██████▌   | 206/313 [03:32<01:48,  1.01s/it]Computing feature acts:  66%|██████▌   | 207/313 [03:33<01:46,  1.00s/it]Computing feature acts:  66%|██████▋   | 208/313 [03:34<01:45,  1.00s/it]Computing feature acts:  67%|██████▋   | 209/313 [03:35<01:44,  1.01s/it]Computing feature acts:  67%|██████▋   | 210/313 [03:36<01:44,  1.01s/it]Computing feature acts:  67%|██████▋   | 211/313 [03:37<01:43,  1.02s/it]Computing feature acts:  68%|██████▊   | 212/313 [03:38<01:43,  1.02s/it]Computing feature acts:  68%|██████▊   | 213/313 [03:39<01:42,  1.02s/it]Computing feature acts:  68%|██████▊   | 214/313 [03:40<01:39,  1.00s/it]Computing feature acts:  69%|██████▊   | 215/313 [03:41<01:37,  1.00it/s]Computing feature acts:  69%|██████▉   | 216/313 [03:42<01:36,  1.00it/s]Computing feature acts:  69%|██████▉   | 217/313 [03:43<01:33,  1.03it/s]Computing feature acts:  70%|██████▉   | 218/313 [03:44<01:31,  1.04it/s]Computing feature acts:  70%|██████▉   | 219/313 [03:45<01:29,  1.05it/s]Computing feature acts:  70%|███████   | 220/313 [03:46<01:28,  1.05it/s]Computing feature acts:  71%|███████   | 221/313 [03:47<01:30,  1.02it/s]Computing feature acts:  71%|███████   | 222/313 [03:48<01:30,  1.01it/s]Computing feature acts:  71%|███████   | 223/313 [03:49<01:29,  1.00it/s]Computing feature acts:  72%|███████▏  | 224/313 [03:50<01:29,  1.00s/it]Computing feature acts:  72%|███████▏  | 225/313 [03:51<01:29,  1.01s/it]Computing feature acts:  72%|███████▏  | 226/313 [03:52<01:29,  1.03s/it]Computing feature acts:  73%|███████▎  | 227/313 [03:53<01:32,  1.07s/it]Computing feature acts:  73%|███████▎  | 228/313 [03:54<01:29,  1.06s/it]Computing feature acts:  73%|███████▎  | 229/313 [03:55<01:28,  1.05s/it]Computing feature acts:  73%|███████▎  | 230/313 [03:56<01:27,  1.05s/it]Computing feature acts:  74%|███████▍  | 231/313 [03:57<01:26,  1.05s/it]Computing feature acts:  74%|███████▍  | 232/313 [03:58<01:24,  1.05s/it]Computing feature acts:  74%|███████▍  | 233/313 [03:59<01:25,  1.06s/it]Computing feature acts:  75%|███████▍  | 234/313 [04:01<01:24,  1.07s/it]Computing feature acts:  75%|███████▌  | 235/313 [04:02<01:24,  1.08s/it]Computing feature acts:  75%|███████▌  | 236/313 [04:03<01:23,  1.08s/it]Computing feature acts:  76%|███████▌  | 237/313 [04:04<01:20,  1.06s/it]Computing feature acts:  76%|███████▌  | 238/313 [04:05<01:17,  1.03s/it]Computing feature acts:  76%|███████▋  | 239/313 [04:06<01:15,  1.03s/it]Computing feature acts:  77%|███████▋  | 240/313 [04:07<01:14,  1.02s/it]Computing feature acts:  77%|███████▋  | 241/313 [04:08<01:14,  1.03s/it]Computing feature acts:  77%|███████▋  | 242/313 [04:09<01:14,  1.05s/it]Computing feature acts:  78%|███████▊  | 243/313 [04:10<01:15,  1.08s/it]Computing feature acts:  78%|███████▊  | 244/313 [04:11<01:15,  1.09s/it]Computing feature acts:  78%|███████▊  | 245/313 [04:12<01:15,  1.11s/it]Computing feature acts:  79%|███████▊  | 246/313 [04:13<01:12,  1.08s/it]Computing feature acts:  79%|███████▉  | 247/313 [04:14<01:08,  1.04s/it]Computing feature acts:  79%|███████▉  | 248/313 [04:15<01:06,  1.03s/it]Computing feature acts:  80%|███████▉  | 249/313 [04:16<01:05,  1.03s/it]Computing feature acts:  80%|███████▉  | 250/313 [04:17<01:05,  1.04s/it]Computing feature acts:  80%|████████  | 251/313 [04:18<01:05,  1.06s/it]Computing feature acts:  81%|████████  | 252/313 [04:19<01:02,  1.02s/it]Computing feature acts:  81%|████████  | 253/313 [04:20<00:59,  1.00it/s]Computing feature acts:  81%|████████  | 254/313 [04:21<00:58,  1.00it/s]Computing feature acts:  81%|████████▏ | 255/313 [04:22<00:57,  1.00it/s]Computing feature acts:  82%|████████▏ | 256/313 [04:23<00:56,  1.01it/s]Computing feature acts:  82%|████████▏ | 257/313 [04:24<00:55,  1.01it/s]Computing feature acts:  82%|████████▏ | 258/313 [04:25<00:53,  1.03it/s]Computing feature acts:  83%|████████▎ | 259/313 [04:26<00:52,  1.03it/s]Computing feature acts:  83%|████████▎ | 260/313 [04:27<00:51,  1.04it/s]Computing feature acts:  83%|████████▎ | 261/313 [04:28<00:50,  1.04it/s]Computing feature acts:  84%|████████▎ | 262/313 [04:29<00:48,  1.04it/s]Computing feature acts:  84%|████████▍ | 263/313 [04:30<00:47,  1.05it/s]Computing feature acts:  84%|████████▍ | 264/313 [04:31<00:46,  1.06it/s]Computing feature acts:  85%|████████▍ | 265/313 [04:32<00:44,  1.08it/s]Computing feature acts:  85%|████████▍ | 266/313 [04:33<00:44,  1.06it/s]Computing feature acts:  85%|████████▌ | 267/313 [04:34<00:44,  1.02it/s]Computing feature acts:  86%|████████▌ | 268/313 [04:35<00:45,  1.01s/it]Computing feature acts:  86%|████████▌ | 269/313 [04:36<00:44,  1.02s/it]Computing feature acts:  86%|████████▋ | 270/313 [04:37<00:44,  1.02s/it]Computing feature acts:  87%|████████▋ | 271/313 [04:38<00:43,  1.03s/it]Computing feature acts:  87%|████████▋ | 272/313 [04:39<00:42,  1.04s/it]Computing feature acts:  87%|████████▋ | 273/313 [04:40<00:42,  1.05s/it]Computing feature acts:  88%|████████▊ | 274/313 [04:41<00:41,  1.05s/it]Computing feature acts:  88%|████████▊ | 275/313 [04:42<00:39,  1.05s/it]Computing feature acts:  88%|████████▊ | 276/313 [04:43<00:39,  1.06s/it]Computing feature acts:  88%|████████▊ | 277/313 [04:44<00:38,  1.08s/it]Computing feature acts:  89%|████████▉ | 278/313 [04:46<00:37,  1.08s/it]Computing feature acts:  89%|████████▉ | 279/313 [04:47<00:36,  1.09s/it]Computing feature acts:  89%|████████▉ | 280/313 [04:48<00:35,  1.09s/it]Computing feature acts:  90%|████████▉ | 281/313 [04:49<00:34,  1.08s/it]Computing feature acts:  90%|█████████ | 282/313 [04:50<00:33,  1.08s/it]Computing feature acts:  90%|█████████ | 283/313 [04:51<00:32,  1.08s/it]Computing feature acts:  91%|█████████ | 284/313 [04:52<00:31,  1.09s/it]Computing feature acts:  91%|█████████ | 285/313 [04:53<00:30,  1.09s/it]Computing feature acts:  91%|█████████▏| 286/313 [04:54<00:29,  1.09s/it]Computing feature acts:  92%|█████████▏| 287/313 [04:55<00:28,  1.09s/it]Computing feature acts:  92%|█████████▏| 288/313 [04:56<00:27,  1.10s/it]Computing feature acts:  92%|█████████▏| 289/313 [04:58<00:26,  1.10s/it]Computing feature acts:  93%|█████████▎| 290/313 [04:59<00:25,  1.10s/it]Computing feature acts:  93%|█████████▎| 291/313 [05:00<00:24,  1.10s/it]Computing feature acts:  93%|█████████▎| 292/313 [05:01<00:22,  1.09s/it]Computing feature acts:  94%|█████████▎| 293/313 [05:02<00:22,  1.13s/it]Computing feature acts:  94%|█████████▍| 294/313 [05:03<00:20,  1.10s/it]Computing feature acts:  94%|█████████▍| 295/313 [05:04<00:19,  1.09s/it]Computing feature acts:  95%|█████████▍| 296/313 [05:05<00:18,  1.09s/it]Computing feature acts:  95%|█████████▍| 297/313 [05:06<00:17,  1.09s/it]Computing feature acts:  95%|█████████▌| 298/313 [05:07<00:16,  1.09s/it]Computing feature acts:  96%|█████████▌| 299/313 [05:09<00:15,  1.09s/it]Computing feature acts:  96%|█████████▌| 300/313 [05:10<00:14,  1.11s/it]Computing feature acts:  96%|█████████▌| 301/313 [05:11<00:13,  1.09s/it]Computing feature acts:  96%|█████████▋| 302/313 [05:12<00:12,  1.10s/it]Computing feature acts:  97%|█████████▋| 303/313 [05:13<00:10,  1.09s/it]Computing feature acts:  97%|█████████▋| 304/313 [05:14<00:09,  1.09s/it]Computing feature acts:  97%|█████████▋| 305/313 [05:15<00:08,  1.09s/it]Computing feature acts:  98%|█████████▊| 306/313 [05:16<00:07,  1.09s/it]Computing feature acts:  98%|█████████▊| 307/313 [05:17<00:06,  1.04s/it]Computing feature acts:  98%|█████████▊| 308/313 [05:18<00:04,  1.01it/s]Computing feature acts:  99%|█████████▊| 309/313 [05:19<00:03,  1.01it/s]Computing feature acts:  99%|█████████▉| 310/313 [05:20<00:02,  1.02it/s]Computing feature acts:  99%|█████████▉| 311/313 [05:21<00:01,  1.02it/s]Computing feature acts: 100%|█████████▉| 312/313 [05:22<00:00,  1.05it/s]Computing feature acts: 100%|██████████| 313/313 [05:23<00:00,  1.07it/s]Computing feature acts: 100%|██████████| 313/313 [05:24<00:00,  1.04s/it]
Parsing activation data:   0%|          | 0/4 [00:00<?, ?it/s]Parsing activation data:  25%|██▌       | 1/4 [00:09<00:28,  9.43s/it]Parsing activation data:  50%|█████     | 2/4 [00:18<00:18,  9.02s/it]Parsing activation data:  75%|███████▌  | 3/4 [00:27<00:09,  9.14s/it]Parsing activation data: 100%|██████████| 4/4 [00:37<00:00,  9.35s/it]Parsing activation data: 100%|██████████| 4/4 [00:37<00:00,  9.28s/it]
2024-04-16 02:45:57 - INFO - Saving HTML feature dashboards for the SAE at blocks.10.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/4 [00:00<?, ?it/s]Dashboard HTML files:  25%|██▌       | 1/4 [00:01<00:03,  1.28s/it]Dashboard HTML files:  50%|█████     | 2/4 [00:02<00:02,  1.28s/it]Dashboard HTML files:  75%|███████▌  | 3/4 [00:03<00:01,  1.31s/it]Dashboard HTML files: 100%|██████████| 4/4 [00:06<00:00,  1.70s/it]Dashboard HTML files: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
2024-04-16 02:46:03 - INFO - Finished.
2024-04-16 02:46:03 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-6.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_m2hntlav/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-6.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_m2hntlav/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-10_region-0_local-m2hntlav_Blue_cluster_in_middle') save_json_data=False sae_positions=None feature_indices=[] prompt_centric=None seed=0
2024-04-16 02:46:03 - INFO - Loading the model and SAEs
run_sae_path = /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-6.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_m2hntlav/samples_400000.pt
Traceback (most recent call last):
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 51, in <module>
    fire.Fire(main)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 48, in main
    generate_dashboards(dashbaords_config, run_sae_path)
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 998, in main
    model, _, _ = load_SAETransformer_from_saes_paths(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 943, in load_SAETransformer_from_saes_paths
    assert config_path.exists(), f"config_path: {config_path} does not exist"
AssertionError: config_path: /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-6.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_m2hntlav/config.yaml does not exist
2024-04-16 02:46:10 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-1.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_8crnit9h/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-1.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_8crnit9h/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-10_region-1_e2e-8crnit9h_Orange_cluster_on_right') save_json_data=False sae_positions=None feature_indices=[308, 3383, 6141, 9632, 14706, 14859, 17703, 20107, 22125] prompt_centric=None seed=0
2024-04-16 02:46:10 - INFO - Loading the model and SAEs
2024-04-16 02:46:10 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=1.5, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.10.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-16 02:46:22 - INFO - done
2024-04-16 02:46:22 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/regions/layer-10_region-1_e2e-8crnit9h_Orange_cluster_on_right
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-1.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_8crnit9h/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/313 [00:00<?, ?it/s]Computing feature acts:   0%|          | 1/313 [00:01<07:02,  1.35s/it]Computing feature acts:   1%|          | 2/313 [00:02<05:56,  1.15s/it]Computing feature acts:   1%|          | 3/313 [00:03<05:35,  1.08s/it]Computing feature acts:   1%|▏         | 4/313 [00:04<05:25,  1.05s/it]Computing feature acts:   2%|▏         | 5/313 [00:05<05:18,  1.03s/it]Computing feature acts:   2%|▏         | 6/313 [00:06<05:13,  1.02s/it]Computing feature acts:   2%|▏         | 7/313 [00:07<05:11,  1.02s/it]Computing feature acts:   3%|▎         | 8/313 [00:08<05:14,  1.03s/it]Computing feature acts:   3%|▎         | 9/313 [00:09<05:17,  1.04s/it]Computing feature acts:   3%|▎         | 10/313 [00:10<05:18,  1.05s/it]Computing feature acts:   4%|▎         | 11/313 [00:11<05:19,  1.06s/it]Computing feature acts:   4%|▍         | 12/313 [00:12<05:20,  1.07s/it]Computing feature acts:   4%|▍         | 13/313 [00:13<05:23,  1.08s/it]Computing feature acts:   4%|▍         | 14/313 [00:14<05:25,  1.09s/it]Computing feature acts:   5%|▍         | 15/313 [00:16<05:21,  1.08s/it]Computing feature acts:   5%|▌         | 16/313 [00:17<05:17,  1.07s/it]Computing feature acts:   5%|▌         | 17/313 [00:18<05:11,  1.05s/it]Computing feature acts:   6%|▌         | 18/313 [00:19<05:28,  1.12s/it]Computing feature acts:   6%|▌         | 19/313 [00:20<05:29,  1.12s/it]Computing feature acts:   6%|▋         | 20/313 [00:21<05:30,  1.13s/it]Computing feature acts:   7%|▋         | 21/313 [00:22<05:29,  1.13s/it]Computing feature acts:   7%|▋         | 22/313 [00:23<05:19,  1.10s/it]Computing feature acts:   7%|▋         | 23/313 [00:24<05:20,  1.11s/it]Computing feature acts:   8%|▊         | 24/313 [00:25<05:14,  1.09s/it]Computing feature acts:   8%|▊         | 25/313 [00:27<05:21,  1.12s/it]Computing feature acts:   8%|▊         | 26/313 [00:28<05:17,  1.11s/it]Computing feature acts:   9%|▊         | 27/313 [00:29<05:10,  1.08s/it]Computing feature acts:   9%|▉         | 28/313 [00:30<05:07,  1.08s/it]Computing feature acts:   9%|▉         | 29/313 [00:31<04:51,  1.03s/it]Computing feature acts:  10%|▉         | 30/313 [00:32<04:46,  1.01s/it]Computing feature acts:  10%|▉         | 31/313 [00:33<04:58,  1.06s/it]Computing feature acts:  10%|█         | 32/313 [00:34<04:53,  1.05s/it]Computing feature acts:  11%|█         | 33/313 [00:35<04:49,  1.03s/it]Computing feature acts:  11%|█         | 34/313 [00:36<04:46,  1.03s/it]Computing feature acts:  11%|█         | 35/313 [00:37<04:46,  1.03s/it]Computing feature acts:  12%|█▏        | 36/313 [00:38<04:44,  1.03s/it]Computing feature acts:  12%|█▏        | 37/313 [00:39<04:30,  1.02it/s]Computing feature acts:  12%|█▏        | 38/313 [00:40<04:24,  1.04it/s]Computing feature acts:  12%|█▏        | 39/313 [00:41<04:20,  1.05it/s]Computing feature acts:  13%|█▎        | 40/313 [00:42<04:15,  1.07it/s]Computing feature acts:  13%|█▎        | 41/313 [00:42<04:12,  1.08it/s]Computing feature acts:  13%|█▎        | 42/313 [00:43<04:17,  1.05it/s]Computing feature acts:  14%|█▎        | 43/313 [00:45<04:24,  1.02it/s]Computing feature acts:  14%|█▍        | 44/313 [00:46<04:24,  1.02it/s]Computing feature acts:  14%|█▍        | 45/313 [00:47<04:28,  1.00s/it]Computing feature acts:  15%|█▍        | 46/313 [00:48<04:29,  1.01s/it]Computing feature acts:  15%|█▌        | 47/313 [00:48<04:18,  1.03it/s]Computing feature acts:  15%|█▌        | 48/313 [00:49<04:12,  1.05it/s]Computing feature acts:  16%|█▌        | 49/313 [00:50<04:06,  1.07it/s]Computing feature acts:  16%|█▌        | 50/313 [00:51<04:04,  1.07it/s]Computing feature acts:  16%|█▋        | 51/313 [00:52<04:02,  1.08it/s]Computing feature acts:  17%|█▋        | 52/313 [00:53<04:00,  1.09it/s]Computing feature acts:  17%|█▋        | 53/313 [00:54<03:56,  1.10it/s]Computing feature acts:  17%|█▋        | 54/313 [00:55<03:56,  1.10it/s]Computing feature acts:  18%|█▊        | 55/313 [00:56<03:55,  1.10it/s]Computing feature acts:  18%|█▊        | 56/313 [00:57<03:54,  1.09it/s]Computing feature acts:  18%|█▊        | 57/313 [00:58<03:52,  1.10it/s]Computing feature acts:  19%|█▊        | 58/313 [00:58<03:50,  1.11it/s]Computing feature acts:  19%|█▉        | 59/313 [00:59<03:48,  1.11it/s]Computing feature acts:  19%|█▉        | 60/313 [01:00<03:50,  1.10it/s]Computing feature acts:  19%|█▉        | 61/313 [01:01<03:49,  1.10it/s]Computing feature acts:  20%|█▉        | 62/313 [01:02<03:49,  1.09it/s]Computing feature acts:  20%|██        | 63/313 [01:03<03:47,  1.10it/s]Computing feature acts:  20%|██        | 64/313 [01:04<03:45,  1.10it/s]Computing feature acts:  21%|██        | 65/313 [01:05<03:42,  1.11it/s]Computing feature acts:  21%|██        | 66/313 [01:06<03:41,  1.12it/s]Computing feature acts:  21%|██▏       | 67/313 [01:07<03:40,  1.11it/s]Computing feature acts:  22%|██▏       | 68/313 [01:07<03:39,  1.12it/s]Computing feature acts:  22%|██▏       | 69/313 [01:08<03:37,  1.12it/s]Computing feature acts:  22%|██▏       | 70/313 [01:09<03:38,  1.11it/s]Computing feature acts:  23%|██▎       | 71/313 [01:10<03:38,  1.11it/s]Computing feature acts:  23%|██▎       | 72/313 [01:11<03:40,  1.09it/s]Computing feature acts:  23%|██▎       | 73/313 [01:12<03:39,  1.09it/s]Computing feature acts:  24%|██▎       | 74/313 [01:13<03:38,  1.09it/s]Computing feature acts:  24%|██▍       | 75/313 [01:14<03:38,  1.09it/s]Computing feature acts:  24%|██▍       | 76/313 [01:15<03:36,  1.09it/s]Computing feature acts:  25%|██▍       | 77/313 [01:16<03:33,  1.10it/s]Computing feature acts:  25%|██▍       | 78/313 [01:17<03:34,  1.10it/s]Computing feature acts:  25%|██▌       | 79/313 [01:17<03:32,  1.10it/s]Computing feature acts:  26%|██▌       | 80/313 [01:18<03:38,  1.07it/s]Computing feature acts:  26%|██▌       | 81/313 [01:20<03:44,  1.03it/s]Computing feature acts:  26%|██▌       | 82/313 [01:21<03:48,  1.01it/s]Computing feature acts:  27%|██▋       | 83/313 [01:21<03:43,  1.03it/s]Computing feature acts:  27%|██▋       | 84/313 [01:22<03:37,  1.05it/s]Computing feature acts:  27%|██▋       | 85/313 [01:23<03:34,  1.06it/s]Computing feature acts:  27%|██▋       | 86/313 [01:24<03:30,  1.08it/s]Computing feature acts:  28%|██▊       | 87/313 [01:25<03:27,  1.09it/s]Computing feature acts:  28%|██▊       | 88/313 [01:26<03:33,  1.05it/s]Computing feature acts:  28%|██▊       | 89/313 [01:27<03:38,  1.03it/s]Computing feature acts:  29%|██▉       | 90/313 [01:28<03:42,  1.00it/s]Computing feature acts:  29%|██▉       | 91/313 [01:29<03:46,  1.02s/it]Computing feature acts:  29%|██▉       | 92/313 [01:30<03:46,  1.02s/it]Computing feature acts:  30%|██▉       | 93/313 [01:31<03:45,  1.02s/it]Computing feature acts:  30%|███       | 94/313 [01:32<03:45,  1.03s/it]Computing feature acts:  30%|███       | 95/313 [01:33<03:34,  1.02it/s]Computing feature acts:  31%|███       | 96/313 [01:34<03:40,  1.02s/it]Computing feature acts:  31%|███       | 97/313 [01:35<03:30,  1.03it/s]Computing feature acts:  31%|███▏      | 98/313 [01:36<03:24,  1.05it/s]Computing feature acts:  32%|███▏      | 99/313 [01:37<03:30,  1.01it/s]Computing feature acts:  32%|███▏      | 100/313 [01:38<03:37,  1.02s/it]Computing feature acts:  32%|███▏      | 101/313 [01:39<03:42,  1.05s/it]Computing feature acts:  33%|███▎      | 102/313 [01:41<03:46,  1.08s/it]Computing feature acts:  33%|███▎      | 103/313 [01:42<03:41,  1.05s/it]Computing feature acts:  33%|███▎      | 104/313 [01:43<03:38,  1.05s/it]Computing feature acts:  34%|███▎      | 105/313 [01:44<03:37,  1.04s/it]Computing feature acts:  34%|███▍      | 106/313 [01:45<03:34,  1.04s/it]Computing feature acts:  34%|███▍      | 107/313 [01:46<03:33,  1.04s/it]Computing feature acts:  35%|███▍      | 108/313 [01:47<03:33,  1.04s/it]Computing feature acts:  35%|███▍      | 109/313 [01:48<03:33,  1.05s/it]Computing feature acts:  35%|███▌      | 110/313 [01:49<03:31,  1.04s/it]Computing feature acts:  35%|███▌      | 111/313 [01:50<03:29,  1.04s/it]Computing feature acts:  36%|███▌      | 112/313 [01:51<03:28,  1.04s/it]Computing feature acts:  36%|███▌      | 113/313 [01:52<03:27,  1.04s/it]Computing feature acts:  36%|███▋      | 114/313 [01:53<03:26,  1.04s/it]Computing feature acts:  37%|███▋      | 115/313 [01:54<03:26,  1.04s/it]Computing feature acts:  37%|███▋      | 116/313 [01:55<03:25,  1.04s/it]Computing feature acts:  37%|███▋      | 117/313 [01:56<03:23,  1.04s/it]Computing feature acts:  38%|███▊      | 118/313 [01:57<03:22,  1.04s/it]Computing feature acts:  38%|███▊      | 119/313 [01:58<03:22,  1.05s/it]Computing feature acts:  38%|███▊      | 120/313 [01:59<03:21,  1.04s/it]Computing feature acts:  39%|███▊      | 121/313 [02:00<03:14,  1.01s/it]Computing feature acts:  39%|███▉      | 122/313 [02:01<03:08,  1.01it/s]Computing feature acts:  39%|███▉      | 123/313 [02:02<03:04,  1.03it/s]Computing feature acts:  40%|███▉      | 124/313 [02:03<03:01,  1.04it/s]Computing feature acts:  40%|███▉      | 125/313 [02:04<02:58,  1.06it/s]Computing feature acts:  40%|████      | 126/313 [02:05<02:53,  1.08it/s]Computing feature acts:  41%|████      | 127/313 [02:06<02:52,  1.08it/s]Computing feature acts:  41%|████      | 128/313 [02:07<02:51,  1.08it/s]Computing feature acts:  41%|████      | 129/313 [02:08<02:50,  1.08it/s]Computing feature acts:  42%|████▏     | 130/313 [02:08<02:51,  1.07it/s]Computing feature acts:  42%|████▏     | 131/313 [02:10<02:57,  1.03it/s]Computing feature acts:  42%|████▏     | 132/313 [02:11<03:04,  1.02s/it]Computing feature acts:  42%|████▏     | 133/313 [02:12<03:05,  1.03s/it]Computing feature acts:  43%|████▎     | 134/313 [02:13<03:06,  1.04s/it]Computing feature acts:  43%|████▎     | 135/313 [02:14<03:07,  1.05s/it]Computing feature acts:  43%|████▎     | 136/313 [02:15<03:04,  1.04s/it]Computing feature acts:  44%|████▍     | 137/313 [02:16<03:02,  1.04s/it]Computing feature acts:  44%|████▍     | 138/313 [02:17<03:02,  1.04s/it]Computing feature acts:  44%|████▍     | 139/313 [02:18<03:01,  1.04s/it]Computing feature acts:  45%|████▍     | 140/313 [02:19<03:02,  1.05s/it]Computing feature acts:  45%|████▌     | 141/313 [02:20<03:00,  1.05s/it]Computing feature acts:  45%|████▌     | 142/313 [02:21<02:59,  1.05s/it]Computing feature acts:  46%|████▌     | 143/313 [02:22<02:58,  1.05s/it]Computing feature acts:  46%|████▌     | 144/313 [02:23<02:56,  1.05s/it]Computing feature acts:  46%|████▋     | 145/313 [02:24<02:55,  1.05s/it]Computing feature acts:  47%|████▋     | 146/313 [02:25<02:54,  1.04s/it]Computing feature acts:  47%|████▋     | 147/313 [02:26<02:54,  1.05s/it]Computing feature acts:  47%|████▋     | 148/313 [02:28<02:54,  1.06s/it]Computing feature acts:  48%|████▊     | 149/313 [02:29<02:53,  1.06s/it]Computing feature acts:  48%|████▊     | 150/313 [02:30<02:51,  1.05s/it]Computing feature acts:  48%|████▊     | 151/313 [02:31<02:50,  1.05s/it]Computing feature acts:  49%|████▊     | 152/313 [02:32<02:51,  1.06s/it]Computing feature acts:  49%|████▉     | 153/313 [02:33<02:42,  1.02s/it]Computing feature acts:  49%|████▉     | 154/313 [02:34<02:44,  1.03s/it]Computing feature acts:  50%|████▉     | 155/313 [02:35<02:46,  1.06s/it]Computing feature acts:  50%|████▉     | 156/313 [02:36<02:49,  1.08s/it]Computing feature acts:  50%|█████     | 157/313 [02:37<02:49,  1.09s/it]Computing feature acts:  50%|█████     | 158/313 [02:38<02:47,  1.08s/it]Computing feature acts:  51%|█████     | 159/313 [02:39<02:44,  1.07s/it]Computing feature acts:  51%|█████     | 160/313 [02:40<02:42,  1.06s/it]Computing feature acts:  51%|█████▏    | 161/313 [02:41<02:46,  1.09s/it]Computing feature acts:  52%|█████▏    | 162/313 [02:42<02:44,  1.09s/it]Computing feature acts:  52%|█████▏    | 163/313 [02:44<02:40,  1.07s/it]Computing feature acts:  52%|█████▏    | 164/313 [02:45<02:38,  1.07s/it]Computing feature acts:  53%|█████▎    | 165/313 [02:46<02:37,  1.06s/it]Computing feature acts:  53%|█████▎    | 166/313 [02:47<02:37,  1.07s/it]Computing feature acts:  53%|█████▎    | 167/313 [02:48<02:37,  1.08s/it]Computing feature acts:  54%|█████▎    | 168/313 [02:49<02:38,  1.09s/it]Computing feature acts:  54%|█████▍    | 169/313 [02:50<02:30,  1.04s/it]Computing feature acts:  54%|█████▍    | 170/313 [02:51<02:23,  1.00s/it]Computing feature acts:  55%|█████▍    | 171/313 [02:52<02:21,  1.01it/s]Computing feature acts:  55%|█████▍    | 172/313 [02:53<02:15,  1.04it/s]Computing feature acts:  55%|█████▌    | 173/313 [02:54<02:12,  1.05it/s]Computing feature acts:  56%|█████▌    | 174/313 [02:54<02:10,  1.07it/s]Computing feature acts:  56%|█████▌    | 175/313 [02:55<02:08,  1.08it/s]Computing feature acts:  56%|█████▌    | 176/313 [02:56<02:06,  1.08it/s]Computing feature acts:  57%|█████▋    | 177/313 [02:57<02:05,  1.08it/s]Computing feature acts:  57%|█████▋    | 178/313 [02:58<02:06,  1.07it/s]Computing feature acts:  57%|█████▋    | 179/313 [02:59<02:03,  1.09it/s]Computing feature acts:  58%|█████▊    | 180/313 [03:00<02:02,  1.08it/s]Computing feature acts:  58%|█████▊    | 181/313 [03:01<02:00,  1.09it/s]Computing feature acts:  58%|█████▊    | 182/313 [03:02<02:00,  1.09it/s]Computing feature acts:  58%|█████▊    | 183/313 [03:03<01:59,  1.08it/s]Computing feature acts:  59%|█████▉    | 184/313 [03:04<01:58,  1.09it/s]Computing feature acts:  59%|█████▉    | 185/313 [03:05<01:57,  1.09it/s]Computing feature acts:  59%|█████▉    | 186/313 [03:05<01:56,  1.09it/s]Computing feature acts:  60%|█████▉    | 187/313 [03:07<02:03,  1.02it/s]Computing feature acts:  60%|██████    | 188/313 [03:07<01:59,  1.05it/s]Computing feature acts:  60%|██████    | 189/313 [03:08<01:55,  1.07it/s]Computing feature acts:  61%|██████    | 190/313 [03:09<01:53,  1.08it/s]Computing feature acts:  61%|██████    | 191/313 [03:10<01:52,  1.09it/s]Computing feature acts:  61%|██████▏   | 192/313 [03:11<01:50,  1.09it/s]Computing feature acts:  62%|██████▏   | 193/313 [03:12<01:49,  1.10it/s]Computing feature acts:  62%|██████▏   | 194/313 [03:13<01:49,  1.08it/s]Computing feature acts:  62%|██████▏   | 195/313 [03:14<01:48,  1.09it/s]Computing feature acts:  63%|██████▎   | 196/313 [03:15<01:47,  1.09it/s]Computing feature acts:  63%|██████▎   | 197/313 [03:16<01:45,  1.10it/s]Computing feature acts:  63%|██████▎   | 198/313 [03:17<01:44,  1.10it/s]Computing feature acts:  64%|██████▎   | 199/313 [03:17<01:43,  1.10it/s]Computing feature acts:  64%|██████▍   | 200/313 [03:18<01:43,  1.09it/s]Computing feature acts:  64%|██████▍   | 201/313 [03:19<01:42,  1.10it/s]Computing feature acts:  65%|██████▍   | 202/313 [03:20<01:42,  1.09it/s]Computing feature acts:  65%|██████▍   | 203/313 [03:21<01:42,  1.07it/s]Computing feature acts:  65%|██████▌   | 204/313 [03:22<01:41,  1.08it/s]Computing feature acts:  65%|██████▌   | 205/313 [03:23<01:40,  1.07it/s]Computing feature acts:  66%|██████▌   | 206/313 [03:24<01:41,  1.05it/s]Computing feature acts:  66%|██████▌   | 207/313 [03:25<01:40,  1.05it/s]Computing feature acts:  66%|██████▋   | 208/313 [03:26<01:37,  1.08it/s]Computing feature acts:  67%|██████▋   | 209/313 [03:27<01:35,  1.09it/s]Computing feature acts:  67%|██████▋   | 210/313 [03:28<01:34,  1.09it/s]Computing feature acts:  67%|██████▋   | 211/313 [03:29<01:32,  1.10it/s]Computing feature acts:  68%|██████▊   | 212/313 [03:29<01:31,  1.10it/s]Computing feature acts:  68%|██████▊   | 213/313 [03:30<01:30,  1.10it/s]Computing feature acts:  68%|██████▊   | 214/313 [03:31<01:30,  1.09it/s]Computing feature acts:  69%|██████▊   | 215/313 [03:32<01:31,  1.08it/s]Computing feature acts:  69%|██████▉   | 216/313 [03:33<01:31,  1.07it/s]Computing feature acts:  69%|██████▉   | 217/313 [03:34<01:30,  1.06it/s]Computing feature acts:  70%|██████▉   | 218/313 [03:35<01:28,  1.07it/s]Computing feature acts:  70%|██████▉   | 219/313 [03:36<01:28,  1.07it/s]Computing feature acts:  70%|███████   | 220/313 [03:37<01:27,  1.06it/s]Computing feature acts:  71%|███████   | 221/313 [03:38<01:27,  1.05it/s]Computing feature acts:  71%|███████   | 222/313 [03:39<01:27,  1.04it/s]Computing feature acts:  71%|███████   | 223/313 [03:40<01:25,  1.06it/s]Computing feature acts:  72%|███████▏  | 224/313 [03:41<01:23,  1.07it/s]Computing feature acts:  72%|███████▏  | 225/313 [03:42<01:21,  1.08it/s]Computing feature acts:  72%|███████▏  | 226/313 [03:43<01:20,  1.08it/s]Computing feature acts:  73%|███████▎  | 227/313 [03:44<01:24,  1.02it/s]Computing feature acts:  73%|███████▎  | 228/313 [03:45<01:21,  1.04it/s]Computing feature acts:  73%|███████▎  | 229/313 [03:46<01:19,  1.06it/s]Computing feature acts:  73%|███████▎  | 230/313 [03:46<01:17,  1.06it/s]Computing feature acts:  74%|███████▍  | 231/313 [03:47<01:15,  1.08it/s]Computing feature acts:  74%|███████▍  | 232/313 [03:48<01:15,  1.08it/s]Computing feature acts:  74%|███████▍  | 233/313 [03:49<01:13,  1.08it/s]Computing feature acts:  75%|███████▍  | 234/313 [03:50<01:12,  1.09it/s]Computing feature acts:  75%|███████▌  | 235/313 [03:51<01:12,  1.07it/s]Computing feature acts:  75%|███████▌  | 236/313 [03:52<01:15,  1.02it/s]Computing feature acts:  76%|███████▌  | 237/313 [03:53<01:16,  1.01s/it]Computing feature acts:  76%|███████▌  | 238/313 [03:54<01:17,  1.03s/it]Computing feature acts:  76%|███████▋  | 239/313 [03:55<01:17,  1.05s/it]Computing feature acts:  77%|███████▋  | 240/313 [03:57<01:17,  1.07s/it]Computing feature acts:  77%|███████▋  | 241/313 [03:58<01:17,  1.08s/it]Computing feature acts:  77%|███████▋  | 242/313 [03:59<01:16,  1.08s/it]Computing feature acts:  78%|███████▊  | 243/313 [04:00<01:16,  1.09s/it]Computing feature acts:  78%|███████▊  | 244/313 [04:01<01:14,  1.09s/it]Computing feature acts:  78%|███████▊  | 245/313 [04:02<01:12,  1.07s/it]Computing feature acts:  79%|███████▊  | 246/313 [04:03<01:11,  1.07s/it]Computing feature acts:  79%|███████▉  | 247/313 [04:04<01:10,  1.07s/it]Computing feature acts:  79%|███████▉  | 248/313 [04:05<01:10,  1.09s/it]Computing feature acts:  80%|███████▉  | 249/313 [04:06<01:10,  1.10s/it]Computing feature acts:  80%|███████▉  | 250/313 [04:07<01:09,  1.11s/it]Computing feature acts:  80%|████████  | 251/313 [04:09<01:08,  1.11s/it]Computing feature acts:  81%|████████  | 252/313 [04:10<01:07,  1.11s/it]Computing feature acts:  81%|████████  | 253/313 [04:11<01:06,  1.10s/it]Computing feature acts:  81%|████████  | 254/313 [04:12<01:04,  1.09s/it]Computing feature acts:  81%|████████▏ | 255/313 [04:13<01:02,  1.08s/it]Computing feature acts:  82%|████████▏ | 256/313 [04:14<01:01,  1.08s/it]Computing feature acts:  82%|████████▏ | 257/313 [04:15<01:00,  1.08s/it]Computing feature acts:  82%|████████▏ | 258/313 [04:16<00:59,  1.08s/it]Computing feature acts:  83%|████████▎ | 259/313 [04:17<00:57,  1.07s/it]Computing feature acts:  83%|████████▎ | 260/313 [04:18<00:55,  1.05s/it]Computing feature acts:  83%|████████▎ | 261/313 [04:19<00:53,  1.04s/it]Computing feature acts:  84%|████████▎ | 262/313 [04:20<00:52,  1.03s/it]Computing feature acts:  84%|████████▍ | 263/313 [04:21<00:51,  1.03s/it]Computing feature acts:  84%|████████▍ | 264/313 [04:22<00:50,  1.03s/it]Computing feature acts:  85%|████████▍ | 265/313 [04:23<00:49,  1.02s/it]Computing feature acts:  85%|████████▍ | 266/313 [04:24<00:47,  1.02s/it]Computing feature acts:  85%|████████▌ | 267/313 [04:25<00:46,  1.02s/it]Computing feature acts:  86%|████████▌ | 268/313 [04:26<00:45,  1.02s/it]Computing feature acts:  86%|████████▌ | 269/313 [04:27<00:45,  1.02s/it]Computing feature acts:  86%|████████▋ | 270/313 [04:28<00:43,  1.02s/it]Computing feature acts:  87%|████████▋ | 271/313 [04:29<00:43,  1.03s/it]Computing feature acts:  87%|████████▋ | 272/313 [04:30<00:42,  1.03s/it]Computing feature acts:  87%|████████▋ | 273/313 [04:31<00:41,  1.03s/it]Computing feature acts:  88%|████████▊ | 274/313 [04:33<00:40,  1.03s/it]Computing feature acts:  88%|████████▊ | 275/313 [04:34<00:39,  1.05s/it]Computing feature acts:  88%|████████▊ | 276/313 [04:35<00:38,  1.05s/it]Computing feature acts:  88%|████████▊ | 277/313 [04:36<00:37,  1.04s/it]Computing feature acts:  89%|████████▉ | 278/313 [04:37<00:36,  1.05s/it]Computing feature acts:  89%|████████▉ | 279/313 [04:38<00:35,  1.05s/it]Computing feature acts:  89%|████████▉ | 280/313 [04:39<00:34,  1.05s/it]Computing feature acts:  90%|████████▉ | 281/313 [04:40<00:33,  1.04s/it]Computing feature acts:  90%|█████████ | 282/313 [04:41<00:31,  1.03s/it]Computing feature acts:  90%|█████████ | 283/313 [04:42<00:30,  1.02s/it]Computing feature acts:  91%|█████████ | 284/313 [04:43<00:29,  1.02s/it]Computing feature acts:  91%|█████████ | 285/313 [04:44<00:28,  1.02s/it]Computing feature acts:  91%|█████████▏| 286/313 [04:45<00:27,  1.01s/it]Computing feature acts:  92%|█████████▏| 287/313 [04:46<00:25,  1.01it/s]Computing feature acts:  92%|█████████▏| 288/313 [04:47<00:24,  1.02it/s]Computing feature acts:  92%|█████████▏| 289/313 [04:48<00:23,  1.03it/s]Computing feature acts:  93%|█████████▎| 290/313 [04:49<00:22,  1.03it/s]Computing feature acts:  93%|█████████▎| 291/313 [04:50<00:21,  1.00it/s]Computing feature acts:  93%|█████████▎| 292/313 [04:51<00:20,  1.00it/s]Computing feature acts:  94%|█████████▎| 293/313 [04:52<00:20,  1.04s/it]Computing feature acts:  94%|█████████▍| 294/313 [04:53<00:19,  1.05s/it]Computing feature acts:  94%|█████████▍| 295/313 [04:54<00:18,  1.04s/it]Computing feature acts:  95%|█████████▍| 296/313 [04:55<00:17,  1.03s/it]Computing feature acts:  95%|█████████▍| 297/313 [04:56<00:16,  1.03s/it]Computing feature acts:  95%|█████████▌| 298/313 [04:57<00:15,  1.02s/it]Computing feature acts:  96%|█████████▌| 299/313 [04:58<00:14,  1.02s/it]Computing feature acts:  96%|█████████▌| 300/313 [04:59<00:13,  1.02s/it]Computing feature acts:  96%|█████████▌| 301/313 [05:00<00:12,  1.02s/it]Computing feature acts:  96%|█████████▋| 302/313 [05:01<00:11,  1.01s/it]Computing feature acts:  97%|█████████▋| 303/313 [05:02<00:10,  1.01s/it]Computing feature acts:  97%|█████████▋| 304/313 [05:03<00:09,  1.01s/it]Computing feature acts:  97%|█████████▋| 305/313 [05:04<00:08,  1.01s/it]Computing feature acts:  98%|█████████▊| 306/313 [05:05<00:07,  1.02s/it]Computing feature acts:  98%|█████████▊| 307/313 [05:06<00:06,  1.02s/it]Computing feature acts:  98%|█████████▊| 308/313 [05:07<00:05,  1.02s/it]Computing feature acts:  99%|█████████▊| 309/313 [05:08<00:04,  1.02s/it]Computing feature acts:  99%|█████████▉| 310/313 [05:09<00:03,  1.02s/it]Computing feature acts:  99%|█████████▉| 311/313 [05:10<00:02,  1.03s/it]Computing feature acts: 100%|█████████▉| 312/313 [05:11<00:01,  1.04s/it]Computing feature acts: 100%|██████████| 313/313 [05:12<00:00,  1.04s/it]Computing feature acts: 100%|██████████| 313/313 [05:13<00:00,  1.00s/it]
Parsing activation data:   0%|          | 0/1 [00:00<?, ?it/s]Parsing activation data: 100%|██████████| 1/1 [00:02<00:00,  2.58s/it]Parsing activation data: 100%|██████████| 1/1 [00:02<00:00,  2.58s/it]
2024-04-16 02:51:52 - INFO - Saving HTML feature dashboards for the SAE at blocks.10.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/1 [00:00<?, ?it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  3.90it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  3.90it/s]
2024-04-16 02:51:53 - INFO - Finished.
2024-04-16 02:51:53 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-6.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_m2hntlav/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-6.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_m2hntlav/config.yaml') n_samples=5000 batch_size=16 minibatch_size_features=50 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/regions/layer-10_region-1_local-m2hntlav_Orange_cluster_on_right') save_json_data=False sae_positions=None feature_indices=[25404, 25476, 25541, 25597, 25636, 25641, 25720, 25722, 25908, 25919, 25970, 26011, 26156, 26253, 26323, 26582, 26626, 26875, 27002, 27201, 27260, 27711, 27768, 27835, 27891, 28106, 28594, 28743, 28871, 29007, 29075, 29125, 29182, 29310, 29324, 29353, 29434, 29705, 29779, 29801, 30022, 30246, 30550, 30563, 30623, 30847, 30925, 30957, 31061, 31297, 31362, 31429, 31464, 31994, 32545, 32591, 32593, 32637, 32694, 32926, 33163, 33312, 33330, 33345, 33359, 33409, 33461, 33622, 33713, 33735, 33837, 34045, 34208, 34329, 34485, 34551, 34580, 34589, 34632, 34825, 35287, 35294, 35422, 35459, 35801, 35824, 35969, 36084, 36239, 36261, 36347, 36417, 36481, 36492, 36763, 36854, 36876, 36909, 36930, 37017, 37235, 37351, 37482, 37510, 37595, 37821, 37822, 37994, 38224, 38296, 38364, 38812, 38921, 39062, 39078, 39094, 39371, 39495, 39590, 39743, 39966, 40197, 40287, 40311, 40402, 40824, 40873, 40941, 40960, 41058, 41081, 41228, 41315, 41342, 41571, 41793, 42086, 42417, 42504, 42527, 42554, 42561, 42584, 42721, 43277, 43417, 43551, 43797, 43817, 43953, 44063, 44079, 44088, 44332, 44363, 44416, 44447, 44575, 44580, 44775, 44875, 44910, 44985, 45308, 45508, 45578, 45624, 45731, 46005, 46035, 46064, 46067, 46104, 46132, 46158, 46237, 46242, 46250, 46297, 46385, 46426, 46588, 46958, 46993, 46994, 47022, 47046, 47064, 47501, 47657, 47716, 47759, 47805, 47810, 47984, 48042, 48179, 48280, 48328, 48377, 48502, 48525, 48789, 48791, 48903, 49065, 49080, 49140, 49358, 49389, 49581, 49609, 49615, 49617, 50090, 50113, 50121, 50178, 50404, 50440, 50698, 50897, 50950, 50964, 51462, 51554, 51560, 51633, 51644, 51712, 51804, 51826, 51957, 52186, 52204, 52212, 52226, 52778, 52898, 53289, 53304, 53548, 53668, 53689, 53730, 53803, 53878, 53919, 54059, 54074, 54239, 54807, 55007, 55119, 55359, 55441, 55482, 55587, 55603, 55616, 55624, 55912, 55932, 55971, 56004, 56024, 56043, 56163, 56492, 56714, 56783, 56862, 56961, 57040, 57177, 57375, 57551, 57900, 58164, 58267, 58429] prompt_centric=None seed=0
2024-04-16 02:51:53 - INFO - Loading the model and SAEs
run_sae_path = /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-6.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_m2hntlav/samples_400000.pt
Traceback (most recent call last):
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 51, in <module>
    fire.Fire(main)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 48, in main
    generate_dashboards(dashbaords_config, run_sae_path)
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 998, in main
    model, _, _ = load_SAETransformer_from_saes_paths(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 943, in load_SAETransformer_from_saes_paths
    assert config_path.exists(), f"config_path: {config_path} does not exist"
AssertionError: config_path: /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-6.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.10.hook_resid_pre_m2hntlav/config.yaml does not exist
