no change     /data/jordan_tensor/miniconda3/condabin/conda
no change     /data/jordan_tensor/miniconda3/bin/conda
no change     /data/jordan_tensor/miniconda3/bin/conda-env
no change     /data/jordan_tensor/miniconda3/bin/activate
no change     /data/jordan_tensor/miniconda3/bin/deactivate
no change     /data/jordan_tensor/miniconda3/etc/profile.d/conda.sh
no change     /data/jordan_tensor/miniconda3/etc/fish/conf.d/conda.fish
no change     /data/jordan_tensor/miniconda3/shell/condabin/Conda.psm1
no change     /data/jordan_tensor/miniconda3/shell/condabin/conda-hook.ps1
no change     /data/jordan_tensor/miniconda3/lib/python3.12/site-packages/xontrib/conda.xsh
no change     /data/jordan_tensor/miniconda3/etc/profile.d/conda.csh
no change     /data/jordan_tensor/.bashrc
No action taken.

CondaError: Run 'conda init' before 'conda activate'

/data/jordan_tensor/dashboards/regions
2024-04-15 09:35:14 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/config.yaml') n_samples=3000 batch_size=16 minibatch_size_features=1000 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n') save_json_data=False sae_positions=None feature_indices=[180, 185, 332, 333, 554, 590, 655, 666, 856, 876, 893, 969, 1115, 1289, 1378, 1459, 1732, 1808, 1970, 2020, 2083, 2257, 2341, 2384, 2412, 2443, 2546, 2651, 2676, 2736, 3013, 3096, 3114, 3196, 3251, 3391, 3460, 3479, 3481, 3536, 4030, 4048, 4055, 4123, 4162, 4164, 4261, 4300, 4373, 4469, 4501, 4510, 4660, 4711, 4726, 4754, 4959, 4977, 4982, 5090, 5104, 5153, 5184, 5558, 5569, 5587, 5603, 5664, 5691, 5763, 5900, 5912, 5921, 6038, 6118, 6146, 6180, 6219, 6254, 6525, 6755, 6777, 6805, 6853, 6943, 6982, 7061, 7090, 7170, 7192, 7320, 7325, 7383, 7434, 7530, 7535, 7540, 7574, 7591, 7622, 7642, 7657, 7663, 7733, 7780, 7809, 7995, 8011, 8088, 8116, 8120, 8197, 8212, 8311, 8401, 8406, 8424, 8428, 8481, 8504, 8956, 9015, 9030, 9091, 9186, 9279, 9551, 9563, 9695, 9881, 9911, 9915, 9935, 10037, 10080, 10165, 10212, 10260, 10288, 10500, 10519, 10640, 10811, 10838, 10871, 10912, 11007, 11072, 11078, 11191, 11217, 11324, 11421, 11429, 11467, 11662, 11834, 12014, 12182, 12276, 12614, 12618, 12747, 12898, 12963, 13113, 13146, 13164, 13187, 13318, 13458, 13495, 13902, 14107, 14135, 14183, 14288, 14334, 14408, 14441, 14446, 14529, 14557, 14594, 14632, 14661, 14850, 14867, 14873, 14945, 14956, 15054, 15127, 15251, 15259, 15268, 15300, 15505, 15515, 15531, 15585, 15627, 15634, 15664, 15717, 16010, 16172, 16178, 16237, 16238, 16354, 16402, 16486, 16553, 16635, 16710, 16787, 16791, 17058, 17087, 17105, 17200, 17352, 17432, 17593, 17792, 17861, 17871, 17941, 18013, 18192, 18330, 18359, 18400, 18418, 18464, 18520, 18528, 18791, 18816, 18857, 18886, 18986, 19166, 19263, 19388, 19393, 19428, 19447, 19490, 19590, 19657, 19753, 19794, 19804, 19882, 19920, 19926, 19956, 20257, 20292, 20516, 20552, 20562, 20580, 20649, 20872, 20890, 20915, 20925, 21081, 21273, 21409, 21432, 21447, 21666, 21954, 21960, 22001, 22045, 22304] prompt_centric=None seed=0
2024-04-15 09:35:14 - INFO - Loading the model and SAEs
2024-04-15 09:35:14 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=0.5, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.2.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-15 09:35:18 - INFO - done
2024-04-15 09:35:18 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/188 [00:00<?, ?it/s]Computing feature acts:   1%|          | 1/188 [00:02<06:21,  2.04s/it]Computing feature acts:   1%|          | 2/188 [00:03<05:55,  1.91s/it]Computing feature acts:   2%|▏         | 3/188 [00:05<05:34,  1.81s/it]Computing feature acts:   2%|▏         | 4/188 [00:07<05:21,  1.75s/it]Computing feature acts:   3%|▎         | 5/188 [00:08<05:14,  1.72s/it]Computing feature acts:   3%|▎         | 6/188 [00:10<05:08,  1.70s/it]Computing feature acts:   4%|▎         | 7/188 [00:12<05:04,  1.68s/it]Computing feature acts:   4%|▍         | 8/188 [00:13<05:01,  1.68s/it]Computing feature acts:   5%|▍         | 9/188 [00:15<04:58,  1.67s/it]Computing feature acts:   5%|▌         | 10/188 [00:17<04:56,  1.67s/it]Computing feature acts:   6%|▌         | 11/188 [00:18<04:54,  1.66s/it]Computing feature acts:   6%|▋         | 12/188 [00:20<04:58,  1.70s/it]Computing feature acts:   7%|▋         | 13/188 [00:22<04:54,  1.68s/it]Computing feature acts:   7%|▋         | 14/188 [00:23<04:51,  1.68s/it]Computing feature acts:   8%|▊         | 15/188 [00:25<04:49,  1.67s/it]Computing feature acts:   9%|▊         | 16/188 [00:27<04:47,  1.67s/it]Computing feature acts:   9%|▉         | 17/188 [00:28<04:45,  1.67s/it]Computing feature acts:  10%|▉         | 18/188 [00:30<04:45,  1.68s/it]Computing feature acts:  10%|█         | 19/188 [00:32<04:48,  1.71s/it]Computing feature acts:  11%|█         | 20/188 [00:34<04:44,  1.69s/it]Computing feature acts:  11%|█         | 21/188 [00:35<04:41,  1.68s/it]Computing feature acts:  12%|█▏        | 22/188 [00:37<04:38,  1.68s/it]Computing feature acts:  12%|█▏        | 23/188 [00:39<04:36,  1.68s/it]Computing feature acts:  13%|█▎        | 24/188 [00:40<04:34,  1.67s/it]Computing feature acts:  13%|█▎        | 25/188 [00:42<04:31,  1.67s/it]Computing feature acts:  14%|█▍        | 26/188 [00:44<04:29,  1.67s/it]Computing feature acts:  14%|█▍        | 27/188 [00:45<04:27,  1.66s/it]Computing feature acts:  15%|█▍        | 28/188 [00:47<04:26,  1.67s/it]Computing feature acts:  15%|█▌        | 29/188 [00:49<04:24,  1.67s/it]Computing feature acts:  16%|█▌        | 30/188 [00:50<04:23,  1.66s/it]Computing feature acts:  16%|█▋        | 31/188 [00:52<04:21,  1.66s/it]Computing feature acts:  17%|█▋        | 32/188 [00:53<04:19,  1.66s/it]Computing feature acts:  18%|█▊        | 33/188 [00:55<04:17,  1.66s/it]Computing feature acts:  18%|█▊        | 34/188 [00:57<04:21,  1.70s/it]Computing feature acts:  19%|█▊        | 35/188 [00:59<04:18,  1.69s/it]Computing feature acts:  19%|█▉        | 36/188 [01:00<04:16,  1.68s/it]Computing feature acts:  20%|█▉        | 37/188 [01:02<04:13,  1.68s/it]Computing feature acts:  20%|██        | 38/188 [01:04<04:10,  1.67s/it]Computing feature acts:  21%|██        | 39/188 [01:05<04:08,  1.67s/it]Computing feature acts:  21%|██▏       | 40/188 [01:07<04:06,  1.67s/it]Computing feature acts:  22%|██▏       | 41/188 [01:09<04:04,  1.66s/it]Computing feature acts:  22%|██▏       | 42/188 [01:10<04:02,  1.66s/it]Computing feature acts:  23%|██▎       | 43/188 [01:12<04:02,  1.67s/it]Computing feature acts:  23%|██▎       | 44/188 [01:14<04:00,  1.67s/it]Computing feature acts:  24%|██▍       | 45/188 [01:15<03:58,  1.66s/it]Computing feature acts:  24%|██▍       | 46/188 [01:17<03:56,  1.66s/it]Computing feature acts:  25%|██▌       | 47/188 [01:19<03:54,  1.66s/it]Computing feature acts:  26%|██▌       | 48/188 [01:20<03:52,  1.66s/it]Computing feature acts:  26%|██▌       | 49/188 [01:22<03:51,  1.67s/it]Computing feature acts:  27%|██▋       | 50/188 [01:24<03:49,  1.67s/it]Computing feature acts:  27%|██▋       | 51/188 [01:25<03:48,  1.67s/it]Computing feature acts:  28%|██▊       | 52/188 [01:27<03:46,  1.67s/it]Computing feature acts:  28%|██▊       | 53/188 [01:29<03:44,  1.67s/it]Computing feature acts:  29%|██▊       | 54/188 [01:30<03:47,  1.70s/it]Computing feature acts:  29%|██▉       | 55/188 [01:32<03:44,  1.69s/it]Computing feature acts:  30%|██▉       | 56/188 [01:34<03:41,  1.68s/it]Computing feature acts:  30%|███       | 57/188 [01:35<03:39,  1.68s/it]Computing feature acts:  31%|███       | 58/188 [01:37<03:37,  1.67s/it]Computing feature acts:  31%|███▏      | 59/188 [01:39<03:35,  1.67s/it]Computing feature acts:  32%|███▏      | 60/188 [01:40<03:33,  1.67s/it]Computing feature acts:  32%|███▏      | 61/188 [01:42<03:31,  1.67s/it]Computing feature acts:  33%|███▎      | 62/188 [01:44<03:29,  1.67s/it]Computing feature acts:  34%|███▎      | 63/188 [01:45<03:27,  1.66s/it]Computing feature acts:  34%|███▍      | 64/188 [01:47<03:25,  1.66s/it]Computing feature acts:  35%|███▍      | 65/188 [01:49<03:24,  1.66s/it]Computing feature acts:  35%|███▌      | 66/188 [01:50<03:22,  1.66s/it]Computing feature acts:  36%|███▌      | 67/188 [01:52<03:38,  1.81s/it]Computing feature acts:  36%|███▌      | 68/188 [01:54<03:31,  1.77s/it]Computing feature acts:  37%|███▋      | 69/188 [01:56<03:26,  1.73s/it]Computing feature acts:  37%|███▋      | 70/188 [01:57<03:24,  1.73s/it]Computing feature acts:  38%|███▊      | 71/188 [01:59<03:20,  1.71s/it]Computing feature acts:  38%|███▊      | 72/188 [02:01<03:16,  1.70s/it]Computing feature acts:  39%|███▉      | 73/188 [02:02<03:14,  1.69s/it]Computing feature acts:  39%|███▉      | 74/188 [02:04<03:11,  1.68s/it]Computing feature acts:  40%|███▉      | 75/188 [02:06<03:09,  1.68s/it]Computing feature acts:  40%|████      | 76/188 [02:07<03:07,  1.67s/it]Computing feature acts:  41%|████      | 77/188 [02:09<03:04,  1.67s/it]Computing feature acts:  41%|████▏     | 78/188 [02:11<03:03,  1.67s/it]Computing feature acts:  42%|████▏     | 79/188 [02:12<03:01,  1.66s/it]Computing feature acts:  43%|████▎     | 80/188 [02:14<02:59,  1.66s/it]Computing feature acts:  43%|████▎     | 81/188 [02:16<02:57,  1.66s/it]Computing feature acts:  44%|████▎     | 82/188 [02:17<02:55,  1.66s/it]Computing feature acts:  44%|████▍     | 83/188 [02:19<02:54,  1.66s/it]Computing feature acts:  45%|████▍     | 84/188 [02:21<02:52,  1.66s/it]Computing feature acts:  45%|████▌     | 85/188 [02:22<02:51,  1.66s/it]Computing feature acts:  46%|████▌     | 86/188 [02:24<02:49,  1.66s/it]Computing feature acts:  46%|████▋     | 87/188 [02:26<02:47,  1.66s/it]Computing feature acts:  47%|████▋     | 88/188 [02:28<02:50,  1.71s/it]Computing feature acts:  47%|████▋     | 89/188 [02:29<02:47,  1.69s/it]Computing feature acts:  48%|████▊     | 90/188 [02:31<02:45,  1.68s/it]Computing feature acts:  48%|████▊     | 91/188 [02:33<02:42,  1.68s/it]Computing feature acts:  49%|████▉     | 92/188 [02:34<02:40,  1.67s/it]Computing feature acts:  49%|████▉     | 93/188 [02:36<02:38,  1.67s/it]Computing feature acts:  50%|█████     | 94/188 [02:38<02:36,  1.67s/it]Computing feature acts:  51%|█████     | 95/188 [02:39<02:34,  1.66s/it]Computing feature acts:  51%|█████     | 96/188 [02:41<02:33,  1.66s/it]Computing feature acts:  52%|█████▏    | 97/188 [02:43<02:32,  1.68s/it]Computing feature acts:  52%|█████▏    | 98/188 [02:44<02:30,  1.67s/it]Computing feature acts:  53%|█████▎    | 99/188 [02:46<02:32,  1.71s/it]Computing feature acts:  53%|█████▎    | 100/188 [02:48<02:29,  1.69s/it]Computing feature acts:  54%|█████▎    | 101/188 [02:49<02:26,  1.68s/it]Computing feature acts:  54%|█████▍    | 102/188 [02:51<02:24,  1.68s/it]Computing feature acts:  55%|█████▍    | 103/188 [02:53<02:21,  1.67s/it]Computing feature acts:  55%|█████▌    | 104/188 [02:54<02:19,  1.67s/it]Computing feature acts:  56%|█████▌    | 105/188 [02:56<02:18,  1.67s/it]Computing feature acts:  56%|█████▋    | 106/188 [02:58<02:16,  1.67s/it]Computing feature acts:  57%|█████▋    | 107/188 [02:59<02:14,  1.67s/it]Computing feature acts:  57%|█████▋    | 108/188 [03:01<02:13,  1.66s/it]Computing feature acts:  58%|█████▊    | 109/188 [03:03<02:11,  1.66s/it]Computing feature acts:  59%|█████▊    | 110/188 [03:04<02:09,  1.66s/it]Computing feature acts:  59%|█████▉    | 111/188 [03:06<02:08,  1.66s/it]Computing feature acts:  60%|█████▉    | 112/188 [03:08<02:06,  1.66s/it]Computing feature acts:  60%|██████    | 113/188 [03:09<02:04,  1.66s/it]Computing feature acts:  61%|██████    | 114/188 [03:11<02:04,  1.68s/it]Computing feature acts:  61%|██████    | 115/188 [03:13<02:02,  1.68s/it]Computing feature acts:  62%|██████▏   | 116/188 [03:14<02:00,  1.67s/it]Computing feature acts:  62%|██████▏   | 117/188 [03:16<02:00,  1.70s/it]Computing feature acts:  63%|██████▎   | 118/188 [03:18<01:58,  1.69s/it]Computing feature acts:  63%|██████▎   | 119/188 [03:19<01:55,  1.68s/it]Computing feature acts:  64%|██████▍   | 120/188 [03:21<01:53,  1.67s/it]Computing feature acts:  64%|██████▍   | 121/188 [03:23<01:51,  1.67s/it]Computing feature acts:  65%|██████▍   | 122/188 [03:24<01:50,  1.67s/it]Computing feature acts:  65%|██████▌   | 123/188 [03:26<01:48,  1.67s/it]Computing feature acts:  66%|██████▌   | 124/188 [03:28<01:46,  1.66s/it]Computing feature acts:  66%|██████▋   | 125/188 [03:29<01:45,  1.67s/it]Computing feature acts:  67%|██████▋   | 126/188 [03:31<01:43,  1.67s/it]Computing feature acts:  68%|██████▊   | 127/188 [03:33<01:41,  1.66s/it]Computing feature acts:  68%|██████▊   | 128/188 [03:34<01:39,  1.66s/it]Computing feature acts:  69%|██████▊   | 129/188 [03:36<01:38,  1.66s/it]Computing feature acts:  69%|██████▉   | 130/188 [03:38<01:38,  1.70s/it]Computing feature acts:  70%|██████▉   | 131/188 [03:40<01:36,  1.69s/it]Computing feature acts:  70%|███████   | 132/188 [03:41<01:34,  1.68s/it]Computing feature acts:  71%|███████   | 133/188 [03:43<01:32,  1.68s/it]Computing feature acts:  71%|███████▏  | 134/188 [03:45<01:31,  1.69s/it]Computing feature acts:  72%|███████▏  | 135/188 [03:46<01:28,  1.68s/it]Computing feature acts:  72%|███████▏  | 136/188 [03:48<01:26,  1.67s/it]Computing feature acts:  73%|███████▎  | 137/188 [03:50<01:25,  1.67s/it]Computing feature acts:  73%|███████▎  | 138/188 [03:51<01:23,  1.67s/it]Computing feature acts:  74%|███████▍  | 139/188 [03:53<01:21,  1.66s/it]Computing feature acts:  74%|███████▍  | 140/188 [03:55<01:19,  1.66s/it]Computing feature acts:  75%|███████▌  | 141/188 [03:56<01:18,  1.66s/it]Computing feature acts:  76%|███████▌  | 142/188 [03:58<01:16,  1.66s/it]Computing feature acts:  76%|███████▌  | 143/188 [03:59<01:14,  1.66s/it]Computing feature acts:  77%|███████▋  | 144/188 [04:01<01:13,  1.67s/it]Computing feature acts:  77%|███████▋  | 145/188 [04:03<01:11,  1.67s/it]Computing feature acts:  78%|███████▊  | 146/188 [04:05<01:10,  1.67s/it]Computing feature acts:  78%|███████▊  | 147/188 [04:06<01:08,  1.67s/it]Computing feature acts:  79%|███████▊  | 148/188 [04:08<01:06,  1.67s/it]Computing feature acts:  79%|███████▉  | 149/188 [04:10<01:04,  1.66s/it]Computing feature acts:  80%|███████▉  | 150/188 [04:11<01:03,  1.66s/it]Computing feature acts:  80%|████████  | 151/188 [04:13<01:01,  1.66s/it]Computing feature acts:  81%|████████  | 152/188 [04:14<00:59,  1.66s/it]Computing feature acts:  81%|████████▏ | 153/188 [04:16<00:58,  1.66s/it]Computing feature acts:  82%|████████▏ | 154/188 [04:18<00:56,  1.66s/it]Computing feature acts:  82%|████████▏ | 155/188 [04:19<00:54,  1.66s/it]Computing feature acts:  83%|████████▎ | 156/188 [04:21<00:53,  1.66s/it]Computing feature acts:  84%|████████▎ | 157/188 [04:23<00:51,  1.66s/it]Computing feature acts:  84%|████████▍ | 158/188 [04:24<00:49,  1.66s/it]Computing feature acts:  85%|████████▍ | 159/188 [04:26<00:48,  1.66s/it]Computing feature acts:  85%|████████▌ | 160/188 [04:28<00:46,  1.66s/it]Computing feature acts:  86%|████████▌ | 161/188 [04:29<00:44,  1.66s/it]Computing feature acts:  86%|████████▌ | 162/188 [04:31<00:43,  1.66s/it]Computing feature acts:  87%|████████▋ | 163/188 [04:33<00:41,  1.66s/it]Computing feature acts:  87%|████████▋ | 164/188 [04:35<00:40,  1.70s/it]Computing feature acts:  88%|████████▊ | 165/188 [04:35<00:33,  1.46s/it]Computing feature acts:  88%|████████▊ | 166/188 [04:36<00:28,  1.29s/it]Computing feature acts:  89%|████████▉ | 167/188 [04:37<00:24,  1.17s/it]Computing feature acts:  89%|████████▉ | 168/188 [04:38<00:21,  1.08s/it]Computing feature acts:  90%|████████▉ | 169/188 [04:39<00:19,  1.02s/it]Computing feature acts:  90%|█████████ | 170/188 [04:40<00:17,  1.02it/s]Computing feature acts:  91%|█████████ | 171/188 [04:41<00:16,  1.05it/s]Computing feature acts:  91%|█████████▏| 172/188 [04:42<00:14,  1.07it/s]Computing feature acts:  92%|█████████▏| 173/188 [04:43<00:13,  1.09it/s]Computing feature acts:  93%|█████████▎| 174/188 [04:43<00:12,  1.10it/s]Computing feature acts:  93%|█████████▎| 175/188 [04:44<00:11,  1.11it/s]Computing feature acts:  94%|█████████▎| 176/188 [04:45<00:10,  1.12it/s]Computing feature acts:  94%|█████████▍| 177/188 [04:47<00:12,  1.13s/it]Computing feature acts:  95%|█████████▍| 178/188 [04:48<00:11,  1.10s/it]Computing feature acts:  95%|█████████▌| 179/188 [04:49<00:09,  1.04s/it]Computing feature acts:  96%|█████████▌| 180/188 [04:50<00:07,  1.00it/s]Computing feature acts:  96%|█████████▋| 181/188 [04:51<00:06,  1.03it/s]Computing feature acts:  97%|█████████▋| 182/188 [04:51<00:05,  1.06it/s]Computing feature acts:  97%|█████████▋| 183/188 [04:52<00:04,  1.08it/s]Computing feature acts:  98%|█████████▊| 184/188 [04:53<00:03,  1.10it/s]Computing feature acts:  98%|█████████▊| 185/188 [04:54<00:02,  1.11it/s]Computing feature acts:  99%|█████████▉| 186/188 [04:55<00:01,  1.11it/s]Computing feature acts:  99%|█████████▉| 187/188 [04:56<00:00,  1.04it/s]Computing feature acts: 100%|██████████| 188/188 [04:57<00:00,  1.06it/s]Computing feature acts: 100%|██████████| 188/188 [04:58<00:00,  1.59s/it]
Parsing activation data:   0%|          | 0/1 [00:00<?, ?it/s]Parsing activation data: 100%|██████████| 1/1 [00:09<00:00,  9.37s/it]Parsing activation data: 100%|██████████| 1/1 [00:09<00:00,  9.37s/it]
2024-04-15 09:40:31 - INFO - Saving HTML feature dashboards for the SAE at blocks.2.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/1 [00:00<?, ?it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:05<00:00,  5.67s/it]Dashboard HTML files: 100%|██████████| 1/1 [00:05<00:00,  5.67s/it]
2024-04-15 09:40:37 - INFO - Finished.
2024-04-15 09:40:37 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/config.yaml') n_samples=3000 batch_size=16 minibatch_size_features=1000 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7') save_json_data=False sae_positions=None feature_indices=[32091, 32206, 52129, 61781] prompt_centric=None seed=0
2024-04-15 09:40:37 - INFO - Loading the model and SAEs
2024-04-15 09:40:37 - INFO - wandb_project='gpt2-layerwise_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/mnt/ssd-interp/dan/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=40000 eval_n_samples=500 batch_size=8 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=0.8, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=1.0), logits_kl=None) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.2.hook_resid_pre'])
2024-04-15 09:40:40 - INFO - done
2024-04-15 09:40:40 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7
run_sae_path = /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Traceback (most recent call last):
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 51, in <module>
    fire.Fire(main)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 48, in main
    generate_dashboards(dashbaords_config, run_sae_path)
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 1005, in main
    generate_dashboards(model, dashboards_config, save_dir=save_dir)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 852, in generate_dashboards
    dashboards_data: dict[str, SaeVisData] = get_dashboards_data(
                                             ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 385, in get_dashboards_data
    assert (
AssertionError: Error: Some feature indices are greater than the number of SAE features
2024-04-15 09:40:46 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/config.yaml') n_samples=3000 batch_size=16 minibatch_size_features=1000 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n') save_json_data=False sae_positions=None feature_indices=[199, 232, 481, 801, 1681, 1959, 2605, 3169, 3784, 4494, 5111, 7829, 8467, 8483, 9521, 10000, 10058, 10360, 10370, 12169, 13346, 15308, 18384, 18442, 18783, 19021, 19567, 21368] prompt_centric=None seed=0
2024-04-15 09:40:46 - INFO - Loading the model and SAEs
2024-04-15 09:40:46 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=0.5, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.2.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-15 09:40:59 - INFO - done
2024-04-15 09:40:59 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/188 [00:00<?, ?it/s]Computing feature acts:   1%|          | 1/188 [00:01<03:41,  1.19s/it]Computing feature acts:   1%|          | 2/188 [00:02<03:20,  1.08s/it]Computing feature acts:   2%|▏         | 3/188 [00:03<03:15,  1.06s/it]Computing feature acts:   2%|▏         | 4/188 [00:04<03:12,  1.05s/it]Computing feature acts:   3%|▎         | 5/188 [00:05<03:09,  1.04s/it]Computing feature acts:   3%|▎         | 6/188 [00:06<03:07,  1.03s/it]Computing feature acts:   4%|▎         | 7/188 [00:07<03:06,  1.03s/it]Computing feature acts:   4%|▍         | 8/188 [00:08<03:05,  1.03s/it]Computing feature acts:   5%|▍         | 9/188 [00:09<03:03,  1.03s/it]Computing feature acts:   5%|▌         | 10/188 [00:10<02:53,  1.03it/s]Computing feature acts:   6%|▌         | 11/188 [00:11<02:47,  1.05it/s]Computing feature acts:   6%|▋         | 12/188 [00:11<02:43,  1.08it/s]Computing feature acts:   7%|▋         | 13/188 [00:13<02:52,  1.02it/s]Computing feature acts:   7%|▋         | 14/188 [00:13<02:46,  1.05it/s]Computing feature acts:   8%|▊         | 15/188 [00:14<02:43,  1.06it/s]Computing feature acts:   9%|▊         | 16/188 [00:15<02:42,  1.06it/s]Computing feature acts:   9%|▉         | 17/188 [00:16<02:41,  1.06it/s]Computing feature acts:  10%|▉         | 18/188 [00:18<03:17,  1.16s/it]Computing feature acts:  10%|█         | 19/188 [00:19<03:04,  1.09s/it]Computing feature acts:  11%|█         | 20/188 [00:20<02:53,  1.03s/it]Computing feature acts:  11%|█         | 21/188 [00:21<02:44,  1.01it/s]Computing feature acts:  12%|█▏        | 22/188 [00:22<02:38,  1.05it/s]Computing feature acts:  12%|█▏        | 23/188 [00:23<03:10,  1.16s/it]Computing feature acts:  13%|█▎        | 24/188 [00:25<03:34,  1.31s/it]Computing feature acts:  13%|█▎        | 25/188 [00:27<03:51,  1.42s/it]Computing feature acts:  14%|█▍        | 26/188 [00:27<03:25,  1.27s/it]Computing feature acts:  14%|█▍        | 27/188 [00:28<03:10,  1.18s/it]Computing feature acts:  15%|█▍        | 28/188 [00:29<03:00,  1.13s/it]Computing feature acts:  15%|█▌        | 29/188 [00:31<02:59,  1.13s/it]Computing feature acts:  16%|█▌        | 30/188 [00:32<02:53,  1.10s/it]Computing feature acts:  16%|█▋        | 31/188 [00:33<02:54,  1.11s/it]Computing feature acts:  17%|█▋        | 32/188 [00:34<02:49,  1.09s/it]Computing feature acts:  18%|█▊        | 33/188 [00:35<02:45,  1.07s/it]Computing feature acts:  18%|█▊        | 34/188 [00:36<02:42,  1.05s/it]Computing feature acts:  19%|█▊        | 35/188 [00:37<02:39,  1.04s/it]Computing feature acts:  19%|█▉        | 36/188 [00:38<02:37,  1.04s/it]Computing feature acts:  20%|█▉        | 37/188 [00:39<02:35,  1.03s/it]Computing feature acts:  20%|██        | 38/188 [00:40<02:34,  1.03s/it]Computing feature acts:  21%|██        | 39/188 [00:41<02:32,  1.02s/it]Computing feature acts:  21%|██▏       | 40/188 [00:42<02:31,  1.02s/it]Computing feature acts:  22%|██▏       | 41/188 [00:43<02:29,  1.02s/it]Computing feature acts:  22%|██▏       | 42/188 [00:44<02:28,  1.02s/it]Computing feature acts:  23%|██▎       | 43/188 [00:45<02:27,  1.02s/it]Computing feature acts:  23%|██▎       | 44/188 [00:46<02:26,  1.02s/it]Computing feature acts:  24%|██▍       | 45/188 [00:47<02:29,  1.05s/it]Computing feature acts:  24%|██▍       | 46/188 [00:48<02:24,  1.02s/it]Computing feature acts:  25%|██▌       | 47/188 [00:49<02:20,  1.00it/s]Computing feature acts:  26%|██▌       | 48/188 [00:50<02:17,  1.02it/s]Computing feature acts:  26%|██▌       | 49/188 [00:51<02:15,  1.03it/s]Computing feature acts:  27%|██▋       | 50/188 [00:52<02:13,  1.04it/s]Computing feature acts:  27%|██▋       | 51/188 [00:53<02:11,  1.04it/s]Computing feature acts:  28%|██▊       | 52/188 [00:54<02:10,  1.04it/s]Computing feature acts:  28%|██▊       | 53/188 [00:55<02:10,  1.03it/s]Computing feature acts:  29%|██▊       | 54/188 [00:56<02:36,  1.17s/it]Computing feature acts:  29%|██▉       | 55/188 [00:58<02:55,  1.32s/it]Computing feature acts:  30%|██▉       | 56/188 [01:00<03:08,  1.43s/it]Computing feature acts:  30%|███       | 57/188 [01:01<03:17,  1.50s/it]Computing feature acts:  31%|███       | 58/188 [01:03<03:22,  1.56s/it]Computing feature acts:  31%|███▏      | 59/188 [01:05<03:25,  1.59s/it]Computing feature acts:  32%|███▏      | 60/188 [01:06<03:28,  1.63s/it]Computing feature acts:  32%|███▏      | 61/188 [01:08<03:29,  1.65s/it]Computing feature acts:  33%|███▎      | 62/188 [01:10<03:25,  1.63s/it]Computing feature acts:  34%|███▎      | 63/188 [01:11<02:55,  1.40s/it]Computing feature acts:  34%|███▍      | 64/188 [01:11<02:34,  1.25s/it]Computing feature acts:  35%|███▍      | 65/188 [01:12<02:20,  1.14s/it]Computing feature acts:  35%|███▌      | 66/188 [01:13<02:10,  1.07s/it]Computing feature acts:  36%|███▌      | 67/188 [01:14<02:02,  1.01s/it]Computing feature acts:  36%|███▌      | 68/188 [01:16<02:22,  1.18s/it]Computing feature acts:  37%|███▋      | 69/188 [01:17<02:11,  1.10s/it]Computing feature acts:  37%|███▋      | 70/188 [01:18<02:05,  1.06s/it]Computing feature acts:  38%|███▊      | 71/188 [01:19<01:57,  1.01s/it]Computing feature acts:  38%|███▊      | 72/188 [01:19<01:52,  1.03it/s]Computing feature acts:  39%|███▉      | 73/188 [01:20<01:48,  1.06it/s]Computing feature acts:  39%|███▉      | 74/188 [01:21<01:52,  1.01it/s]Computing feature acts:  40%|███▉      | 75/188 [01:22<01:48,  1.04it/s]Computing feature acts:  40%|████      | 76/188 [01:24<02:05,  1.12s/it]Computing feature acts:  41%|████      | 77/188 [01:25<02:04,  1.12s/it]Computing feature acts:  41%|████▏     | 78/188 [01:26<01:55,  1.05s/it]Computing feature acts:  42%|████▏     | 79/188 [01:27<01:49,  1.01s/it]Computing feature acts:  43%|████▎     | 80/188 [01:28<01:45,  1.03it/s]Computing feature acts:  43%|████▎     | 81/188 [01:28<01:41,  1.05it/s]Computing feature acts:  44%|████▎     | 82/188 [01:29<01:38,  1.07it/s]Computing feature acts:  44%|████▍     | 83/188 [01:30<01:36,  1.09it/s]Computing feature acts:  45%|████▍     | 84/188 [01:31<01:34,  1.10it/s]Computing feature acts:  45%|████▌     | 85/188 [01:32<01:33,  1.10it/s]Computing feature acts:  46%|████▌     | 86/188 [01:33<01:32,  1.10it/s]Computing feature acts:  46%|████▋     | 87/188 [01:34<01:34,  1.07it/s]Computing feature acts:  47%|████▋     | 88/188 [01:35<01:37,  1.03it/s]Computing feature acts:  47%|████▋     | 89/188 [01:36<01:38,  1.01it/s]Computing feature acts:  48%|████▊     | 90/188 [01:37<01:38,  1.01s/it]Computing feature acts:  48%|████▊     | 91/188 [01:38<01:38,  1.02s/it]Computing feature acts:  49%|████▉     | 92/188 [01:39<01:37,  1.02s/it]Computing feature acts:  49%|████▉     | 93/188 [01:40<01:39,  1.05s/it]Computing feature acts:  50%|█████     | 94/188 [01:41<01:38,  1.05s/it]Computing feature acts:  51%|█████     | 95/188 [01:42<01:37,  1.04s/it]Computing feature acts:  51%|█████     | 96/188 [01:43<01:38,  1.07s/it]Computing feature acts:  52%|█████▏    | 97/188 [01:45<01:36,  1.06s/it]Computing feature acts:  52%|█████▏    | 98/188 [01:46<01:35,  1.06s/it]Computing feature acts:  53%|█████▎    | 99/188 [01:47<01:33,  1.05s/it]Computing feature acts:  53%|█████▎    | 100/188 [01:48<01:32,  1.05s/it]Computing feature acts:  54%|█████▎    | 101/188 [01:49<01:31,  1.05s/it]Computing feature acts:  54%|█████▍    | 102/188 [01:50<01:29,  1.04s/it]Computing feature acts:  55%|█████▍    | 103/188 [01:51<01:28,  1.04s/it]Computing feature acts:  55%|█████▌    | 104/188 [01:52<01:22,  1.01it/s]Computing feature acts:  56%|█████▌    | 105/188 [01:53<01:21,  1.02it/s]Computing feature acts:  56%|█████▋    | 106/188 [01:54<01:18,  1.04it/s]Computing feature acts:  57%|█████▋    | 107/188 [01:55<01:34,  1.17s/it]Computing feature acts:  57%|█████▋    | 108/188 [01:57<01:46,  1.33s/it]Computing feature acts:  58%|█████▊    | 109/188 [01:59<01:53,  1.44s/it]Computing feature acts:  59%|█████▊    | 110/188 [02:00<01:48,  1.39s/it]Computing feature acts:  59%|█████▉    | 111/188 [02:02<01:53,  1.48s/it]Computing feature acts:  60%|█████▉    | 112/188 [02:03<01:57,  1.54s/it]Computing feature acts:  60%|██████    | 113/188 [02:05<01:56,  1.55s/it]Computing feature acts:  61%|██████    | 114/188 [02:06<01:40,  1.36s/it]Computing feature acts:  61%|██████    | 115/188 [02:07<01:31,  1.25s/it]Computing feature acts:  62%|██████▏   | 116/188 [02:08<01:29,  1.25s/it]Computing feature acts:  62%|██████▏   | 117/188 [02:09<01:22,  1.16s/it]Computing feature acts:  63%|██████▎   | 118/188 [02:10<01:16,  1.10s/it]Computing feature acts:  63%|██████▎   | 119/188 [02:11<01:12,  1.06s/it]Computing feature acts:  64%|██████▍   | 120/188 [02:12<01:09,  1.03s/it]Computing feature acts:  64%|██████▍   | 121/188 [02:13<01:07,  1.01s/it]Computing feature acts:  65%|██████▍   | 122/188 [02:14<01:05,  1.01it/s]Computing feature acts:  65%|██████▌   | 123/188 [02:15<01:04,  1.02it/s]Computing feature acts:  66%|██████▌   | 124/188 [02:16<01:02,  1.02it/s]Computing feature acts:  66%|██████▋   | 125/188 [02:20<02:11,  2.08s/it]Computing feature acts:  67%|██████▋   | 126/188 [02:21<01:48,  1.75s/it]Computing feature acts:  68%|██████▊   | 127/188 [02:22<01:32,  1.51s/it]Computing feature acts:  68%|██████▊   | 128/188 [02:23<01:20,  1.35s/it]Computing feature acts:  69%|██████▊   | 129/188 [02:24<01:12,  1.23s/it]Computing feature acts:  69%|██████▉   | 130/188 [02:25<01:06,  1.15s/it]Computing feature acts:  70%|██████▉   | 131/188 [02:26<01:02,  1.09s/it]Computing feature acts:  70%|███████   | 132/188 [02:27<00:58,  1.05s/it]Computing feature acts:  71%|███████   | 133/188 [02:28<00:56,  1.02s/it]Computing feature acts:  71%|███████▏  | 134/188 [02:29<00:54,  1.00s/it]Computing feature acts:  72%|███████▏  | 135/188 [02:30<00:52,  1.01it/s]Computing feature acts:  72%|███████▏  | 136/188 [02:31<00:50,  1.02it/s]Computing feature acts:  73%|███████▎  | 137/188 [02:32<00:49,  1.03it/s]Computing feature acts:  73%|███████▎  | 138/188 [02:33<00:48,  1.03it/s]Computing feature acts:  74%|███████▍  | 139/188 [02:34<00:47,  1.03it/s]Computing feature acts:  74%|███████▍  | 140/188 [02:35<00:46,  1.04it/s]Computing feature acts:  75%|███████▌  | 141/188 [02:36<00:48,  1.02s/it]Computing feature acts:  76%|███████▌  | 142/188 [02:37<00:46,  1.00s/it]Computing feature acts:  76%|███████▌  | 143/188 [02:38<00:44,  1.01it/s]Computing feature acts:  77%|███████▋  | 144/188 [02:39<00:43,  1.02it/s]Computing feature acts:  77%|███████▋  | 145/188 [02:40<00:41,  1.03it/s]Computing feature acts:  78%|███████▊  | 146/188 [02:41<00:40,  1.03it/s]Computing feature acts:  78%|███████▊  | 147/188 [02:41<00:38,  1.07it/s]Computing feature acts:  79%|███████▊  | 148/188 [02:42<00:37,  1.08it/s]Computing feature acts:  79%|███████▉  | 149/188 [02:43<00:35,  1.09it/s]Computing feature acts:  80%|███████▉  | 150/188 [02:45<00:43,  1.15s/it]Computing feature acts:  80%|████████  | 151/188 [02:47<00:48,  1.30s/it]Computing feature acts:  81%|████████  | 152/188 [02:49<00:55,  1.53s/it]Computing feature acts:  81%|████████▏ | 153/188 [02:51<00:56,  1.62s/it]Computing feature acts:  82%|████████▏ | 154/188 [02:52<00:55,  1.64s/it]Computing feature acts:  82%|████████▏ | 155/188 [02:54<00:52,  1.58s/it]Computing feature acts:  83%|████████▎ | 156/188 [02:55<00:45,  1.41s/it]Computing feature acts:  84%|████████▎ | 157/188 [02:56<00:43,  1.40s/it]Computing feature acts:  84%|████████▍ | 158/188 [02:57<00:38,  1.29s/it]Computing feature acts:  85%|████████▍ | 159/188 [02:58<00:35,  1.22s/it]Computing feature acts:  85%|████████▌ | 160/188 [02:59<00:32,  1.16s/it]Computing feature acts:  86%|████████▌ | 161/188 [03:00<00:31,  1.17s/it]Computing feature acts:  86%|████████▌ | 162/188 [03:01<00:29,  1.13s/it]Computing feature acts:  87%|████████▋ | 163/188 [03:02<00:27,  1.11s/it]Computing feature acts:  87%|████████▋ | 164/188 [03:04<00:26,  1.10s/it]Computing feature acts:  88%|████████▊ | 165/188 [03:05<00:25,  1.09s/it]Computing feature acts:  88%|████████▊ | 166/188 [03:06<00:23,  1.08s/it]Computing feature acts:  89%|████████▉ | 167/188 [03:07<00:22,  1.08s/it]Computing feature acts:  89%|████████▉ | 168/188 [03:08<00:21,  1.08s/it]Computing feature acts:  90%|████████▉ | 169/188 [03:09<00:20,  1.08s/it]Computing feature acts:  90%|█████████ | 170/188 [03:10<00:19,  1.08s/it]Computing feature acts:  91%|█████████ | 171/188 [03:11<00:18,  1.07s/it]Computing feature acts:  91%|█████████▏| 172/188 [03:12<00:17,  1.07s/it]Computing feature acts:  92%|█████████▏| 173/188 [03:13<00:16,  1.10s/it]Computing feature acts:  93%|█████████▎| 174/188 [03:14<00:14,  1.06s/it]Computing feature acts:  93%|█████████▎| 175/188 [03:15<00:13,  1.02s/it]Computing feature acts:  94%|█████████▎| 176/188 [03:16<00:12,  1.01s/it]Computing feature acts:  94%|█████████▍| 177/188 [03:17<00:10,  1.01it/s]Computing feature acts:  95%|█████████▍| 178/188 [03:18<00:09,  1.02it/s]Computing feature acts:  95%|█████████▌| 179/188 [03:19<00:08,  1.03it/s]Computing feature acts:  96%|█████████▌| 180/188 [03:20<00:07,  1.03it/s]Computing feature acts:  96%|█████████▋| 181/188 [03:21<00:06,  1.04it/s]Computing feature acts:  97%|█████████▋| 182/188 [03:22<00:05,  1.03it/s]Computing feature acts:  97%|█████████▋| 183/188 [03:23<00:04,  1.05it/s]Computing feature acts:  98%|█████████▊| 184/188 [03:24<00:03,  1.04it/s]Computing feature acts:  98%|█████████▊| 185/188 [03:25<00:02,  1.04it/s]Computing feature acts:  99%|█████████▉| 186/188 [03:26<00:02,  1.10s/it]Computing feature acts:  99%|█████████▉| 187/188 [03:27<00:01,  1.13s/it]Computing feature acts: 100%|██████████| 188/188 [03:28<00:00,  1.11s/it]Computing feature acts: 100%|██████████| 188/188 [03:30<00:00,  1.12s/it]
Parsing activation data:   0%|          | 0/1 [00:00<?, ?it/s]Parsing activation data: 100%|██████████| 1/1 [00:02<00:00,  2.66s/it]Parsing activation data: 100%|██████████| 1/1 [00:02<00:00,  2.66s/it]
2024-04-15 09:44:43 - INFO - Saving HTML feature dashboards for the SAE at blocks.2.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/1 [00:00<?, ?it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  3.73it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  3.73it/s]
2024-04-15 09:44:44 - INFO - Finished.
2024-04-15 09:44:44 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/config.yaml') n_samples=3000 batch_size=16 minibatch_size_features=1000 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7') save_json_data=False sae_positions=None feature_indices=[22363, 22433, 22442, 22460, 22500, 22695, 22788, 22888, 22966, 23178, 23196, 23271, 23330, 23481, 23556, 23560, 23720, 23979, 24003, 24096, 24276, 24282, 24569, 24582, 24694, 24754, 24785, 24849, 24912, 25106, 25150, 25204, 25209, 25225, 25276, 25369, 25398, 25724, 25764, 25813, 25827, 25842, 26122, 26155, 26214, 26228, 26307, 26334, 26406, 26415, 26505, 26507, 26525, 26549, 26607, 26834, 26848, 26853, 26932, 26957, 27047, 27070, 27125, 27441, 27476, 27502, 27572, 27600, 27765, 27819, 27913, 28009, 28308, 28332, 28420, 28541, 28749, 28934, 28995, 29038, 29110, 29149, 29156, 29168, 29229, 29257, 29377, 29408, 29724, 29762, 29845, 29904, 29930, 29997, 30083, 30120, 30149, 30239, 30334, 30547, 30574, 30793, 30878, 30892, 30901, 30953, 31140, 31155, 31359, 31411, 31448, 31511, 31632, 31657, 31779, 31966, 32262, 32446, 32487, 32505, 32699, 32717, 32725, 32787, 32793, 32865, 32902, 32913, 33055, 33068, 33125, 33243, 33290, 33387, 33497, 33549, 33814, 33865, 34102, 34161, 34401, 34509, 34560, 35028, 35212, 35327, 35410, 35438, 35502, 35532, 35575, 35706, 35816, 36104, 36111, 36359, 36470, 36490, 36528, 36543, 36554, 36615, 36635, 36649, 36841, 36916, 36966, 37019, 37203, 37293, 37521, 37626, 37637, 37700, 37889, 37982, 38053, 38080, 38081, 38261, 38378, 38511, 38526, 38652, 38771, 38952, 38980, 39146, 39269, 39455, 39542, 39618, 39805, 39869, 39965, 40113, 40255, 40566, 40585, 40595, 40603, 40635, 40705, 40764, 40808, 40812, 40861, 40874, 40930, 41063, 41219, 41435, 41448, 41529, 41543, 41564, 42347, 42396, 42768, 42825, 42874, 42928, 42941, 43043, 43120, 43285, 43312, 43367, 43381, 43433, 43435, 43693, 43703, 43751, 43856, 44247, 44315, 44550, 44571, 44944, 44958, 45249, 45265, 45309, 45311, 45723, 45734, 45765, 45985, 46009, 46131, 46156, 46204, 46261, 46458, 46463, 46580, 46640, 46705, 46823, 46861, 46953, 47139, 47160, 47211, 47377, 47445, 47474, 47677, 47703, 47706, 47854, 47890, 47936, 47963, 48223, 48408, 48592, 48603, 48662, 48869, 48945, 48989, 49052, 49489, 49544, 49615, 49621, 49673, 49948, 50000, 50040, 50182, 50245, 50396, 50771, 50789, 50850, 51173, 51313, 51396, 51505, 51794, 51883, 51908, 51983, 52036, 52225, 52416, 52458, 52571, 52690, 52712, 52779, 52780, 52898, 52985, 53135, 53139, 53342, 53392, 53619, 53633, 53709, 53766, 53970, 54026, 54158, 54165, 54177, 54219, 54237, 54359, 54589, 54590, 54673, 54949, 55074, 55093, 55248, 55266, 55297, 55358, 55411, 55476, 55480, 55716, 55764, 55822, 55996, 56114, 56147, 56156, 56202, 56255, 56286, 56437, 56444, 56458, 56567, 56697, 56814, 56828, 56850, 56969, 56970, 57085, 57162, 57237, 57512, 57543, 57706, 57910, 57969, 58176, 58224, 58247, 58520, 58546, 58573, 58822, 58885, 58912, 58984, 59040, 59141, 59153, 59307, 59344, 59418, 59421, 59526, 59582, 59591, 59630, 59659, 59786, 59884, 60075, 60120, 60330, 60418, 60445, 60464, 60544, 60664, 60698, 60999, 61130, 61225, 61606, 61662, 61701, 61712, 61790, 61908, 61954, 61961, 62020, 62026, 62062, 62108, 62126, 62419, 62515, 62524, 62726, 62854, 62862, 63263, 63286, 63304, 63345, 63369, 63543, 63616, 63688, 63718] prompt_centric=None seed=0
2024-04-15 09:44:44 - INFO - Loading the model and SAEs
2024-04-15 09:44:44 - INFO - wandb_project='gpt2-layerwise_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/mnt/ssd-interp/dan/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=40000 eval_n_samples=500 batch_size=8 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=0.8, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=1.0), logits_kl=None) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.2.hook_resid_pre'])
2024-04-15 09:44:55 - INFO - done
2024-04-15 09:44:55 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7
run_sae_path = /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Traceback (most recent call last):
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 51, in <module>
    fire.Fire(main)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 48, in main
    generate_dashboards(dashbaords_config, run_sae_path)
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 1005, in main
    generate_dashboards(model, dashboards_config, save_dir=save_dir)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 852, in generate_dashboards
    dashboards_data: dict[str, SaeVisData] = get_dashboards_data(
                                             ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 385, in get_dashboards_data
    assert (
AssertionError: Error: Some feature indices are greater than the number of SAE features
2024-04-15 09:45:02 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/config.yaml') n_samples=3000 batch_size=16 minibatch_size_features=1000 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n') save_json_data=False sae_positions=None feature_indices=[1917, 2121, 3230, 7253, 8458, 8659, 8723, 8933, 9453, 10051, 10915, 11280, 11484, 11645, 11889, 12653, 14097, 15061, 15278, 15422, 15540, 16372, 16760, 18345, 18751, 19115, 20813] prompt_centric=None seed=0
2024-04-15 09:45:02 - INFO - Loading the model and SAEs
2024-04-15 09:45:02 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=0.5, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.2.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-15 09:45:14 - INFO - done
2024-04-15 09:45:14 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-0.5_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ovhfts9n/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/188 [00:00<?, ?it/s]Computing feature acts:   1%|          | 1/188 [00:02<06:25,  2.06s/it]Computing feature acts:   1%|          | 2/188 [00:02<04:09,  1.34s/it]Computing feature acts:   2%|▏         | 3/188 [00:03<03:28,  1.13s/it]Computing feature acts:   2%|▏         | 4/188 [00:04<03:08,  1.02s/it]Computing feature acts:   3%|▎         | 5/188 [00:05<02:57,  1.03it/s]Computing feature acts:   3%|▎         | 6/188 [00:06<02:49,  1.07it/s]Computing feature acts:   4%|▎         | 7/188 [00:07<02:45,  1.09it/s]Computing feature acts:   4%|▍         | 8/188 [00:08<02:41,  1.11it/s]Computing feature acts:   5%|▍         | 9/188 [00:08<02:39,  1.12it/s]Computing feature acts:   5%|▌         | 10/188 [00:09<02:40,  1.11it/s]Computing feature acts:   6%|▌         | 11/188 [00:10<02:38,  1.12it/s]Computing feature acts:   6%|▋         | 12/188 [00:11<02:35,  1.13it/s]Computing feature acts:   7%|▋         | 13/188 [00:12<02:33,  1.14it/s]Computing feature acts:   7%|▋         | 14/188 [00:13<02:37,  1.10it/s]Computing feature acts:   8%|▊         | 15/188 [00:14<02:35,  1.12it/s]Computing feature acts:   9%|▊         | 16/188 [00:15<02:32,  1.13it/s]Computing feature acts:   9%|▉         | 17/188 [00:16<02:30,  1.13it/s]Computing feature acts:  10%|▉         | 18/188 [00:17<02:32,  1.12it/s]Computing feature acts:  10%|█         | 19/188 [00:17<02:29,  1.13it/s]Computing feature acts:  11%|█         | 20/188 [00:18<02:28,  1.13it/s]Computing feature acts:  11%|█         | 21/188 [00:19<02:27,  1.13it/s]Computing feature acts:  12%|█▏        | 22/188 [00:20<02:30,  1.10it/s]Computing feature acts:  12%|█▏        | 23/188 [00:21<02:28,  1.11it/s]Computing feature acts:  13%|█▎        | 24/188 [00:22<02:26,  1.12it/s]Computing feature acts:  13%|█▎        | 25/188 [00:23<02:24,  1.13it/s]Computing feature acts:  14%|█▍        | 26/188 [00:24<02:25,  1.11it/s]Computing feature acts:  14%|█▍        | 27/188 [00:25<02:23,  1.12it/s]Computing feature acts:  15%|█▍        | 28/188 [00:25<02:22,  1.12it/s]Computing feature acts:  15%|█▌        | 29/188 [00:26<02:21,  1.13it/s]Computing feature acts:  16%|█▌        | 30/188 [00:27<02:24,  1.09it/s]Computing feature acts:  16%|█▋        | 31/188 [00:28<02:28,  1.06it/s]Computing feature acts:  17%|█▋        | 32/188 [00:29<02:25,  1.07it/s]Computing feature acts:  18%|█▊        | 33/188 [00:30<02:25,  1.07it/s]Computing feature acts:  18%|█▊        | 34/188 [00:31<02:28,  1.04it/s]Computing feature acts:  19%|█▊        | 35/188 [00:32<02:26,  1.04it/s]Computing feature acts:  19%|█▉        | 36/188 [00:33<02:24,  1.05it/s]Computing feature acts:  20%|█▉        | 37/188 [00:34<02:19,  1.09it/s]Computing feature acts:  20%|██        | 38/188 [00:35<02:18,  1.09it/s]Computing feature acts:  21%|██        | 39/188 [00:36<02:14,  1.10it/s]Computing feature acts:  21%|██▏       | 40/188 [00:37<02:12,  1.12it/s]Computing feature acts:  22%|██▏       | 41/188 [00:37<02:10,  1.12it/s]Computing feature acts:  22%|██▏       | 42/188 [00:38<02:11,  1.11it/s]Computing feature acts:  23%|██▎       | 43/188 [00:39<02:09,  1.12it/s]Computing feature acts:  23%|██▎       | 44/188 [00:40<02:08,  1.12it/s]Computing feature acts:  24%|██▍       | 45/188 [00:41<02:06,  1.13it/s]Computing feature acts:  24%|██▍       | 46/188 [00:42<02:08,  1.11it/s]Computing feature acts:  25%|██▌       | 47/188 [00:43<02:06,  1.12it/s]Computing feature acts:  26%|██▌       | 48/188 [00:44<02:04,  1.12it/s]Computing feature acts:  26%|██▌       | 49/188 [00:45<02:03,  1.13it/s]Computing feature acts:  27%|██▋       | 50/188 [00:46<02:03,  1.12it/s]Computing feature acts:  27%|██▋       | 51/188 [00:46<02:02,  1.12it/s]Computing feature acts:  28%|██▊       | 52/188 [00:47<02:01,  1.12it/s]Computing feature acts:  28%|██▊       | 53/188 [00:48<01:59,  1.13it/s]Computing feature acts:  29%|██▊       | 54/188 [00:49<02:00,  1.11it/s]Computing feature acts:  29%|██▉       | 55/188 [00:50<01:58,  1.12it/s]Computing feature acts:  30%|██▉       | 56/188 [00:51<01:57,  1.12it/s]Computing feature acts:  30%|███       | 57/188 [00:52<01:56,  1.13it/s]Computing feature acts:  31%|███       | 58/188 [00:53<01:57,  1.10it/s]Computing feature acts:  31%|███▏      | 59/188 [00:54<01:57,  1.10it/s]Computing feature acts:  32%|███▏      | 60/188 [00:55<01:58,  1.08it/s]Computing feature acts:  32%|███▏      | 61/188 [00:55<01:57,  1.08it/s]Computing feature acts:  33%|███▎      | 62/188 [00:56<01:59,  1.06it/s]Computing feature acts:  34%|███▎      | 63/188 [00:57<01:58,  1.06it/s]Computing feature acts:  34%|███▍      | 64/188 [00:58<01:57,  1.06it/s]Computing feature acts:  35%|███▍      | 65/188 [00:59<01:55,  1.06it/s]Computing feature acts:  35%|███▌      | 66/188 [01:00<01:58,  1.03it/s]Computing feature acts:  36%|███▌      | 67/188 [01:01<01:56,  1.04it/s]Computing feature acts:  36%|███▌      | 68/188 [01:02<01:54,  1.05it/s]Computing feature acts:  37%|███▋      | 69/188 [01:03<01:53,  1.05it/s]Computing feature acts:  37%|███▋      | 70/188 [01:04<01:53,  1.04it/s]Computing feature acts:  38%|███▊      | 71/188 [01:05<01:52,  1.04it/s]Computing feature acts:  38%|███▊      | 72/188 [01:06<01:50,  1.05it/s]Computing feature acts:  39%|███▉      | 73/188 [01:07<01:49,  1.05it/s]Computing feature acts:  39%|███▉      | 74/188 [01:08<01:51,  1.02it/s]Computing feature acts:  40%|███▉      | 75/188 [01:09<01:47,  1.05it/s]Computing feature acts:  40%|████      | 76/188 [01:11<02:14,  1.20s/it]Computing feature acts:  41%|████      | 77/188 [01:13<02:34,  1.39s/it]Computing feature acts:  41%|████▏     | 78/188 [01:14<02:21,  1.29s/it]Computing feature acts:  42%|████▏     | 79/188 [01:14<02:06,  1.16s/it]Computing feature acts:  43%|████▎     | 80/188 [01:15<01:56,  1.08s/it]Computing feature acts:  43%|████▎     | 81/188 [01:16<01:49,  1.02s/it]Computing feature acts:  44%|████▎     | 82/188 [01:17<01:45,  1.01it/s]Computing feature acts:  44%|████▍     | 83/188 [01:18<01:43,  1.02it/s]Computing feature acts:  45%|████▍     | 84/188 [01:19<01:42,  1.01it/s]Computing feature acts:  45%|████▌     | 85/188 [01:20<01:41,  1.01it/s]Computing feature acts:  46%|████▌     | 86/188 [01:21<01:43,  1.01s/it]Computing feature acts:  46%|████▋     | 87/188 [01:22<01:42,  1.01s/it]Computing feature acts:  47%|████▋     | 88/188 [01:23<01:40,  1.01s/it]Computing feature acts:  47%|████▋     | 89/188 [01:24<01:39,  1.01s/it]Computing feature acts:  48%|████▊     | 90/188 [01:25<01:39,  1.02s/it]Computing feature acts:  48%|████▊     | 91/188 [01:27<01:56,  1.20s/it]Computing feature acts:  49%|████▉     | 92/188 [01:28<01:50,  1.15s/it]Computing feature acts:  49%|████▉     | 93/188 [01:30<02:05,  1.32s/it]Computing feature acts:  50%|█████     | 94/188 [01:31<02:15,  1.44s/it]Computing feature acts:  51%|█████     | 95/188 [01:33<02:22,  1.53s/it]Computing feature acts:  51%|█████     | 96/188 [01:34<02:11,  1.43s/it]Computing feature acts:  52%|█████▏    | 97/188 [01:35<01:58,  1.31s/it]Computing feature acts:  52%|█████▏    | 98/188 [01:36<01:50,  1.22s/it]Computing feature acts:  53%|█████▎    | 99/188 [01:37<01:43,  1.16s/it]Computing feature acts:  53%|█████▎    | 100/188 [01:38<01:38,  1.12s/it]Computing feature acts:  54%|█████▎    | 101/188 [01:39<01:34,  1.09s/it]Computing feature acts:  54%|█████▍    | 102/188 [01:40<01:31,  1.07s/it]Computing feature acts:  55%|█████▍    | 103/188 [01:41<01:29,  1.05s/it]Computing feature acts:  55%|█████▌    | 104/188 [01:42<01:27,  1.04s/it]Computing feature acts:  56%|█████▌    | 105/188 [01:43<01:26,  1.04s/it]Computing feature acts:  56%|█████▋    | 106/188 [01:44<01:25,  1.04s/it]Computing feature acts:  57%|█████▋    | 107/188 [01:45<01:23,  1.03s/it]Computing feature acts:  57%|█████▋    | 108/188 [01:46<01:21,  1.02s/it]Computing feature acts:  58%|█████▊    | 109/188 [01:47<01:20,  1.02s/it]Computing feature acts:  59%|█████▊    | 110/188 [01:49<01:20,  1.04s/it]Computing feature acts:  59%|█████▉    | 111/188 [01:50<01:19,  1.03s/it]Computing feature acts:  60%|█████▉    | 112/188 [01:51<01:17,  1.02s/it]Computing feature acts:  60%|██████    | 113/188 [01:52<01:16,  1.02s/it]Computing feature acts:  61%|██████    | 114/188 [01:53<01:17,  1.04s/it]Computing feature acts:  61%|██████    | 115/188 [01:54<01:14,  1.02s/it]Computing feature acts:  62%|██████▏   | 116/188 [01:55<01:13,  1.02s/it]Computing feature acts:  62%|██████▏   | 117/188 [01:56<01:11,  1.01s/it]Computing feature acts:  63%|██████▎   | 118/188 [01:57<01:10,  1.01s/it]Computing feature acts:  63%|██████▎   | 119/188 [01:58<01:09,  1.01s/it]Computing feature acts:  64%|██████▍   | 120/188 [01:59<01:09,  1.02s/it]Computing feature acts:  64%|██████▍   | 121/188 [02:00<01:08,  1.02s/it]Computing feature acts:  65%|██████▍   | 122/188 [02:01<01:08,  1.04s/it]Computing feature acts:  65%|██████▌   | 123/188 [02:02<01:07,  1.04s/it]Computing feature acts:  66%|██████▌   | 124/188 [02:03<01:06,  1.04s/it]Computing feature acts:  66%|██████▋   | 125/188 [02:05<01:17,  1.24s/it]Computing feature acts:  67%|██████▋   | 126/188 [02:06<01:25,  1.38s/it]Computing feature acts:  68%|██████▊   | 127/188 [02:08<01:31,  1.51s/it]Computing feature acts:  68%|██████▊   | 128/188 [02:09<01:22,  1.37s/it]Computing feature acts:  69%|██████▊   | 129/188 [02:10<01:14,  1.26s/it]Computing feature acts:  69%|██████▉   | 130/188 [02:11<01:09,  1.19s/it]Computing feature acts:  70%|██████▉   | 131/188 [02:12<01:05,  1.14s/it]Computing feature acts:  70%|███████   | 132/188 [02:13<01:01,  1.10s/it]Computing feature acts:  71%|███████   | 133/188 [02:14<00:59,  1.08s/it]Computing feature acts:  71%|███████▏  | 134/188 [02:15<00:58,  1.08s/it]Computing feature acts:  72%|███████▏  | 135/188 [02:16<00:55,  1.05s/it]Computing feature acts:  72%|███████▏  | 136/188 [02:17<00:54,  1.04s/it]Computing feature acts:  73%|███████▎  | 137/188 [02:19<01:03,  1.24s/it]Computing feature acts:  73%|███████▎  | 138/188 [02:21<01:09,  1.38s/it]Computing feature acts:  74%|███████▍  | 139/188 [02:23<01:12,  1.48s/it]Computing feature acts:  74%|███████▍  | 140/188 [02:24<01:14,  1.55s/it]Computing feature acts:  75%|███████▌  | 141/188 [02:26<01:15,  1.61s/it]Computing feature acts:  76%|███████▌  | 142/188 [02:28<01:15,  1.65s/it]Computing feature acts:  76%|███████▌  | 143/188 [02:29<01:14,  1.67s/it]Computing feature acts:  77%|███████▋  | 144/188 [02:31<01:13,  1.68s/it]Computing feature acts:  77%|███████▋  | 145/188 [02:33<01:12,  1.69s/it]Computing feature acts:  78%|███████▊  | 146/188 [02:35<01:11,  1.71s/it]Computing feature acts:  78%|███████▊  | 147/188 [02:36<01:01,  1.49s/it]Computing feature acts:  79%|███████▊  | 148/188 [02:37<00:54,  1.35s/it]Computing feature acts:  79%|███████▉  | 149/188 [02:38<00:48,  1.24s/it]Computing feature acts:  80%|███████▉  | 150/188 [02:39<00:48,  1.27s/it]Computing feature acts:  80%|████████  | 151/188 [02:41<00:52,  1.41s/it]Computing feature acts:  81%|████████  | 152/188 [02:42<00:54,  1.50s/it]Computing feature acts:  81%|████████▏ | 153/188 [02:44<00:54,  1.57s/it]Computing feature acts:  82%|████████▏ | 154/188 [02:46<00:54,  1.61s/it]Computing feature acts:  82%|████████▏ | 155/188 [02:47<00:45,  1.39s/it]Computing feature acts:  83%|████████▎ | 156/188 [02:48<00:39,  1.24s/it]Computing feature acts:  84%|████████▎ | 157/188 [02:48<00:35,  1.14s/it]Computing feature acts:  84%|████████▍ | 158/188 [02:49<00:32,  1.08s/it]Computing feature acts:  85%|████████▍ | 159/188 [02:50<00:29,  1.02s/it]Computing feature acts:  85%|████████▌ | 160/188 [02:51<00:27,  1.02it/s]Computing feature acts:  86%|████████▌ | 161/188 [02:52<00:26,  1.01it/s]Computing feature acts:  86%|████████▌ | 162/188 [02:53<00:25,  1.02it/s]Computing feature acts:  87%|████████▋ | 163/188 [02:54<00:24,  1.01it/s]Computing feature acts:  87%|████████▋ | 164/188 [02:55<00:23,  1.00it/s]Computing feature acts:  88%|████████▊ | 165/188 [02:56<00:23,  1.01s/it]Computing feature acts:  88%|████████▊ | 166/188 [02:57<00:22,  1.04s/it]Computing feature acts:  89%|████████▉ | 167/188 [02:58<00:21,  1.03s/it]Computing feature acts:  89%|████████▉ | 168/188 [02:59<00:20,  1.03s/it]Computing feature acts:  90%|████████▉ | 169/188 [03:00<00:19,  1.02s/it]Computing feature acts:  90%|█████████ | 170/188 [03:01<00:18,  1.03s/it]Computing feature acts:  91%|█████████ | 171/188 [03:02<00:17,  1.03s/it]Computing feature acts:  91%|█████████▏| 172/188 [03:03<00:16,  1.02s/it]Computing feature acts:  92%|█████████▏| 173/188 [03:04<00:15,  1.02s/it]Computing feature acts:  93%|█████████▎| 174/188 [03:06<00:14,  1.03s/it]Computing feature acts:  93%|█████████▎| 175/188 [03:07<00:13,  1.03s/it]Computing feature acts:  94%|█████████▎| 176/188 [03:08<00:12,  1.03s/it]Computing feature acts:  94%|█████████▍| 177/188 [03:09<00:11,  1.02s/it]Computing feature acts:  95%|█████████▍| 178/188 [03:10<00:10,  1.03s/it]Computing feature acts:  95%|█████████▌| 179/188 [03:11<00:09,  1.03s/it]Computing feature acts:  96%|█████████▌| 180/188 [03:12<00:08,  1.03s/it]Computing feature acts:  96%|█████████▋| 181/188 [03:13<00:07,  1.03s/it]Computing feature acts:  97%|█████████▋| 182/188 [03:14<00:06,  1.04s/it]Computing feature acts:  97%|█████████▋| 183/188 [03:15<00:05,  1.02s/it]Computing feature acts:  98%|█████████▊| 184/188 [03:16<00:04,  1.02s/it]Computing feature acts:  98%|█████████▊| 185/188 [03:17<00:03,  1.03s/it]Computing feature acts:  99%|█████████▉| 186/188 [03:18<00:02,  1.05s/it]Computing feature acts:  99%|█████████▉| 187/188 [03:19<00:01,  1.12s/it]Computing feature acts: 100%|██████████| 188/188 [03:20<00:00,  1.09s/it]Computing feature acts: 100%|██████████| 188/188 [03:21<00:00,  1.07s/it]
Parsing activation data:   0%|          | 0/1 [00:00<?, ?it/s]Parsing activation data: 100%|██████████| 1/1 [00:03<00:00,  3.35s/it]Parsing activation data: 100%|██████████| 1/1 [00:03<00:00,  3.35s/it]
2024-04-15 09:48:52 - INFO - Saving HTML feature dashboards for the SAE at blocks.2.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/1 [00:00<?, ?it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  2.17it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  2.17it/s]
2024-04-15 09:48:52 - INFO - Finished.
2024-04-15 09:48:52 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/config.yaml') n_samples=3000 batch_size=16 minibatch_size_features=1000 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7') save_json_data=False sae_positions=None feature_indices=[22676, 24641, 24994, 25338, 25437, 26235, 26311, 26326, 26714, 27178, 27580, 27896, 28589, 28785, 30045, 30195, 31190, 33260, 33739, 34090, 34551, 35838, 36889, 38917, 39722, 41780, 41878, 43590, 44546, 44554, 46860, 47033, 47752, 49308, 49484, 49623, 50147, 50453, 51129, 52321, 52356, 52768, 54059, 55322, 59206, 59699, 60706, 60732, 62869] prompt_centric=None seed=0
2024-04-15 09:48:52 - INFO - Loading the model and SAEs
2024-04-15 09:48:52 - INFO - wandb_project='gpt2-layerwise_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/mnt/ssd-interp/dan/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=40000 eval_n_samples=500 batch_size=8 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=0.8, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=1.0), logits_kl=None) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.2.hook_resid_pre'])
2024-04-15 09:49:04 - INFO - done
2024-04-15 09:49:04 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7
run_sae_path = /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-0.8_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.2.hook_resid_pre_ue3lz0n7/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Traceback (most recent call last):
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 51, in <module>
    fire.Fire(main)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 48, in main
    generate_dashboards(dashbaords_config, run_sae_path)
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 1005, in main
    generate_dashboards(model, dashboards_config, save_dir=save_dir)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 852, in generate_dashboards
    dashboards_data: dict[str, SaeVisData] = get_dashboards_data(
                                             ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 385, in get_dashboards_data
    assert (
AssertionError: Error: Some feature indices are greater than the number of SAE features
2024-04-15 09:49:11 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/config.yaml') n_samples=3000 batch_size=16 minibatch_size_features=1000 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo') save_json_data=False sae_positions=None feature_indices=[688, 880, 1517, 1774, 1928, 2009, 2484, 3074, 3213, 3583, 5038, 5205, 5790, 6592, 7463, 8659, 9404, 10344, 11272, 11326, 11383, 11669, 11728, 12166, 12222, 12273, 13237, 13271, 13274, 14545, 14579, 15237, 16037, 16716, 17363, 17447, 17575, 18068, 18940, 19364, 19384, 20019, 20279, 21185, 21322] prompt_centric=None seed=0
2024-04-15 09:49:11 - INFO - Loading the model and SAEs
2024-04-15 09:49:11 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=3.0, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.6.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-15 09:49:23 - INFO - done
2024-04-15 09:49:23 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/188 [00:00<?, ?it/s]Computing feature acts:   1%|          | 1/188 [00:01<05:50,  1.87s/it]Computing feature acts:   1%|          | 2/188 [00:03<05:18,  1.71s/it]Computing feature acts:   2%|▏         | 3/188 [00:05<05:11,  1.68s/it]Computing feature acts:   2%|▏         | 4/188 [00:06<04:12,  1.37s/it]Computing feature acts:   3%|▎         | 5/188 [00:06<03:41,  1.21s/it]Computing feature acts:   3%|▎         | 6/188 [00:08<03:49,  1.26s/it]Computing feature acts:   4%|▎         | 7/188 [00:09<04:13,  1.40s/it]Computing feature acts:   4%|▍         | 8/188 [00:11<04:27,  1.49s/it]Computing feature acts:   5%|▍         | 9/188 [00:13<04:36,  1.54s/it]Computing feature acts:   5%|▌         | 10/188 [00:15<04:42,  1.58s/it]Computing feature acts:   6%|▌         | 11/188 [00:16<04:44,  1.61s/it]Computing feature acts:   6%|▋         | 12/188 [00:18<04:48,  1.64s/it]Computing feature acts:   7%|▋         | 13/188 [00:20<04:49,  1.66s/it]Computing feature acts:   7%|▋         | 14/188 [00:21<04:51,  1.67s/it]Computing feature acts:   8%|▊         | 15/188 [00:23<04:51,  1.68s/it]Computing feature acts:   9%|▊         | 16/188 [00:25<04:51,  1.69s/it]Computing feature acts:   9%|▉         | 17/188 [00:26<04:50,  1.70s/it]Computing feature acts:  10%|▉         | 18/188 [00:28<04:48,  1.70s/it]Computing feature acts:  10%|█         | 19/188 [00:30<04:47,  1.70s/it]Computing feature acts:  11%|█         | 20/188 [00:31<04:30,  1.61s/it]Computing feature acts:  11%|█         | 21/188 [00:32<03:53,  1.40s/it]Computing feature acts:  12%|█▏        | 22/188 [00:33<03:30,  1.27s/it]Computing feature acts:  12%|█▏        | 23/188 [00:35<03:47,  1.38s/it]Computing feature acts:  13%|█▎        | 24/188 [00:37<04:19,  1.58s/it]Computing feature acts:  13%|█▎        | 25/188 [00:38<04:22,  1.61s/it]Computing feature acts:  14%|█▍        | 26/188 [00:40<04:24,  1.63s/it]Computing feature acts:  14%|█▍        | 27/188 [00:42<04:31,  1.69s/it]Computing feature acts:  15%|█▍        | 28/188 [00:44<04:30,  1.69s/it]Computing feature acts:  15%|█▌        | 29/188 [00:45<04:29,  1.69s/it]Computing feature acts:  16%|█▌        | 30/188 [00:47<04:26,  1.69s/it]Computing feature acts:  16%|█▋        | 31/188 [00:49<04:31,  1.73s/it]Computing feature acts:  17%|█▋        | 32/188 [00:51<04:26,  1.71s/it]Computing feature acts:  18%|█▊        | 33/188 [00:52<04:24,  1.71s/it]Computing feature acts:  18%|█▊        | 34/188 [00:54<04:20,  1.69s/it]Computing feature acts:  19%|█▊        | 35/188 [00:56<04:17,  1.68s/it]Computing feature acts:  19%|█▉        | 36/188 [00:57<04:14,  1.68s/it]Computing feature acts:  20%|█▉        | 37/188 [00:59<04:12,  1.67s/it]Computing feature acts:  20%|██        | 38/188 [01:01<04:11,  1.67s/it]Computing feature acts:  21%|██        | 39/188 [01:01<03:34,  1.44s/it]Computing feature acts:  21%|██▏       | 40/188 [01:02<03:11,  1.29s/it]Computing feature acts:  22%|██▏       | 41/188 [01:04<03:25,  1.40s/it]Computing feature acts:  22%|██▏       | 42/188 [01:06<03:36,  1.48s/it]Computing feature acts:  23%|██▎       | 43/188 [01:07<03:42,  1.54s/it]Computing feature acts:  23%|██▎       | 44/188 [01:09<03:46,  1.57s/it]Computing feature acts:  24%|██▍       | 45/188 [01:11<03:49,  1.61s/it]Computing feature acts:  24%|██▍       | 46/188 [01:12<03:51,  1.63s/it]Computing feature acts:  25%|██▌       | 47/188 [01:14<03:53,  1.65s/it]Computing feature acts:  26%|██▌       | 48/188 [01:16<03:54,  1.68s/it]Computing feature acts:  26%|██▌       | 49/188 [01:18<03:54,  1.69s/it]Computing feature acts:  27%|██▋       | 50/188 [01:19<03:54,  1.70s/it]Computing feature acts:  27%|██▋       | 51/188 [01:21<03:54,  1.71s/it]Computing feature acts:  28%|██▊       | 52/188 [01:23<03:53,  1.71s/it]Computing feature acts:  28%|██▊       | 53/188 [01:24<03:52,  1.72s/it]Computing feature acts:  29%|██▊       | 54/188 [01:26<03:48,  1.71s/it]Computing feature acts:  29%|██▉       | 55/188 [01:28<03:46,  1.70s/it]Computing feature acts:  30%|██▉       | 56/188 [01:30<03:43,  1.70s/it]Computing feature acts:  30%|███       | 57/188 [01:31<03:41,  1.69s/it]Computing feature acts:  31%|███       | 58/188 [01:33<03:39,  1.69s/it]Computing feature acts:  31%|███▏      | 59/188 [01:35<03:37,  1.69s/it]Computing feature acts:  32%|███▏      | 60/188 [01:36<03:36,  1.69s/it]Computing feature acts:  32%|███▏      | 61/188 [01:37<03:13,  1.52s/it]Computing feature acts:  33%|███▎      | 62/188 [01:39<03:18,  1.58s/it]Computing feature acts:  34%|███▎      | 63/188 [01:41<03:21,  1.61s/it]Computing feature acts:  34%|███▍      | 64/188 [01:42<03:22,  1.64s/it]Computing feature acts:  35%|███▍      | 65/188 [01:44<03:23,  1.66s/it]Computing feature acts:  35%|███▌      | 66/188 [01:46<03:23,  1.67s/it]Computing feature acts:  36%|███▌      | 67/188 [01:47<03:11,  1.59s/it]Computing feature acts:  36%|███▌      | 68/188 [01:48<02:47,  1.39s/it]Computing feature acts:  37%|███▋      | 69/188 [01:49<02:29,  1.26s/it]Computing feature acts:  37%|███▋      | 70/188 [01:50<02:17,  1.16s/it]Computing feature acts:  38%|███▊      | 71/188 [01:52<02:34,  1.32s/it]Computing feature acts:  38%|███▊      | 72/188 [01:53<02:45,  1.43s/it]Computing feature acts:  39%|███▉      | 73/188 [01:55<02:53,  1.51s/it]Computing feature acts:  39%|███▉      | 74/188 [01:57<02:57,  1.56s/it]Computing feature acts:  40%|███▉      | 75/188 [01:59<03:00,  1.60s/it]Computing feature acts:  40%|████      | 76/188 [02:00<03:04,  1.65s/it]Computing feature acts:  41%|████      | 77/188 [02:02<03:05,  1.67s/it]Computing feature acts:  41%|████▏     | 78/188 [02:04<03:06,  1.69s/it]Computing feature acts:  42%|████▏     | 79/188 [02:05<02:41,  1.48s/it]Computing feature acts:  43%|████▎     | 80/188 [02:06<02:25,  1.34s/it]Computing feature acts:  43%|████▎     | 81/188 [02:07<02:13,  1.25s/it]Computing feature acts:  44%|████▎     | 82/188 [02:08<02:05,  1.18s/it]Computing feature acts:  44%|████▍     | 83/188 [02:09<01:59,  1.13s/it]Computing feature acts:  45%|████▍     | 84/188 [02:10<01:54,  1.10s/it]Computing feature acts:  45%|████▌     | 85/188 [02:11<01:51,  1.08s/it]Computing feature acts:  46%|████▌     | 86/188 [02:12<01:48,  1.07s/it]Computing feature acts:  46%|████▋     | 87/188 [02:13<01:46,  1.05s/it]Computing feature acts:  47%|████▋     | 88/188 [02:14<01:44,  1.05s/it]Computing feature acts:  47%|████▋     | 89/188 [02:15<01:42,  1.04s/it]Computing feature acts:  48%|████▊     | 90/188 [02:17<02:02,  1.25s/it]Computing feature acts:  48%|████▊     | 91/188 [02:18<01:55,  1.19s/it]Computing feature acts:  49%|████▉     | 92/188 [02:19<01:51,  1.16s/it]Computing feature acts:  49%|████▉     | 93/188 [02:20<01:48,  1.14s/it]Computing feature acts:  50%|█████     | 94/188 [02:21<01:44,  1.12s/it]Computing feature acts:  51%|█████     | 95/188 [02:22<01:41,  1.09s/it]Computing feature acts:  51%|█████     | 96/188 [02:23<01:43,  1.12s/it]Computing feature acts:  52%|█████▏    | 97/188 [02:24<01:39,  1.09s/it]Computing feature acts:  52%|█████▏    | 98/188 [02:25<01:36,  1.07s/it]Computing feature acts:  53%|█████▎    | 99/188 [02:26<01:34,  1.06s/it]Computing feature acts:  53%|█████▎    | 100/188 [02:27<01:32,  1.05s/it]Computing feature acts:  54%|█████▎    | 101/188 [02:28<01:30,  1.04s/it]Computing feature acts:  54%|█████▍    | 102/188 [02:29<01:29,  1.04s/it]Computing feature acts:  55%|█████▍    | 103/188 [02:30<01:27,  1.03s/it]Computing feature acts:  55%|█████▌    | 104/188 [02:31<01:26,  1.03s/it]Computing feature acts:  56%|█████▌    | 105/188 [02:33<01:25,  1.03s/it]Computing feature acts:  56%|█████▋    | 106/188 [02:34<01:32,  1.12s/it]Computing feature acts:  57%|█████▋    | 107/188 [02:35<01:28,  1.09s/it]Computing feature acts:  57%|█████▋    | 108/188 [02:36<01:26,  1.08s/it]Computing feature acts:  58%|█████▊    | 109/188 [02:37<01:23,  1.06s/it]Computing feature acts:  59%|█████▊    | 110/188 [02:38<01:22,  1.05s/it]Computing feature acts:  59%|█████▉    | 111/188 [02:39<01:20,  1.05s/it]Computing feature acts:  60%|█████▉    | 112/188 [02:40<01:19,  1.04s/it]Computing feature acts:  60%|██████    | 113/188 [02:41<01:17,  1.04s/it]Computing feature acts:  61%|██████    | 114/188 [02:42<01:16,  1.04s/it]Computing feature acts:  61%|██████    | 115/188 [02:43<01:15,  1.04s/it]Computing feature acts:  62%|██████▏   | 116/188 [02:44<01:13,  1.03s/it]Computing feature acts:  62%|██████▏   | 117/188 [02:45<01:12,  1.03s/it]Computing feature acts:  63%|██████▎   | 118/188 [02:46<01:11,  1.03s/it]Computing feature acts:  63%|██████▎   | 119/188 [02:47<01:10,  1.03s/it]Computing feature acts:  64%|██████▍   | 120/188 [02:48<01:09,  1.03s/it]Computing feature acts:  64%|██████▍   | 121/188 [02:49<01:09,  1.04s/it]Computing feature acts:  65%|██████▍   | 122/188 [02:51<01:14,  1.12s/it]Computing feature acts:  65%|██████▌   | 123/188 [02:52<01:11,  1.10s/it]Computing feature acts:  66%|██████▌   | 124/188 [02:53<01:09,  1.08s/it]Computing feature acts:  66%|██████▋   | 125/188 [02:54<01:07,  1.07s/it]Computing feature acts:  67%|██████▋   | 126/188 [02:55<01:05,  1.06s/it]Computing feature acts:  68%|██████▊   | 127/188 [02:56<01:04,  1.05s/it]Computing feature acts:  68%|██████▊   | 128/188 [02:57<01:02,  1.05s/it]Computing feature acts:  69%|██████▊   | 129/188 [02:58<01:01,  1.04s/it]Computing feature acts:  69%|██████▉   | 130/188 [02:59<01:00,  1.04s/it]Computing feature acts:  70%|██████▉   | 131/188 [03:00<00:58,  1.03s/it]Computing feature acts:  70%|███████   | 132/188 [03:01<00:57,  1.03s/it]Computing feature acts:  71%|███████   | 133/188 [03:02<00:57,  1.04s/it]Computing feature acts:  71%|███████▏  | 134/188 [03:03<00:55,  1.04s/it]Computing feature acts:  72%|███████▏  | 135/188 [03:04<00:54,  1.04s/it]Computing feature acts:  72%|███████▏  | 136/188 [03:05<00:53,  1.04s/it]Computing feature acts:  73%|███████▎  | 137/188 [03:06<00:53,  1.06s/it]Computing feature acts:  73%|███████▎  | 138/188 [03:08<00:57,  1.15s/it]Computing feature acts:  74%|███████▍  | 139/188 [03:09<00:54,  1.12s/it]Computing feature acts:  74%|███████▍  | 140/188 [03:10<00:52,  1.09s/it]Computing feature acts:  75%|███████▌  | 141/188 [03:11<00:50,  1.08s/it]Computing feature acts:  76%|███████▌  | 142/188 [03:12<00:48,  1.06s/it]Computing feature acts:  76%|███████▌  | 143/188 [03:13<00:47,  1.06s/it]Computing feature acts:  77%|███████▋  | 144/188 [03:14<00:46,  1.05s/it]Computing feature acts:  77%|███████▋  | 145/188 [03:15<00:45,  1.05s/it]Computing feature acts:  78%|███████▊  | 146/188 [03:16<00:43,  1.05s/it]Computing feature acts:  78%|███████▊  | 147/188 [03:17<00:42,  1.04s/it]Computing feature acts:  79%|███████▊  | 148/188 [03:18<00:41,  1.04s/it]Computing feature acts:  79%|███████▉  | 149/188 [03:19<00:40,  1.04s/it]Computing feature acts:  80%|███████▉  | 150/188 [03:20<00:39,  1.04s/it]Computing feature acts:  80%|████████  | 151/188 [03:21<00:38,  1.04s/it]Computing feature acts:  81%|████████  | 152/188 [03:22<00:37,  1.03s/it]Computing feature acts:  81%|████████▏ | 153/188 [03:23<00:36,  1.04s/it]Computing feature acts:  82%|████████▏ | 154/188 [03:25<00:38,  1.14s/it]Computing feature acts:  82%|████████▏ | 155/188 [03:26<00:36,  1.11s/it]Computing feature acts:  83%|████████▎ | 156/188 [03:27<00:34,  1.08s/it]Computing feature acts:  84%|████████▎ | 157/188 [03:28<00:33,  1.06s/it]Computing feature acts:  84%|████████▍ | 158/188 [03:29<00:31,  1.06s/it]Computing feature acts:  85%|████████▍ | 159/188 [03:30<00:30,  1.05s/it]Computing feature acts:  85%|████████▌ | 160/188 [03:31<00:29,  1.04s/it]Computing feature acts:  86%|████████▌ | 161/188 [03:32<00:29,  1.10s/it]Computing feature acts:  86%|████████▌ | 162/188 [03:33<00:28,  1.08s/it]Computing feature acts:  87%|████████▋ | 163/188 [03:34<00:26,  1.07s/it]Computing feature acts:  87%|████████▋ | 164/188 [03:35<00:25,  1.05s/it]Computing feature acts:  88%|████████▊ | 165/188 [03:36<00:24,  1.05s/it]Computing feature acts:  88%|████████▊ | 166/188 [03:37<00:23,  1.05s/it]Computing feature acts:  89%|████████▉ | 167/188 [03:38<00:22,  1.05s/it]Computing feature acts:  89%|████████▉ | 168/188 [03:39<00:21,  1.05s/it]Computing feature acts:  90%|████████▉ | 169/188 [03:40<00:20,  1.05s/it]Computing feature acts:  90%|█████████ | 170/188 [03:41<00:19,  1.09s/it]Computing feature acts:  91%|█████████ | 171/188 [03:42<00:17,  1.04s/it]Computing feature acts:  91%|█████████▏| 172/188 [03:43<00:16,  1.01s/it]Computing feature acts:  92%|█████████▏| 173/188 [03:44<00:14,  1.01it/s]Computing feature acts:  93%|█████████▎| 174/188 [03:45<00:13,  1.02it/s]Computing feature acts:  93%|█████████▎| 175/188 [03:46<00:12,  1.03it/s]Computing feature acts:  94%|█████████▎| 176/188 [03:48<00:14,  1.17s/it]Computing feature acts:  94%|█████████▍| 177/188 [03:50<00:14,  1.33s/it]Computing feature acts:  95%|█████████▍| 178/188 [03:51<00:14,  1.42s/it]Computing feature acts:  95%|█████████▌| 179/188 [03:52<00:11,  1.30s/it]Computing feature acts:  96%|█████████▌| 180/188 [03:53<00:09,  1.23s/it]Computing feature acts:  96%|█████████▋| 181/188 [03:54<00:08,  1.18s/it]Computing feature acts:  97%|█████████▋| 182/188 [03:55<00:06,  1.14s/it]Computing feature acts:  97%|█████████▋| 183/188 [03:56<00:05,  1.12s/it]Computing feature acts:  98%|█████████▊| 184/188 [03:58<00:04,  1.10s/it]Computing feature acts:  98%|█████████▊| 185/188 [03:59<00:03,  1.09s/it]Computing feature acts:  99%|█████████▉| 186/188 [04:00<00:02,  1.11s/it]Computing feature acts:  99%|█████████▉| 187/188 [04:01<00:01,  1.16s/it]Computing feature acts: 100%|██████████| 188/188 [04:02<00:00,  1.13s/it]Computing feature acts: 100%|██████████| 188/188 [04:03<00:00,  1.30s/it]
Parsing activation data:   0%|          | 0/1 [00:00<?, ?it/s]Parsing activation data: 100%|██████████| 1/1 [00:05<00:00,  5.53s/it]Parsing activation data: 100%|██████████| 1/1 [00:05<00:00,  5.53s/it]
2024-04-15 09:53:44 - INFO - Saving HTML feature dashboards for the SAE at blocks.6.hook_resid_pre:
Dashboard HTML files:   0%|          | 0/1 [00:00<?, ?it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  1.12it/s]Dashboard HTML files: 100%|██████████| 1/1 [00:00<00:00,  1.12it/s]
2024-04-15 09:53:45 - INFO - Finished.
2024-04-15 09:53:45 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/config.yaml') n_samples=3000 batch_size=16 minibatch_size_features=1000 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0') save_json_data=False sae_positions=None feature_indices=[] prompt_centric=None seed=0
2024-04-15 09:53:45 - INFO - Loading the model and SAEs
2024-04-15 09:53:45 - INFO - wandb_project='gpt2-layerwise_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/mnt/ssd-interp/dan/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=40000 eval_n_samples=500 batch_size=8 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=4.0, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=1.0), logits_kl=None) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.6.hook_resid_pre'])
2024-04-15 09:53:57 - INFO - done
2024-04-15 09:53:57 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0
run_sae_path = /data/jordan_tensor/dashboards/gpt2-local_seed-0_lpcoeff-4.0_in-to-out-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_1jy3m5j0/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Traceback (most recent call last):
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 51, in <module>
    fire.Fire(main)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/dashboards/regions/generate_region_dashboards.py", line 48, in main
    generate_dashboards(dashbaords_config, run_sae_path)
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 1005, in main
    generate_dashboards(model, dashboards_config, save_dir=save_dir)
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 852, in generate_dashboards
    dashboards_data: dict[str, SaeVisData] = get_dashboards_data(
                                             ^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/miniconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/jordan_tensor/sparsify/sparsify/scripts/generate_dashboards.py", line 386, in get_dashboards_data
    feature_indices_tensors[sae_name].max().item()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: max(): Expected reduction dim to be specified for input.numel() == 0. Specify the reduction dim with the 'dim' argument.
2024-04-15 09:54:04 - INFO - pretrained_sae_paths=[PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/samples_400000.pt')] sae_config_path=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/config.yaml') n_samples=3000 batch_size=16 minibatch_size_features=1000 data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=None, column_name='input_ids') save_dir=PosixPath('/data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo') save_json_data=False sae_positions=None feature_indices=[71, 887, 1591, 2389, 2714, 2913, 3981, 4152, 5299, 6148, 6192, 6286, 6579, 6962, 7371, 8156, 9398, 10296, 10300, 10366, 11296, 11621, 12340, 13092, 13401, 14637, 15355, 15544, 15565, 15597, 15843, 16560, 17964, 19518, 20791, 21590, 21650, 21915, 22309] prompt_centric=None seed=0
2024-04-15 09:54:04 - INFO - Loading the model and SAEs
2024-04-15 09:54:04 - INFO - wandb_project='gpt2-e2e_play' wandb_run_name=None wandb_run_name_prefix='' seed=0 tlens_model_name='gpt2-small' tlens_model_path=None save_dir=PosixPath('/data/jordan_tensor/sparsify/sparsify/scripts/train_tlens_saes/out') n_samples=400000 save_every_n_samples=None eval_every_n_samples=20000 eval_n_samples=500 batch_size=16 effective_batch_size=16 lr=0.0005 lr_schedule='cosine' min_lr_factor=0.1 warmup_samples=20000 cooldown_samples=0 max_grad_norm=10.0 log_every_n_grad_steps=20 collect_act_frequency_every_n_samples=40000 act_frequency_n_tokens=500000 collect_output_metrics_every_n_samples=0 loss=LossConfigs(sparsity=SparsityLoss(coeff=3.0, p_norm=1.0), in_to_orig=None, out_to_orig=None, out_to_in=OutToInLoss(coeff=0.0), logits_kl=LogitsKLLoss(coeff=1.0)) train_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') eval_data=DatasetConfig(dataset_name='apollo-research/Skylion007-openwebtext-tokenizer-gpt2', is_tokenized=True, tokenizer_name='gpt2', streaming=True, split='train', n_ctx=1024, seed=0, column_name='input_ids') saes=SparsifiersConfig(type_of_sparsifier='sae', dict_size_to_input_ratio=60.0, k=None, pretrained_sae_paths=None, retrain_saes=False, sae_positions=['blocks.6.hook_resid_pre'])
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
2024-04-15 09:54:17 - INFO - done
2024-04-15 09:54:17 - INFO - The HTML dashboards will be saved in /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo
run_sae_path = /data/jordan_tensor/dashboards/gpt2-e2e_seed-0_lpcoeff-3.0_logits-kl-1.0_lr-0.0005_ratio-60.0_blocks.6.hook_resid_pre_zgdpkafo/samples_400000.pt
Loaded pretrained model gpt2-small into HookedTransformer
Moving model to device:  cuda
Computing feature acts:   0%|          | 0/188 [00:00<?, ?it/s]Computing feature acts:   1%|          | 1/188 [00:01<04:10,  1.34s/it]Computing feature acts:   1%|          | 2/188 [00:02<03:42,  1.20s/it]Computing feature acts:   2%|▏         | 3/188 [00:03<03:35,  1.16s/it]Computing feature acts:   2%|▏         | 4/188 [00:04<03:21,  1.09s/it]Computing feature acts:   3%|▎         | 5/188 [00:05<03:11,  1.05s/it]Computing feature acts:   3%|▎         | 6/188 [00:06<03:17,  1.09s/it]Computing feature acts:   4%|▎         | 7/188 [00:07<03:19,  1.10s/it]Computing feature acts:   4%|▍         | 8/188 [00:08<03:20,  1.12s/it]Computing feature acts:   5%|▍         | 9/188 [00:10<03:22,  1.13s/it]Computing feature acts:   5%|▌         | 10/188 [00:11<03:28,  1.17s/it]Computing feature acts:   6%|▌         | 11/188 [00:12<03:29,  1.18s/it]Computing feature acts:   6%|▋         | 12/188 [00:13<03:28,  1.19s/it]Computing feature acts:   7%|▋         | 13/188 [00:14<03:28,  1.19s/it]Computing feature acts:   7%|▋         | 14/188 [00:16<03:31,  1.22s/it]Computing feature acts:   8%|▊         | 15/188 [00:17<03:21,  1.16s/it]Computing feature acts:   9%|▊         | 16/188 [00:18<03:09,  1.10s/it]Computing feature acts:   9%|▉         | 17/188 [00:19<03:02,  1.07s/it]Computing feature acts:  10%|▉         | 18/188 [00:20<03:00,  1.06s/it]Computing feature acts:  10%|█         | 19/188 [00:21<03:01,  1.07s/it]Computing feature acts:  11%|█         | 20/188 [00:22<03:06,  1.11s/it]Computing feature acts:  11%|█         | 21/188 [00:23<03:11,  1.15s/it]Computing feature acts:  12%|█▏        | 22/188 [00:25<03:19,  1.20s/it]Computing feature acts:  12%|█▏        | 23/188 [00:26<03:20,  1.21s/it]Computing feature acts:  13%|█▎        | 24/188 [00:27<03:22,  1.23s/it]Computing feature acts:  13%|█▎        | 25/188 [00:28<03:23,  1.25s/it]Computing feature acts:  14%|█▍        | 26/188 [00:30<03:29,  1.29s/it]Computing feature acts:  14%|█▍        | 27/188 [00:31<03:31,  1.31s/it]Computing feature acts:  15%|█▍        | 28/188 [00:33<03:34,  1.34s/it]Computing feature acts:  15%|█▌        | 29/188 [00:34<03:35,  1.36s/it]Computing feature acts:  16%|█▌        | 30/188 [00:35<03:36,  1.37s/it]Computing feature acts:  16%|█▋        | 31/188 [00:37<03:47,  1.45s/it]Computing feature acts:  17%|█▋        | 32/188 [00:38<03:24,  1.31s/it]Computing feature acts:  18%|█▊        | 33/188 [00:40<03:42,  1.44s/it]Computing feature acts:  18%|█▊        | 34/188 [00:42<03:55,  1.53s/it]Computing feature acts:  19%|█▊        | 35/188 [00:43<04:06,  1.61s/it]Computing feature acts:  19%|█▉        | 36/188 [00:45<03:59,  1.58s/it]Computing feature acts:  20%|█▉        | 37/188 [00:46<03:55,  1.56s/it]Computing feature acts:  20%|██        | 38/188 [00:48<03:54,  1.56s/it]Computing feature acts:  21%|██        | 39/188 [00:49<03:53,  1.57s/it]Computing feature acts:  21%|██▏       | 40/188 [00:51<03:53,  1.58s/it]Computing feature acts:  22%|██▏       | 41/188 [00:53<03:47,  1.54s/it]Computing feature acts:  22%|██▏       | 42/188 [00:54<03:50,  1.58s/it]Computing feature acts:  23%|██▎       | 43/188 [00:56<03:51,  1.60s/it]Computing feature acts:  23%|██▎       | 44/188 [00:57<03:52,  1.61s/it]Computing feature acts:  24%|██▍       | 45/188 [00:59<03:53,  1.63s/it]Computing feature acts:  24%|██▍       | 46/188 [01:00<03:20,  1.41s/it]Computing feature acts:  25%|██▌       | 47/188 [01:01<02:56,  1.26s/it]Computing feature acts:  26%|██▌       | 48/188 [01:02<02:40,  1.15s/it]Computing feature acts:  26%|██▌       | 49/188 [01:03<02:28,  1.07s/it]Computing feature acts:  27%|██▋       | 50/188 [01:04<02:28,  1.07s/it]Computing feature acts:  27%|██▋       | 51/188 [01:05<02:19,  1.02s/it]Computing feature acts:  28%|██▊       | 52/188 [01:06<02:12,  1.02it/s]Computing feature acts:  28%|██▊       | 53/188 [01:06<02:07,  1.06it/s]Computing feature acts:  29%|██▊       | 54/188 [01:07<02:05,  1.07it/s]Computing feature acts:  29%|██▉       | 55/188 [01:08<02:02,  1.09it/s]Computing feature acts:  30%|██▉       | 56/188 [01:09<02:00,  1.10it/s]Computing feature acts:  30%|███       | 57/188 [01:10<01:57,  1.11it/s]Computing feature acts:  31%|███       | 58/188 [01:11<02:00,  1.08it/s]Computing feature acts:  31%|███▏      | 59/188 [01:12<01:57,  1.10it/s]Computing feature acts:  32%|███▏      | 60/188 [01:13<01:55,  1.11it/s]Computing feature acts:  32%|███▏      | 61/188 [01:14<01:54,  1.11it/s]Computing feature acts:  33%|███▎      | 62/188 [01:15<02:22,  1.13s/it]Computing feature acts:  34%|███▎      | 63/188 [01:17<02:42,  1.30s/it]Computing feature acts:  34%|███▍      | 64/188 [01:19<02:57,  1.43s/it]Computing feature acts:  35%|███▍      | 65/188 [01:21<03:07,  1.53s/it]Computing feature acts:  35%|███▌      | 66/188 [01:22<03:13,  1.59s/it]Computing feature acts:  36%|███▌      | 67/188 [01:24<03:19,  1.65s/it]Computing feature acts:  36%|███▌      | 68/188 [01:26<03:22,  1.69s/it]Computing feature acts:  37%|███▋      | 69/188 [01:28<03:24,  1.72s/it]Computing feature acts:  37%|███▋      | 70/188 [01:29<03:26,  1.75s/it]Computing feature acts:  38%|███▊      | 71/188 [01:31<03:27,  1.77s/it]Computing feature acts:  38%|███▊      | 72/188 [01:33<03:26,  1.78s/it]Computing feature acts:  39%|███▉      | 73/188 [01:35<03:25,  1.79s/it]Computing feature acts:  39%|███▉      | 74/188 [01:37<03:23,  1.78s/it]Computing feature acts:  40%|███▉      | 75/188 [01:38<03:20,  1.78s/it]Computing feature acts:  40%|████      | 76/188 [01:40<03:19,  1.78s/it]Computing feature acts:  41%|████      | 77/188 [01:42<03:16,  1.77s/it]Computing feature acts:  41%|████▏     | 78/188 [01:44<03:14,  1.77s/it]Computing feature acts:  42%|████▏     | 79/188 [01:45<03:13,  1.77s/it]Computing feature acts:  43%|████▎     | 80/188 [01:47<03:10,  1.77s/it]Computing feature acts:  43%|████▎     | 81/188 [01:49<03:07,  1.75s/it]Computing feature acts:  44%|████▎     | 82/188 [01:51<03:04,  1.74s/it]Computing feature acts:  44%|████▍     | 83/188 [01:53<03:06,  1.77s/it]Computing feature acts:  45%|████▍     | 84/188 [01:54<03:03,  1.77s/it]Computing feature acts:  45%|████▌     | 85/188 [01:56<03:00,  1.75s/it]Computing feature acts:  46%|████▌     | 86/188 [01:58<03:00,  1.77s/it]Computing feature acts:  46%|████▋     | 87/188 [02:00<02:58,  1.76s/it]Computing feature acts:  47%|████▋     | 88/188 [02:01<02:55,  1.76s/it]Computing feature acts:  47%|████▋     | 89/188 [02:03<02:53,  1.75s/it]Computing feature acts:  48%|████▊     | 90/188 [02:05<02:52,  1.76s/it]Computing feature acts:  48%|████▊     | 91/188 [02:07<02:51,  1.76s/it]Computing feature acts:  49%|████▉     | 92/188 [02:08<02:48,  1.76s/it]Computing feature acts:  49%|████▉     | 93/188 [02:10<02:49,  1.78s/it]Computing feature acts:  50%|█████     | 94/188 [02:12<02:47,  1.78s/it]Computing feature acts:  51%|█████     | 95/188 [02:14<02:45,  1.78s/it]Computing feature acts:  51%|█████     | 96/188 [02:15<02:26,  1.60s/it]Computing feature acts:  52%|█████▏    | 97/188 [02:17<02:29,  1.64s/it]Computing feature acts:  52%|█████▏    | 98/188 [02:18<02:11,  1.46s/it]Computing feature acts:  53%|█████▎    | 99/188 [02:19<01:57,  1.32s/it]Computing feature acts:  53%|█████▎    | 100/188 [02:20<01:48,  1.23s/it]Computing feature acts:  54%|█████▎    | 101/188 [02:21<01:41,  1.16s/it]Computing feature acts:  54%|█████▍    | 102/188 [02:22<01:39,  1.16s/it]Computing feature acts:  55%|█████▍    | 103/188 [02:23<01:34,  1.11s/it]Computing feature acts:  55%|█████▌    | 104/188 [02:24<01:30,  1.07s/it]Computing feature acts:  56%|█████▌    | 105/188 [02:25<01:25,  1.03s/it]Computing feature acts:  56%|█████▋    | 106/188 [02:26<01:24,  1.03s/it]Computing feature acts:  57%|█████▋    | 107/188 [02:27<01:19,  1.02it/s]Computing feature acts:  57%|█████▋    | 108/188 [02:28<01:16,  1.05it/s]Computing feature acts:  58%|█████▊    | 109/188 [02:28<01:13,  1.07it/s]Computing feature acts:  59%|█████▊    | 110/188 [02:29<01:12,  1.07it/s]Computing feature acts:  59%|█████▉    | 111/188 [02:30<01:10,  1.09it/s]Computing feature acts:  60%|█████▉    | 112/188 [02:31<01:08,  1.10it/s]Computing feature acts:  60%|██████    | 113/188 [02:32<01:06,  1.12it/s]slurmstepd: error: *** JOB 1335987 ON compute-permanent-node-990 CANCELLED AT 2024-04-15T09:56:55 ***
